---
title: "Exploratory Data Analysis for the Physiological Signals of the Affective Math Dataset\n"
author: ''
date: "`r Sys.Date()`"
output:
  pdf_document:
    toc: true
    keep_tex: true
    latex_engine: xelatex
  html_document:
    df_print: paged

---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)
```

```{r message=FALSE, warning=FALSE, include=FALSE}
library(dplyr)
library(ggpmisc)
library(tidyverse)
library(lubridate)
library(ggplot2)
library(cowplot)
library(ggpubr)
library(lme4)
library(readr)
library(lmerTest)
library(lattice)
library(gridExtra)
library(kableExtra)
library(BSDA) # for z.test
library("car") # QQplot
```

```{r message=FALSE, warning=FALSE, include=FALSE}
cur_dir <- getwd()
setwd(cur_dir)
getwd()
```

```{r message=FALSE, warning=FALSE, include=FALSE}
# Load the dataset
all.df <- read.csv("Affective-Math-Dataset_3.csv", stringsAsFactors = F)
head(all.df)

nlevels(all.df$ParticipantID)
unique(all.df$ParticipantID)
all.df$ParticipantID = factor(all.df$ParticipantID, levels = c( "S001", "S002", "S003", "S004", "S005",
                                                                "S006", "S007", "S008", "S009", "S010", 
                                                                "S011", "S012", "S013", "S014", "S015", 
                                                                "S016", "S017", "S018", "S019", "S020",
                                                                "S021", "S022", "S023", "S024", "S025",
                                                                "S026", "S027", "S028", "S029", "S030"))
nlevels(all.df$ParticipantID)
unique(all.df$ParticipantID)

# Check for missing values
colSums(is.na(all.df))

# Remove missing values
# This is to important to remove missing values before performing any analysis
# because the functions will remove them automatically and we will not be able to
# know how many missing values were there in the data.

all.df.Perspiration.NAs <- all.df[is.na(all.df$Perspiration), ]
nrow(all.df.Perspiration.NAs)

# remove the NA rows in HR
#all.df <- all.df[!is.na(all.df$Perspiration),]
all.df <- all.df %>% group_by(ParticipantID)


all.df.HR.E4.NAs <- all.df[is.na(all.df$HR.E4), ]
nrow(all.df.HR.E4.NAs)

all.df.HR.AW.NAs <- all.df[is.na(all.df$HR.AW), ]
nrow(all.df.HR.AW.NAs)

all.df.HRV.IBI.NAs <- all.df[is.na(all.df$HRV.IBI), ]
nrow(all.df.HRV.IBI.NAs)


max_Perspiration <- max(all.df$Perspiration)
min_Perspiration <- min(all.df$Perspiration)


max_HR.E4 <- max(all.df$`HR.E4`)
min_HR.E4 <- min(all.df$`HR.E4`)


max_HR.AW <- max(all.df$`HR.AW`)
min_HR.AW <- min(all.df$`HR.AW`)

max_HRV.IBI <- max(all.df$`HRV.IBI`)
min_HRV.IBI <- min(all.df$`HRV.IBI`)


```



```{r message=FALSE, warning=FALSE, include=FALSE}

calculate_max_values <- function(df, participant_id) {
  participant_set <- df %>% filter(ParticipantID == participant_id)
  
  max_values <- list(
    max_minutes = max(participant_set$Time),
    max_Perspiration = max(participant_set$Perspiration),
    max_HR_E4 = max(participant_set$HR.E4),
    max_HR_AW = max(participant_set$HR.AW),
    max_HRV_IBI = max(participant_set$HRV.IBI)
  )
  
  return(max_values)
}
S001_max_values <- calculate_max_values(all.df, "S001")
S002_max_values <- calculate_max_values(all.df, "S002")
S003_max_values <- calculate_max_values(all.df, "S003")
S004_max_values <- calculate_max_values(all.df, "S004")
S005_max_values <- calculate_max_values(all.df, "S005")
S006_max_values <- calculate_max_values(all.df, "S006")
S007_max_values <- calculate_max_values(all.df, "S007")
S008_max_values <- calculate_max_values(all.df, "S008")
S009_max_values <- calculate_max_values(all.df, "S009")
S010_max_values <- calculate_max_values(all.df, "S010")
S011_max_values <- calculate_max_values(all.df, "S011")
S012_max_values <- calculate_max_values(all.df, "S012")
S013_max_values <- calculate_max_values(all.df, "S013")
S014_max_values <- calculate_max_values(all.df, "S014")
S015_max_values <- calculate_max_values(all.df, "S015")
S016_max_values <- calculate_max_values(all.df, "S016")
S017_max_values <- calculate_max_values(all.df, "S017")
S018_max_values <- calculate_max_values(all.df, "S018")
S019_max_values <- calculate_max_values(all.df, "S019")
S020_max_values <- calculate_max_values(all.df, "S020")
S021_max_values <- calculate_max_values(all.df, "S021")
S022_max_values <- calculate_max_values(all.df, "S022")
S023_max_values <- calculate_max_values(all.df, "S023")
S024_max_values <- calculate_max_values(all.df, "S024")
S025_max_values <- calculate_max_values(all.df, "S025")
S026_max_values <- calculate_max_values(all.df, "S026")
S027_max_values <- calculate_max_values(all.df, "S027")
S028_max_values <- calculate_max_values(all.df, "S028")
S029_max_values <- calculate_max_values(all.df, "S029")
S030_max_values <- calculate_max_values(all.df, "S030")

```

```{r message=FALSE, warning=FALSE, include=FALSE}

calculate_bl <- function(data, variable, participant) {
  result <- data %>%
    filter(Session == "BL" & ParticipantID == participant) %>%
    summarise(avg_variable = mean(get(variable), na.rm = TRUE))
  return(result)
}

bl_perspiration_S001 <- calculate_bl(all.df, "Perspiration", "S001")
bl_HR.E4_S001 <- calculate_bl(all.df, "HR.E4", "S001")
bl_HR.AW_S001 <- calculate_bl(all.df, "HR.AW", "S001")
bl_HRV.IBI_S001 <- calculate_bl(all.df, "HRV.IBI", "S001")

bl_perspiration_S002 <- calculate_bl(all.df, "Perspiration", "S002")
bl_HR.E4_S002 <- calculate_bl(all.df, "HR.E4", "S002")
bl_HR.AW_S002 <- calculate_bl(all.df, "HR.AW", "S002")
bl_HRV.IBI_S002 <- calculate_bl(all.df, "HRV.IBI", "S002")

bl_perspiration_S003 <- calculate_bl(all.df, "Perspiration", "S003")
bl_HR.E4_S003 <- calculate_bl(all.df, "HR.E4", "S003")
bl_HR.AW_S003 <- calculate_bl(all.df, "HR.AW", "S003")
bl_HRV.IBI_S003 <- calculate_bl(all.df, "HRV.IBI", "S003")


bl_perspiration_S004 <- calculate_bl(all.df, "Perspiration", "S004")
bl_HR.E4_S004 <- calculate_bl(all.df, "HR.E4", "S004")
bl_HR.AW_S004 <- calculate_bl(all.df, "HR.AW", "S004")
bl_HRV.IBI_S004 <- calculate_bl(all.df, "HRV.IBI", "S004")

bl_perspiration_S005 <- calculate_bl(all.df, "Perspiration", "S005")
bl_HR.E4_S005 <- calculate_bl(all.df, "HR.E4", "S005")
bl_HR.AW_S005 <- calculate_bl(all.df, "HR.AW", "S005")
bl_HRV.IBI_S005 <- calculate_bl(all.df, "HRV.IBI", "S005")

bl_perspiration_S006 <- calculate_bl(all.df, "Perspiration", "S006")
bl_HR.E4_S006 <- calculate_bl(all.df, "HR.E4", "S006")
bl_HR.AW_S006 <- calculate_bl(all.df, "HR.AW", "S006")
bl_HRV.IBI_S006 <- calculate_bl(all.df, "HRV.IBI", "S006")

bl_perspiration_S007 <- calculate_bl(all.df, "Perspiration", "S007")
bl_HR.E4_S007 <- calculate_bl(all.df, "HR.E4", "S007")
bl_HR.AW_S007 <- calculate_bl(all.df, "HR.AW", "S007")
bl_HRV.IBI_S007 <- calculate_bl(all.df, "HRV.IBI", "S007")

bl_perspiration_S008 <- calculate_bl(all.df, "Perspiration", "S008")
bl_HR.E4_S008 <- calculate_bl(all.df, "HR.E4", "S008")
bl_HR.AW_S008 <- calculate_bl(all.df, "HR.AW", "S008")
bl_HRV.IBI_S008 <- calculate_bl(all.df, "HRV.IBI", "S008")

bl_perspiration_S009 <- calculate_bl(all.df, "Perspiration", "S009")
bl_HR.E4_S009 <- calculate_bl(all.df, "HR.E4", "S009")
bl_HR.AW_S009 <- calculate_bl(all.df, "HR.AW", "S009")
bl_HRV.IBI_S009 <- calculate_bl(all.df, "HRV.IBI", "S009")

bl_perspiration_S010 <- calculate_bl(all.df, "Perspiration", "S010")
bl_HR.E4_S010 <- calculate_bl(all.df, "HR.E4", "S010")
bl_HR.AW_S010 <- calculate_bl(all.df, "HR.AW", "S010")
bl_HRV.IBI_S010 <- calculate_bl(all.df, "HRV.IBI", "S010")

bl_perspiration_S011 <- calculate_bl(all.df, "Perspiration", "S011")
bl_HR.E4_S011 <- calculate_bl(all.df, "HR.E4", "S011")
bl_HR.AW_S011 <- calculate_bl(all.df, "HR.AW", "S011")
bl_HRV.IBI_S011 <- calculate_bl(all.df, "HRV.IBI", "S011")

bl_perspiration_S012 <- calculate_bl(all.df, "Perspiration", "S012")
bl_HR.E4_S012 <- calculate_bl(all.df, "HR.E4", "S012")
bl_HR.AW_S012 <- calculate_bl(all.df, "HR.AW", "S012")
bl_HRV.IBI_S012 <- calculate_bl(all.df, "HRV.IBI", "S012")

bl_perspiration_S013 <- calculate_bl(all.df, "Perspiration", "S013")
bl_HR.E4_S013 <- calculate_bl(all.df, "HR.E4", "S013")
bl_HR.AW_S013 <- calculate_bl(all.df, "HR.AW", "S013")
bl_HRV.IBI_S013 <- calculate_bl(all.df, "HRV.IBI", "S013")

bl_perspiration_S014 <- calculate_bl(all.df, "Perspiration", "S014")
bl_HR.E4_S014 <- calculate_bl(all.df, "HR.E4", "S014")
bl_HR.AW_S014 <- calculate_bl(all.df, "HR.AW", "S014")
bl_HRV.IBI_S014 <- calculate_bl(all.df, "HRV.IBI", "S014")

bl_perspiration_S015 <- calculate_bl(all.df, "Perspiration", "S015")
bl_HR.E4_S015 <- calculate_bl(all.df, "HR.E4", "S015")
bl_HR.AW_S015 <- calculate_bl(all.df, "HR.AW", "S015")
bl_HRV.IBI_S015 <- calculate_bl(all.df, "HRV.IBI", "S015")

bl_perspiration_S016 <- calculate_bl(all.df, "Perspiration", "S016")
bl_HR.E4_S016 <- calculate_bl(all.df, "HR.E4", "S016")
bl_HR.AW_S016 <- calculate_bl(all.df, "HR.AW", "S016")
bl_HRV.IBI_S016 <- calculate_bl(all.df, "HRV.IBI", "S016")

bl_perspiration_S017 <- calculate_bl(all.df, "Perspiration", "S017")
bl_HR.E4_S017 <- calculate_bl(all.df, "HR.E4", "S017")
bl_HR.AW_S017 <- calculate_bl(all.df, "HR.AW", "S017")
bl_HRV.IBI_S017 <- calculate_bl(all.df, "HRV.IBI", "S017")

bl_perspiration_S018 <- calculate_bl(all.df, "Perspiration", "S018")
bl_HR.E4_S018 <- calculate_bl(all.df, "HR.E4", "S018")
bl_HR.AW_S018 <- calculate_bl(all.df, "HR.AW", "S018")
bl_HRV.IBI_S018 <- calculate_bl(all.df, "HRV.IBI", "S018")

bl_perspiration_S019 <- calculate_bl(all.df, "Perspiration", "S019")
bl_HR.E4_S019 <- calculate_bl(all.df, "HR.E4", "S019")
bl_HR.AW_S019 <- calculate_bl(all.df, "HR.AW", "S019")
bl_HRV.IBI_S019 <- calculate_bl(all.df, "HRV.IBI", "S019")

bl_perspiration_S020 <- calculate_bl(all.df, "Perspiration", "S020")
bl_HR.E4_S020 <- calculate_bl(all.df, "HR.E4", "S020")
bl_HR.AW_S020 <- calculate_bl(all.df, "HR.AW", "S020")
bl_HRV.IBI_S020 <- calculate_bl(all.df, "HRV.IBI", "S020")

bl_perspiration_S021 <- calculate_bl(all.df, "Perspiration", "S021")
bl_HR.E4_S021 <- calculate_bl(all.df, "HR.E4", "S021")
bl_HR.AW_S021 <- calculate_bl(all.df, "HR.AW", "S021")
bl_HRV.IBI_S021 <- calculate_bl(all.df, "HRV.IBI", "S021")

bl_perspiration_S022 <- calculate_bl(all.df, "Perspiration", "S022")
bl_HR.E4_S022 <- calculate_bl(all.df, "HR.E4", "S022")
bl_HR.AW_S022 <- calculate_bl(all.df, "HR.AW", "S022")
bl_HRV.IBI_S022 <- calculate_bl(all.df, "HRV.IBI", "S022")

bl_perspiration_S023 <- calculate_bl(all.df, "Perspiration", "S023")
bl_HR.E4_S023 <- calculate_bl(all.df, "HR.E4", "S023")
bl_HR.AW_S023 <- calculate_bl(all.df, "HR.AW", "S023")
bl_HRV.IBI_S023 <- calculate_bl(all.df, "HRV.IBI", "S023")

bl_perspiration_S024 <- calculate_bl(all.df, "Perspiration", "S024")
bl_HR.E4_S024 <- calculate_bl(all.df, "HR.E4", "S024")
bl_HR.AW_S024 <- calculate_bl(all.df, "HR.AW", "S024")
bl_HRV.IBI_S024 <- calculate_bl(all.df, "HRV.IBI", "S024")

bl_perspiration_S025 <- calculate_bl(all.df, "Perspiration", "S025")
bl_HR.E4_S025 <- calculate_bl(all.df, "HR.E4", "S025")
bl_HR.AW_S025 <- calculate_bl(all.df, "HR.AW", "S025")
bl_HRV.IBI_S025 <- calculate_bl(all.df, "HRV.IBI", "S025")

bl_perspiration_S026 <- calculate_bl(all.df, "Perspiration", "S026")
bl_HR.E4_S026 <- calculate_bl(all.df, "HR.E4", "S026")
bl_HR.AW_S026 <- calculate_bl(all.df, "HR.AW", "S026")
bl_HRV.IBI_S026 <- calculate_bl(all.df, "HRV.IBI", "S026")

bl_perspiration_S027 <- calculate_bl(all.df, "Perspiration", "S027")
bl_HR.E4_S027 <- calculate_bl(all.df, "HR.E4", "S027")
bl_HR.AW_S027 <- calculate_bl(all.df, "HR.AW", "S027")
bl_HRV.IBI_S027 <- calculate_bl(all.df, "HRV.IBI", "S027")

bl_perspiration_S028 <- calculate_bl(all.df, "Perspiration", "S028")
bl_HR.E4_S028 <- calculate_bl(all.df, "HR.E4", "S028")
bl_HR.AW_S028 <- calculate_bl(all.df, "HR.AW", "S028")
bl_HRV.IBI_S028 <- calculate_bl(all.df, "HRV.IBI", "S028")

bl_perspiration_S029 <- calculate_bl(all.df, "Perspiration", "S029")
bl_HR.E4_S029 <- calculate_bl(all.df, "HR.E4", "S029")
bl_HR.AW_S029 <- calculate_bl(all.df, "HR.AW", "S029")
bl_HRV.IBI_S029 <- calculate_bl(all.df, "HRV.IBI", "S029")

bl_perspiration_S030 <- calculate_bl(all.df, "Perspiration", "S030")
bl_HR.E4_S030 <- calculate_bl(all.df, "HR.E4", "S030")
bl_HR.AW_S030 <- calculate_bl(all.df, "HR.AW", "S030")
bl_HRV.IBI_S030 <- calculate_bl(all.df, "HRV.IBI", "S030")


all.df <- all.df %>%
  mutate(
    bl_HR.AW = case_when(
      ParticipantID == "S001" ~ as.numeric(bl_HR.AW_S001$avg_variable),
      ParticipantID == "S002" ~ as.numeric(bl_HR.AW_S002$avg_variable),
      ParticipantID == "S003" ~ as.numeric(bl_HR.AW_S003$avg_variable),
      ParticipantID == "S004" ~ as.numeric(bl_HR.AW_S004$avg_variable),
      ParticipantID == "S005" ~ as.numeric(bl_HR.AW_S005$avg_variable),
      ParticipantID == "S006" ~ as.numeric(bl_HR.AW_S006$avg_variable),
      ParticipantID == "S007" ~ as.numeric(bl_HR.AW_S007$avg_variable),
      ParticipantID == "S008" ~ as.numeric(bl_HR.AW_S008$avg_variable),
      ParticipantID == "S009" ~ as.numeric(bl_HR.AW_S009$avg_variable),
      ParticipantID == "S010" ~ as.numeric(bl_HR.AW_S010$avg_variable),
      ParticipantID == "S011" ~ as.numeric(bl_HR.AW_S011$avg_variable),
      ParticipantID == "S012" ~ as.numeric(bl_HR.AW_S012$avg_variable),
      ParticipantID == "S013" ~ as.numeric(bl_HR.AW_S013$avg_variable),
      ParticipantID == "S014" ~ as.numeric(bl_HR.AW_S014$avg_variable),
      ParticipantID == "S015" ~ as.numeric(bl_HR.AW_S015$avg_variable),
      ParticipantID == "S016" ~ as.numeric(bl_HR.AW_S016$avg_variable),
      ParticipantID == "S017" ~ as.numeric(bl_HR.AW_S017$avg_variable),
      ParticipantID == "S018" ~ as.numeric(bl_HR.AW_S018$avg_variable),
      ParticipantID == "S019" ~ as.numeric(bl_HR.AW_S019$avg_variable),
      ParticipantID == "S020" ~ as.numeric(bl_HR.AW_S020$avg_variable),
      ParticipantID == "S021" ~ as.numeric(bl_HR.AW_S021$avg_variable),
      ParticipantID == "S022" ~ as.numeric(bl_HR.AW_S022$avg_variable),
      ParticipantID == "S023" ~ as.numeric(bl_HR.AW_S023$avg_variable),
      ParticipantID == "S024" ~ as.numeric(bl_HR.AW_S024$avg_variable),
      ParticipantID == "S025" ~ as.numeric(bl_HR.AW_S025$avg_variable),
      ParticipantID == "S026" ~ as.numeric(bl_HR.AW_S026$avg_variable),
      ParticipantID == "S027" ~ as.numeric(bl_HR.AW_S027$avg_variable),
      ParticipantID == "S028" ~ as.numeric(bl_HR.AW_S028$avg_variable),
      ParticipantID == "S029" ~ as.numeric(bl_HR.AW_S029$avg_variable),
      ParticipantID == "S030" ~ as.numeric(bl_HR.AW_S030$avg_variable)
    )
  )

```

```{r message=FALSE, warning=FALSE, include=FALSE}
all.df <- all.df %>%
  mutate(
    bl_perspiration = case_when(
      ParticipantID == "S001" ~ as.numeric(bl_perspiration_S001$avg_variable),
      ParticipantID == "S002" ~ as.numeric(bl_perspiration_S002$avg_variable),
      ParticipantID == "S003" ~ as.numeric(bl_perspiration_S003$avg_variable),
      ParticipantID == "S004" ~ as.numeric(bl_perspiration_S004$avg_variable),
      ParticipantID == "S005" ~ as.numeric(bl_perspiration_S005$avg_variable),
      ParticipantID == "S006" ~ as.numeric(bl_perspiration_S006$avg_variable),
      ParticipantID == "S007" ~ as.numeric(bl_perspiration_S007$avg_variable),
      ParticipantID == "S008" ~ as.numeric(bl_perspiration_S008$avg_variable),
      ParticipantID == "S009" ~ as.numeric(bl_perspiration_S009$avg_variable),
      ParticipantID == "S010" ~ as.numeric(bl_perspiration_S010$avg_variable),
      ParticipantID == "S011" ~ as.numeric(bl_perspiration_S011$avg_variable),
      ParticipantID == "S012" ~ as.numeric(bl_perspiration_S012$avg_variable),
      ParticipantID == "S013" ~ as.numeric(bl_perspiration_S013$avg_variable),
      ParticipantID == "S014" ~ as.numeric(bl_perspiration_S014$avg_variable),
      ParticipantID == "S015" ~ as.numeric(bl_perspiration_S015$avg_variable),
      ParticipantID == "S016" ~ as.numeric(bl_perspiration_S016$avg_variable),
      ParticipantID == "S017" ~ as.numeric(bl_perspiration_S017$avg_variable),
      ParticipantID == "S018" ~ as.numeric(bl_perspiration_S018$avg_variable),
      ParticipantID == "S019" ~ as.numeric(bl_perspiration_S019$avg_variable),
      ParticipantID == "S020" ~ as.numeric(bl_perspiration_S020$avg_variable),
      ParticipantID == "S021" ~ as.numeric(bl_perspiration_S021$avg_variable),
      ParticipantID == "S022" ~ as.numeric(bl_perspiration_S022$avg_variable),
      ParticipantID == "S023" ~ as.numeric(bl_perspiration_S023$avg_variable),
      ParticipantID == "S024" ~ as.numeric(bl_perspiration_S024$avg_variable),
      ParticipantID == "S025" ~ as.numeric(bl_perspiration_S025$avg_variable),
      ParticipantID == "S026" ~ as.numeric(bl_perspiration_S026$avg_variable),
      ParticipantID == "S027" ~ as.numeric(bl_perspiration_S027$avg_variable),
      ParticipantID == "S028" ~ as.numeric(bl_perspiration_S028$avg_variable),
      ParticipantID == "S029" ~ as.numeric(bl_perspiration_S029$avg_variable),
      ParticipantID == "S030" ~ as.numeric(bl_perspiration_S030$avg_variable)
    )
  )

all.df <- all.df %>%
  mutate(
    bl_HR.E4 = case_when(
      ParticipantID == "S001" ~ as.numeric(bl_HR.E4_S001$avg_variable),
      ParticipantID == "S002" ~ as.numeric(bl_HR.E4_S002$avg_variable),
      ParticipantID == "S003" ~ as.numeric(bl_HR.E4_S003$avg_variable),
      ParticipantID == "S004" ~ as.numeric(bl_HR.E4_S004$avg_variable),
      ParticipantID == "S005" ~ as.numeric(bl_HR.E4_S005$avg_variable),
      ParticipantID == "S006" ~ as.numeric(bl_HR.E4_S006$avg_variable),
      ParticipantID == "S007" ~ as.numeric(bl_HR.E4_S007$avg_variable),
      ParticipantID == "S008" ~ as.numeric(bl_HR.E4_S008$avg_variable),
      ParticipantID == "S009" ~ as.numeric(bl_HR.E4_S009$avg_variable),
      ParticipantID == "S010" ~ as.numeric(bl_HR.E4_S010$avg_variable),
      ParticipantID == "S011" ~ as.numeric(bl_HR.E4_S011$avg_variable),
      ParticipantID == "S012" ~ as.numeric(bl_HR.E4_S012$avg_variable),
      ParticipantID == "S013" ~ as.numeric(bl_HR.E4_S013$avg_variable),
      ParticipantID == "S014" ~ as.numeric(bl_HR.E4_S014$avg_variable),
      ParticipantID == "S015" ~ as.numeric(bl_HR.E4_S015$avg_variable),
      ParticipantID == "S016" ~ as.numeric(bl_HR.E4_S016$avg_variable),
      ParticipantID == "S017" ~ as.numeric(bl_HR.E4_S017$avg_variable),
      ParticipantID == "S018" ~ as.numeric(bl_HR.E4_S018$avg_variable),
      ParticipantID == "S019" ~ as.numeric(bl_HR.E4_S019$avg_variable),
      ParticipantID == "S020" ~ as.numeric(bl_HR.E4_S020$avg_variable),
      ParticipantID == "S021" ~ as.numeric(bl_HR.E4_S021$avg_variable),
      ParticipantID == "S022" ~ as.numeric(bl_HR.E4_S022$avg_variable),
      ParticipantID == "S023" ~ as.numeric(bl_HR.E4_S023$avg_variable),
      ParticipantID == "S024" ~ as.numeric(bl_HR.E4_S024$avg_variable),
      ParticipantID == "S025" ~ as.numeric(bl_HR.E4_S025$avg_variable),
      ParticipantID == "S026" ~ as.numeric(bl_HR.E4_S026$avg_variable),
      ParticipantID == "S027" ~ as.numeric(bl_HR.E4_S027$avg_variable),
      ParticipantID == "S028" ~ as.numeric(bl_HR.E4_S028$avg_variable),
      ParticipantID == "S029" ~ as.numeric(bl_HR.E4_S029$avg_variable),
      ParticipantID == "S030" ~ as.numeric(bl_HR.E4_S030$avg_variable)
    )
  )


all.df <- all.df %>%
  mutate(
    bl_HRV.IBI = case_when(
      ParticipantID == "S001" ~ as.numeric(bl_HRV.IBI_S001$avg_variable),
      ParticipantID == "S002" ~ as.numeric(bl_HRV.IBI_S002$avg_variable),
      ParticipantID == "S003" ~ as.numeric(bl_HRV.IBI_S003$avg_variable),
      ParticipantID == "S004" ~ as.numeric(bl_HRV.IBI_S004$avg_variable),
      ParticipantID == "S005" ~ as.numeric(bl_HRV.IBI_S005$avg_variable),
      ParticipantID == "S006" ~ as.numeric(bl_HRV.IBI_S006$avg_variable),
      ParticipantID == "S007" ~ as.numeric(bl_HRV.IBI_S007$avg_variable),
      ParticipantID == "S008" ~ as.numeric(bl_HRV.IBI_S008$avg_variable),
      ParticipantID == "S009" ~ as.numeric(bl_HRV.IBI_S009$avg_variable),
      ParticipantID == "S010" ~ as.numeric(bl_HRV.IBI_S010$avg_variable),
      ParticipantID == "S011" ~ as.numeric(bl_HRV.IBI_S011$avg_variable),
      ParticipantID == "S012" ~ as.numeric(bl_HRV.IBI_S012$avg_variable),
      ParticipantID == "S013" ~ as.numeric(bl_HRV.IBI_S013$avg_variable),
      ParticipantID == "S014" ~ as.numeric(bl_HRV.IBI_S014$avg_variable),
      ParticipantID == "S015" ~ as.numeric(bl_HRV.IBI_S015$avg_variable),
      ParticipantID == "S016" ~ as.numeric(bl_HRV.IBI_S016$avg_variable),
      ParticipantID == "S017" ~ as.numeric(bl_HRV.IBI_S017$avg_variable),
      ParticipantID == "S018" ~ as.numeric(bl_HRV.IBI_S018$avg_variable),
      ParticipantID == "S019" ~ as.numeric(bl_HRV.IBI_S019$avg_variable),
      ParticipantID == "S020" ~ as.numeric(bl_HRV.IBI_S020$avg_variable),
      ParticipantID == "S021" ~ as.numeric(bl_HRV.IBI_S021$avg_variable),
      ParticipantID == "S022" ~ as.numeric(bl_HRV.IBI_S022$avg_variable),
      ParticipantID == "S023" ~ as.numeric(bl_HRV.IBI_S023$avg_variable),
      ParticipantID == "S024" ~ as.numeric(bl_HRV.IBI_S024$avg_variable),
      ParticipantID == "S025" ~ as.numeric(bl_HRV.IBI_S025$avg_variable),
      ParticipantID == "S026" ~ as.numeric(bl_HRV.IBI_S026$avg_variable),
      ParticipantID == "S027" ~ as.numeric(bl_HRV.IBI_S027$avg_variable),
      ParticipantID == "S028" ~ as.numeric(bl_HRV.IBI_S028$avg_variable),
      ParticipantID == "S029" ~ as.numeric(bl_HRV.IBI_S029$avg_variable),
      ParticipantID == "S030" ~ as.numeric(bl_HRV.IBI_S030$avg_variable)
    )
  )
all.df 
```

```{r message=FALSE, warning=FALSE, include=FALSE}
# normalized signal
all.df <- all.df %>%
  mutate(norm_Perspiration = ifelse(!is.na(Perspiration), Perspiration - bl_perspiration, NA))


all.df <- all.df %>%
  mutate(norm_HR.E4 = ifelse(!is.na(HR.E4), HR.E4 - bl_HR.E4, NA))

all.df <- all.df %>%
  mutate(norm_HR.AW = ifelse(!is.na(HR.AW), HR.AW - bl_HR.AW, NA))


all.df <- all.df %>%
  mutate(norm_HRV.IBI = ifelse(!is.na(HRV.IBI), HRV.IBI - bl_HRV.IBI, NA))

```


```{r message=FALSE, warning=FALSE, include=FALSE}

all.df <- all.df %>%
  group_by(ParticipantID) %>%
  mutate(
    posix_timestamps = as.POSIXct(Timestamp, format = "%Y-%m-%dT%H:%M:%SZ", tz = "UTC"),
    Time2 = as.numeric(difftime(posix_timestamps, ifelse(length(posix_timestamps) > 0, min(posix_timestamps), as.POSIXct("1970-01-01")), units = "secs"))
  ) %>%
  ungroup()  # to remove grouping
```





\newpage
# Step 1 

Perform exploratory data analysis for the physiological signals of the Affective Math Dataset. As you know from relevant homework, exploratory data analysis in such cases involves the construction of matrix plots. The dataset features 30 participants and four physiological signals: Perinasal Perspiration, HR from E4, HR from Apple Watch, and HRV.

Q1 - Construct a participant-level matrix plot of the given signals to get a sense of the raw data. Each row must include the signal panels of one participant. As you may not be able to accommodate all participants in one page, you need to figure out the optimal number of participants per page. It is also important to include a statistical measure of the baseline signals in the plots to facilitate comparison with the corresponding task signals.

Q2 - Compute and plot the normalized signal matrix, because from now on you will operate on normalized physiological signals.

Q3 - Construct a matrix of summary statistical graphs to get a qualitative sense of differences. In the relevant homework you implemented probability density functions (pdf). Here you may choose something else, like boxplots. Whatever you do, you have to justify it. Please note that because we have three tasks of interest (ABSTRACT, WORD, VIDEO), it is imperative that you construct the statistical graphs accordingly. Accompany this matrix of graphs with a table of descriptive statistics.

Q4 - Express the insights you have gained.

\newpage

## Q1-Signal Matrix Figure

```{r message=FALSE, warning=FALSE, include=FALSE}
# without x axis label first rows
## my_theme() -----
my_theme <- theme_bw() + 
  theme(
    panel.grid = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_blank(),
    axis.text.y = element_blank(),
    strip.text = element_text(size = 14),
    legend.position = "none"
  )  

# with  x-y axis label
my_theme1 <-   theme_bw() + 
  theme(
    panel.grid = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_text(size = 10, face = "bold"),
    axis.text.y = element_text(size = 10, face = "bold"),
    strip.text = element_text(size = 14),
    legend.position = "none"
  )  

```



```{r fig.height=4, fig.width=13, message=FALSE, warning=FALSE, include=FALSE}
# Function to create plots for a given participant
create_plots <- function(participant_id) {
  subset_data <- all.df %>%
    filter(ParticipantID == participant_id)
  
  nrow_HR <- nrow(subset_data %>% filter(!is.na(HR.AW)))
  
  plot_perspiration <- subset_data %>%
    filter(!is.na(Perspiration)) %>%
    ggplot(aes(x = Time2, y = Perspiration)) +
    geom_line(color = "black", linewidth = 0.5, na.rm = TRUE) +
    xlim(c(0, 10000)) +
    scale_y_continuous(limits = c(0, 0.016), expand = c(0, 0)) +
    labs(title = "Perspiration [°C\u00B2]", x = "", y = participant_id) +
    my_theme1 +
    theme(strip.background = element_blank(), strip.placement = "outside") +
    stat_correlation(mapping = use_label(c("n")), label.x = "center",na.rm = TRUE) +
    geom_line(aes(x = Time2, y = bl_perspiration), color = "blue", size = 0.8)

  plot_HR <- subset_data %>%
    filter(!is.na(HR.E4) | !is.na(HR.AW)) %>%
    ggplot(aes(x = Time2, y = HR.E4)) +
    geom_line(color = "black", linewidth = 0.5, na.rm = TRUE) +
    geom_point(aes(x = Time2, y = HR.AW), color = "pink", size = 1, na.rm = TRUE, alpha = 0.3) +
    facet_wrap(ParticipantID ~ ., strip.position = "top", nrow = 1, ncol = 1, labeller = as_labeller(participant_id)) +
    xlim(c(0, 10000)) +
    scale_y_continuous(limits = c(45, 151), expand = c(0, 0)) +
    labs(title = "HR.E4 & HR.AW [BMP]", y = "", x = "") +
    my_theme1 +
    theme(strip.background = element_blank(), strip.text.x = element_blank(), strip.placement = "outside") +
    stat_correlation(mapping = use_label(c("n")), label.x = "center",na.rm = TRUE) +
    annotate("text", x = 2500, y = 135, label = paste("n =", nrow_HR), color = "pink", size = 5) +
    geom_line(aes(x = Time2, y = bl_HR.E4), color = "blue", size = 0.8) +
    geom_line(aes(x = Time2, y = bl_HR.AW), color = "orange", size = 0.8)

  plot_HRV <- subset_data %>%
    filter(!is.na(HRV.IBI)) %>%
    ggplot(aes(x = Time, y = HRV.IBI)) +
    geom_line(color = "black", linewidth = 0.5, na.rm = TRUE) +
    xlim(c(0, 10000)) +
    scale_y_continuous(limits = c(0.2, 1.7), expand = c(0, 0)) +
    labs(title = "HRV.IBI [ms]", y = "", x = "") +
    my_theme1 +
    theme(strip.background = element_blank(), strip.text.x = element_blank(), strip.placement = "outside") +
    stat_correlation(mapping = use_label(c("n")), label.x = "center",na.rm = TRUE) +
    geom_line(aes(x = Time2, y = bl_HRV.IBI), color = "blue", size = 0.8)

  return(list(perspiration = plot_perspiration, HR = plot_HR, HRV = plot_HRV))
}

plot_s001 <- create_plots("S001")
p001 <- ggarrange(plot_s001$perspiration, 
                  plot_s001$HR,
                  plot_s001$HRV, nrow=1, ncol=3)

plot_s001

plot_s002 <- create_plots("S002")
p002 <- ggarrange(plot_s002$perspiration+labs(title = NULL), plot_s002$HR+labs(title = NULL), plot_s002$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s003 <- create_plots("S003")
p003 <- ggarrange(plot_s003$perspiration+labs(title = NULL), plot_s003$HR+labs(title = NULL), plot_s003$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s004 <- create_plots("S004")
p004 <- ggarrange(plot_s004$perspiration+labs(title = NULL), plot_s004$HR+labs(title = NULL), plot_s004$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s005 <- create_plots("S005")
p005 <- ggarrange(plot_s005$perspiration+labs(title = NULL), plot_s005$HR+labs(title = NULL), plot_s005$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s006 <- create_plots("S006")
p006 <- ggarrange(plot_s006$perspiration+ xlab("Time [s]")+labs(title = NULL),
                  plot_s006$HR+ xlab("Time [s]")+labs(title = NULL),
                  plot_s006$HRV+ xlab("Time [s]")+labs(title = NULL), nrow=1, ncol=3)


plot_s007 <- create_plots("S007")
p007 <- ggarrange(plot_s007$perspiration, plot_s007$HR, plot_s007$HRV, nrow=1, ncol=3)

plot_s008 <- create_plots("S008")
p008 <- ggarrange(plot_s008$perspiration+labs(title = NULL), plot_s008$HR+labs(title = NULL), plot_s008$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s009 <- create_plots("S009")
p009 <- ggarrange(plot_s009$perspiration+labs(title = NULL), plot_s009$HR+labs(title = NULL), plot_s009$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s010 <- create_plots("S010")
p010 <- ggarrange(plot_s010$perspiration+labs(title = NULL), plot_s010$HR+labs(title = NULL), plot_s010$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s011 <- create_plots("S011")
p011 <- ggarrange(plot_s011$perspiration+labs(title = NULL), plot_s011$HR+labs(title = NULL), plot_s011$HRV+labs(title = NULL), nrow=1, ncol=3)


plot_s012 <- create_plots("S012")
p012 <- ggarrange(plot_s012$perspiration+ xlab("Time [s]")+labs(title = NULL), 
                  plot_s012$HR+ xlab("Time [s]")+labs(title = NULL), 
                  plot_s012$HRV+ xlab("Time [s]")+labs(title = NULL), nrow=1, ncol=3)



plot_s013 <- create_plots("S013")
p013 <- ggarrange(plot_s013$perspiration, plot_s013$HR, plot_s013$HRV, nrow=1, ncol=3)

plot_s014 <- create_plots("S014")
p014 <- ggarrange(plot_s014$perspiration+labs(title = NULL), plot_s014$HR+labs(title = NULL), plot_s014$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s015 <- create_plots("S015")
p015 <- ggarrange(plot_s015$perspiration+labs(title = NULL), plot_s015$HR+labs(title = NULL), plot_s015$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s016 <- create_plots("S016")
p016 <- ggarrange(plot_s016$perspiration+labs(title = NULL), plot_s016$HR+labs(title = NULL), plot_s016$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s017 <- create_plots("S017")
p017 <- ggarrange(plot_s017$perspiration+labs(title = NULL), plot_s017$HR+labs(title = NULL), plot_s017$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s018 <- create_plots("S018")
p018 <- ggarrange(plot_s018$perspiration+ xlab("Time [s]")+labs(title = NULL),
                  plot_s018$HR+ xlab("Time [s]")+labs(title = NULL),
                  plot_s018$HRV+ xlab("Time [s]")+labs(title = NULL), nrow=1, ncol=3)


plot_s019 <- create_plots("S019")
p019 <- ggarrange(plot_s019$perspiration, plot_s019$HR, plot_s019$HRV, nrow=1, ncol=3)

plot_s020 <- create_plots("S020")
p020 <- ggarrange(plot_s020$perspiration+labs(title = NULL), plot_s020$HR+labs(title = NULL), plot_s020$HRV+labs(title = NULL), nrow=1, ncol=3)


plot_s021 <- create_plots("S021")
p021 <- ggarrange(plot_s021$perspiration+labs(title = NULL), plot_s021$HR+labs(title = NULL), plot_s021$HRV+labs(title = NULL), nrow=1, ncol=3)


plot_s022 <- create_plots("S022")
p022 <- ggarrange(plot_s022$perspiration+labs(title = NULL), plot_s022$HR+labs(title = NULL), plot_s022$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s023 <- create_plots("S023")
p023 <- ggarrange(plot_s023$perspiration+labs(title = NULL), plot_s023$HR+labs(title = NULL), plot_s023$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s024 <- create_plots("S024")
p024 <- ggarrange(plot_s024$perspiration+ xlab("Time [s]")+labs(title = NULL), 
                  plot_s024$HR+ xlab("Time [s]")+labs(title = NULL), 
                  plot_s024$HRV+ xlab("Time [s]")+labs(title = NULL), nrow=1, ncol=3)


plot_s025 <- create_plots("S025")
p025 <- ggarrange(plot_s025$perspiration, plot_s025$HR, plot_s025$HRV, nrow=1, ncol=3)

plot_s026 <- create_plots("S026")
p026 <- ggarrange(plot_s026$perspiration+labs(title = NULL), plot_s026$HR+labs(title = NULL), plot_s026$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s027 <- create_plots("S027")
p027 <- ggarrange(plot_s027$perspiration+labs(title = NULL), plot_s027$HR+labs(title = NULL), plot_s027$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s028 <- create_plots("S028")
p028 <- ggarrange(plot_s028$perspiration+labs(title = NULL), plot_s028$HR+labs(title = NULL), plot_s028$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s029 <- create_plots("S029")
p029 <- ggarrange(plot_s029$perspiration+labs(title = NULL), plot_s029$HR+labs(title = NULL), plot_s029$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s030 <- create_plots("S030")
p030 <- ggarrange(plot_s030$perspiration+ xlab("Time [s]")+labs(title = NULL),
                  plot_s030$HR+ xlab("Time [s]")+labs(title = NULL),
                  plot_s030$HRV+ xlab("Time [s]")+labs(title = NULL), nrow=1, ncol=3)

```

```{r echo=FALSE, fig.height=16, fig.width=13, message=FALSE, warning=FALSE}
ggarrange(p001,p002,p003,p004,p005,p006, nrow=6, ncol = 1)

```


\newpage

```{r echo=FALSE, fig.height=16, fig.width=13, message=FALSE, warning=FALSE}
ggarrange(p007,p008,p009,p010,p011,p012, nrow=6, ncol = 1)

```

\newpage

```{r echo=FALSE, fig.height=16, fig.width=13, message=FALSE, warning=FALSE}
ggarrange(p013,p014,p015,p016,p017,p018, nrow=6, ncol = 1)

```



\newpage

```{r echo=FALSE, fig.height=16, fig.width=13, message=FALSE, warning=FALSE}
ggarrange(p019,p020,p021,p022,p023,p024, nrow=6, ncol = 1)

```



\newpage

```{r echo=FALSE, fig.height=16, fig.width=13, message=FALSE, warning=FALSE}

ggarrange(p025,p026,p027,p028,p029,p030, nrow=6, ncol = 1)

```





\newpage

## Q2-Normalized signal matrix

```{r message=FALSE, warning=FALSE, include=FALSE}
# Function to create plots for a given participant
create_plots <- function(participant_id) {
  subset_data <- all.df %>%
    filter(ParticipantID == participant_id)
  
  nrow_HR <- nrow(subset_data %>% filter(!is.na(norm_HR.AW)))
  
  plot_perspiration <- subset_data %>%
    filter(!is.na(norm_Perspiration)) %>%
    ggplot(aes(x = Time2, y = norm_Perspiration)) +
    geom_line(color = "black", linewidth = 0.5, na.rm = TRUE) +
    xlim(c(0, 10000)) +
    scale_y_continuous(limits = c(-0.008, 0.008), expand = c(0, 0)) +
    labs(title = "Normed Perspiration [°C\u00B2]", x = "", y = participant_id) +
    my_theme1 +
    theme(strip.background = element_blank(), strip.placement = "outside") +
    stat_correlation(mapping = use_label(c("n")), label.x = "center",na.rm = TRUE) 

  plot_HR <- subset_data %>%
    filter(!is.na(norm_HR.E4) | !is.na(norm_HR.AW)) %>%
    ggplot(aes(x = Time2, y = norm_HR.E4)) +
    geom_line(color = "black", linewidth = 0.5, na.rm = TRUE) +
    geom_point(aes(x = Time2, y = norm_HR.AW), color = "pink", size = 1, na.rm = TRUE, alpha = 0.3) +
    facet_wrap(ParticipantID ~ ., strip.position = "top", nrow = 1, ncol = 1, labeller = as_labeller(participant_id)) +
    xlim(c(0, 10000)) +
    scale_y_continuous(limits = c(-70, 70), expand = c(0, 0)) +
    labs(title = "Normed HR.E4 & Normed HR.AW [BMP]", y = "", x = "") +
    my_theme1 +
    theme(strip.background = element_blank(), strip.text.x = element_blank(), strip.placement = "outside") +
    stat_correlation(mapping = use_label(c("n")), label.x = "center",na.rm = TRUE) +
    annotate("text", x = 2500, y = 40, label = paste("n =", nrow_HR), color = "pink", size = 5)

  plot_HRV <- subset_data %>%
    filter(!is.na(norm_HRV.IBI)) %>%
    ggplot(aes(x = Time, y = norm_HRV.IBI)) +
    geom_line(color = "black", linewidth = 0.5, na.rm = TRUE) +
    xlim(c(0, 10000)) +
    scale_y_continuous(limits = c(-0.6, 1.1), expand = c(0, 0)) +
    labs(title = "Normed HRV.IBI [ms]", y = "", x = "") +
    my_theme1 +
    theme(strip.background = element_blank(), strip.text.x = element_blank(), strip.placement = "outside") +
    stat_correlation(mapping = use_label(c("n")), label.x = "center",na.rm = TRUE) 

  return(list(perspiration = plot_perspiration, HR = plot_HR, HRV = plot_HRV))
}

plot_s001 <- create_plots("S001")
p001 <- ggarrange(plot_s001$perspiration, 
                  plot_s001$HR,
                  plot_s001$HRV, nrow=1, ncol=3)


plot_s002 <- create_plots("S002")
p002 <- ggarrange(plot_s002$perspiration+labs(title = NULL), plot_s002$HR+labs(title = NULL), plot_s002$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s003 <- create_plots("S003")
p003 <- ggarrange(plot_s003$perspiration+labs(title = NULL), plot_s003$HR+labs(title = NULL), plot_s003$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s004 <- create_plots("S004")
p004 <- ggarrange(plot_s004$perspiration+labs(title = NULL), plot_s004$HR+labs(title = NULL), plot_s004$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s005 <- create_plots("S005")
p005 <- ggarrange(plot_s005$perspiration+labs(title = NULL), plot_s005$HR+labs(title = NULL), plot_s005$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s006 <- create_plots("S006")
p006 <- ggarrange(plot_s006$perspiration+ xlab("Time [s]")+labs(title = NULL), plot_s006$HR+ xlab("Time [s]")+labs(title = NULL), plot_s006$HRV+ xlab("Time [s]")+labs(title = NULL), nrow=1, ncol=3)


plot_s007 <- create_plots("S007")
p007 <- ggarrange(plot_s007$perspiration, plot_s007$HR, plot_s007$HRV, nrow=1, ncol=3)

plot_s008 <- create_plots("S008")
p008 <- ggarrange(plot_s008$perspiration+labs(title = NULL), plot_s008$HR+labs(title = NULL), plot_s008$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s009 <- create_plots("S009")
p009 <- ggarrange(plot_s009$perspiration+labs(title = NULL), plot_s009$HR+labs(title = NULL), plot_s009$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s010 <- create_plots("S010")
p010 <- ggarrange(plot_s010$perspiration+labs(title = NULL), plot_s010$HR+labs(title = NULL), plot_s010$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s011 <- create_plots("S011")
p011 <- ggarrange(plot_s011$perspiration+labs(title = NULL), plot_s011$HR+labs(title = NULL), plot_s011$HRV+labs(title = NULL), nrow=1, ncol=3)


plot_s012 <- create_plots("S012")
p012 <- ggarrange(plot_s012$perspiration+ xlab("Time [s]")+labs(title = NULL), plot_s012$HR+ xlab("Time [s]")+labs(title = NULL), plot_s012$HRV+ xlab("Time [s]")+labs(title = NULL), nrow=1, ncol=3)


plot_s013 <- create_plots("S013")
p013 <- ggarrange(plot_s013$perspiration, plot_s013$HR, plot_s013$HRV, nrow=1, ncol=3)

plot_s014 <- create_plots("S014")
p014 <- ggarrange(plot_s014$perspiration+labs(title = NULL), plot_s014$HR+labs(title = NULL), plot_s014$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s015 <- create_plots("S015")
p015 <- ggarrange(plot_s015$perspiration+labs(title = NULL), plot_s015$HR+labs(title = NULL), plot_s015$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s016 <- create_plots("S016")
p016 <- ggarrange(plot_s016$perspiration+labs(title = NULL), plot_s016$HR+labs(title = NULL), plot_s016$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s017 <- create_plots("S017")
p017 <- ggarrange(plot_s017$perspiration+labs(title = NULL), plot_s017$HR+labs(title = NULL), plot_s017$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s018 <- create_plots("S018")
p018 <- ggarrange(plot_s018$perspiration+ xlab("Time [s]")+labs(title = NULL), plot_s018$HR+ xlab("Time [s]")+labs(title = NULL), plot_s018$HRV+ xlab("Time [s]")+labs(title = NULL), nrow=1, ncol=3)


plot_s019 <- create_plots("S019")
p019 <- ggarrange(plot_s019$perspiration, plot_s019$HR, plot_s019$HRV, nrow=1, ncol=3)

plot_s020 <- create_plots("S020")
p020 <- ggarrange(plot_s020$perspiration+labs(title = NULL), plot_s020$HR+labs(title = NULL), plot_s020$HRV+labs(title = NULL), nrow=1, ncol=3)


plot_s021 <- create_plots("S021")
p021 <- ggarrange(plot_s021$perspiration+labs(title = NULL), plot_s021$HR+labs(title = NULL), plot_s021$HRV+labs(title = NULL), nrow=1, ncol=3)


plot_s022 <- create_plots("S022")
p022 <- ggarrange(plot_s022$perspiration+labs(title = NULL), plot_s022$HR+labs(title = NULL), plot_s022$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s023 <- create_plots("S023")
p023 <- ggarrange(plot_s023$perspiration+labs(title = NULL), plot_s023$HR+labs(title = NULL), plot_s023$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s024 <- create_plots("S024")
p024 <- ggarrange(plot_s024$perspiration+ xlab("Time [s]")+labs(title = NULL), plot_s024$HR+ xlab("Time [s]")+labs(title = NULL), plot_s024$HRV+ xlab("Time [s]")+labs(title = NULL), nrow=1, ncol=3)


plot_s025 <- create_plots("S025")
p025 <- ggarrange(plot_s025$perspiration, plot_s025$HR, plot_s025$HRV, nrow=1, ncol=3)

plot_s026 <- create_plots("S026")
p026 <- ggarrange(plot_s026$perspiration+labs(title = NULL), plot_s026$HR+labs(title = NULL), plot_s026$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s027 <- create_plots("S027")
p027 <- ggarrange(plot_s027$perspiration+labs(title = NULL), plot_s027$HR+labs(title = NULL), plot_s027$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s028 <- create_plots("S028")
p028 <- ggarrange(plot_s028$perspiration+labs(title = NULL), plot_s028$HR+labs(title = NULL), plot_s028$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s029 <- create_plots("S029")
p029 <- ggarrange(plot_s029$perspiration+labs(title = NULL), plot_s029$HR+labs(title = NULL), plot_s029$HRV+labs(title = NULL), nrow=1, ncol=3)

plot_s030 <- create_plots("S030")
p030 <- ggarrange(plot_s030$perspiration+ xlab("Time [s]")+labs(title = NULL), plot_s030$HR+ xlab("Time [s]")+labs(title = NULL), plot_s030$HRV+ xlab("Time [s]")+labs(title = NULL), nrow=1, ncol=3)

```




```{r echo=FALSE, fig.height=16, fig.width=13, message=FALSE, warning=FALSE}
ggarrange(p001,p002,p003,p004,p005,p006, nrow=6, ncol = 1)

```

\newpage

```{r echo=FALSE, fig.height=16, fig.width=13, message=FALSE, warning=FALSE}
ggarrange(p007,p008,p009,p010,p011,p012, nrow=6, ncol = 1)

```


\newpage

```{r echo=FALSE, fig.height=16, fig.width=13, message=FALSE, warning=FALSE}
ggarrange(p013,p014,p015,p016,p017,p018, nrow=6, ncol = 1)

```

\newpage

```{r echo=FALSE, fig.height=16, fig.width=13, message=FALSE, warning=FALSE}
ggarrange(p019,p020,p021,p022,p023,p024, nrow=6, ncol = 1)

```


\newpage

```{r echo=FALSE, fig.height=16, fig.width=13, message=FALSE, warning=FALSE}

ggarrange(p025,p026,p027,p028,p029,p030, nrow=6, ncol = 1)

```




## Q3-Matrix of summary statistical graphs (Raw datas)


```{r message=FALSE, warning=FALSE, include=FALSE}
generate_ExamVersion2 <- function(df) {
  df %>%
    group_by(ParticipantID) %>%
    mutate(
      ExamVersion2 = Question.Type
      #exam_version_counts = n(),
      #part_count = floor(exam_version_counts / 3),
      #ExamVersion2 = case_when(
      #  ExamVersion == "WAV" ~ ifelse(row_number() <= part_count, "W", ifelse(row_number() <= 2 * part_count, "A", "V")),
      #  ExamVersion == "WVA" ~ ifelse(row_number() <= part_count, "W", ifelse(row_number() <= 2 * part_count, "V", "A")),
      #  ExamVersion == "AWV" ~ ifelse(row_number() <= part_count, "A", ifelse(row_number() <= 2 * part_count, "W", "V")),
      #  ExamVersion == "AVW" ~ ifelse(row_number() <= part_count, "A", ifelse(row_number() <= 2 * part_count, "V", "W")),
      #  ExamVersion == "VWA" ~ ifelse(row_number() <= part_count, "V", ifelse(row_number() <= 2 * part_count, "W", "A")),
      #  ExamVersion == "VAW" ~ ifelse(row_number() <= part_count, "V", ifelse(row_number() <= 2 * part_count, "A", "W")),
      #  TRUE ~ ExamVersion
      #)
    ) #%>%
    #select(-exam_version_counts, -part_count)
}

# Apply the function to the entire dataframe
all.df2 <- all.df %>%
  group_by(ParticipantID) %>%
  do(generate_ExamVersion2(.))

all.df2
```


```{r message=FALSE, warning=FALSE, include=FALSE}
  
p1 <- all.df2 %>%
    filter(ParticipantID=="S001") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Perspiration [°C\u00B2]") +
      ylab("S001") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S001") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S001") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S001") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f001 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f001,
               left = text_grob("S001", color = "green", rot = 90) )


```

```{r fig.height=16, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}

p1 <- all.df2 %>%
    filter(ParticipantID=="S002") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S002") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S002") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S002") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S002") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f002 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f002,
               left = text_grob("S002", color = "green", rot = 90) )
```


```{r fig.height=16, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
#S003


p1 <- all.df2 %>%
    filter(ParticipantID=="S003") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S003") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S003") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S003") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S003") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f003 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f003,
               left = text_grob("S003", color = "green", rot = 90) )

```

```{r fig.height=16, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
#S004


p1 <- all.df2 %>%
    filter(ParticipantID=="S004") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S004") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S004") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S004") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S004") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f004 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f004,
               left = text_grob("S004", color = "green", rot = 90) )
```

```{r fig.height=16, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
#S005


p1 <- all.df2 %>%
    filter(ParticipantID=="S005") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S005") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S005") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S005") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S005") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f005 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f005,
               left = text_grob("S005", color = "green", rot = 90) )
```

```{r fig.height=16, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
#S006

p1 <- all.df2 %>%
    filter(ParticipantID=="S006") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S006") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S006") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S006") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S006") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f006 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f006,
               left = text_grob("S006", color = "green", rot = 90) )
```

```{r fig.height=16, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
#S007

p1 <- all.df2 %>%
    filter(ParticipantID=="S007") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Perspiration [°C\u00B2]") +
      ylab("S007") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S007") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S007") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S007") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f007 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f007,
               left = text_grob("S007", color = "green", rot = 90) )

```

```{r fig.height=16, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
#S008

p1 <- all.df2 %>%
    filter(ParticipantID=="S008") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S008") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S008") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S008") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S008") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f008 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f008,
               left = text_grob("S008", color = "green", rot = 90) )

```

```{r fig.height=16, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
#S009

p1 <- all.df2 %>%
    filter(ParticipantID=="S009") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S009") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S009") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S009") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S009") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f009 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f009,
               left = text_grob("S009", color = "green", rot = 90) )

```

```{r fig.height=16, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
#S010


p1 <- all.df2 %>%
    filter(ParticipantID=="S010") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S010") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S010") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S010") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S010") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f010 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f010,
               left = text_grob("S010", color = "green", rot = 90) )
```

```{r fig.height=16, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
#S011


p1 <- all.df2 %>%
    filter(ParticipantID=="S011") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S011") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S011") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S011") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S011") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f011 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f011,
               left = text_grob("S011", color = "green", rot = 90) )

```

```{r fig.height=16, fig.width=15, include=FALSE}
#S012


p1 <- all.df2 %>%
    filter(ParticipantID=="S012") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S012") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S012") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S012") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S012") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f012 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f012,
               left = text_grob("S012", color = "green", rot = 90) )
```

```{r fig.height=16, fig.width=15, include=FALSE}
#S013


p1 <- all.df2 %>%
    filter(ParticipantID=="S013") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Perspiration [°C\u00B2]") +
      ylab("S013") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S013") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S013") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S013") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f013 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f013,
               left = text_grob("S013", color = "green", rot = 90) )
```

```{r fig.height=16, fig.width=15, include=FALSE}
#S014


p1 <- all.df2 %>%
    filter(ParticipantID=="S014") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S014") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S014") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S014") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S014") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f014 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f014,
               left = text_grob("S014", color = "green", rot = 90) )
```

```{r fig.height=16, fig.width=15, include=FALSE}
#S015


p1 <- all.df2 %>%
    filter(ParticipantID=="S015") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S015") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S015") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S015") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S015") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f015 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f015,
               left = text_grob("S015", color = "green", rot = 90) )

```

```{r fig.height=16, fig.width=15, include=FALSE}
#S016


p1 <- all.df2 %>%
    filter(ParticipantID=="S016") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S016") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S016") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S016") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S016") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f016 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f016,
               left = text_grob("S016", color = "green", rot = 90) )
```

```{r fig.height=16, fig.width=15, include=FALSE}
#S017


p1 <- all.df2 %>%
    filter(ParticipantID=="S017") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S017") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S017") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S017") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S017") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f017 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f017,
               left = text_grob("S017", color = "green", rot = 90) )

```

```{r fig.height=16, fig.width=15, include=FALSE}
#S018


p1 <- all.df2 %>%
    filter(ParticipantID=="S018") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S018") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S018") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S018") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S018") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f018 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f018,
               left = text_grob("S018", color = "green", rot = 90) )
```

```{r fig.height=16, fig.width=15, include=FALSE}
#S019


p1 <- all.df2 %>%
    filter(ParticipantID=="S019") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Perspiration [°C\u00B2]") +
      ylab("S019") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S019") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S019") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S019") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f019 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f019,
               left = text_grob("S019", color = "green", rot = 90) )
```

```{r fig.height=16, fig.width=15, include=FALSE}
#S020


p1 <- all.df2 %>%
    filter(ParticipantID=="S020") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S020") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S020") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S020") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S020") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f020 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f020,
               left = text_grob("S020", color = "green", rot = 90) )

```

```{r fig.height=16, fig.width=15, include=FALSE}
#S021


p1 <- all.df2 %>%
    filter(ParticipantID=="S021") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S021") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S021") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S021") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S021") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f021 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f021,
               left = text_grob("S021", color = "green", rot = 90) )
```

```{r fig.height=16, fig.width=15, include=FALSE}
#S022


p1 <- all.df2 %>%
    filter(ParticipantID=="S022") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S022") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S022") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S022") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S022") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f022 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f022,
               left = text_grob("S022", color = "green", rot = 90) )

```

```{r fig.height=16, fig.width=15, include=FALSE}
#S023


p1 <- all.df2 %>%
    filter(ParticipantID=="S023") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S023") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S023") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S023") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S023") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f023 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f023,
               left = text_grob("S023", color = "green", rot = 90) )
```

```{r fig.height=16, fig.width=15, include=FALSE}
#S024


p1 <- all.df2 %>%
    filter(ParticipantID=="S024") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S024") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S024") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S024") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S024") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f024 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f024,
               left = text_grob("S024", color = "green", rot = 90) )
```

```{r fig.height=16, fig.width=15, include=FALSE}
#S025


p1 <- all.df2 %>%
    filter(ParticipantID=="S025") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Perspiration [°C\u00B2]") +
      ylab("S025") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S025") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S025") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S025") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f025 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f025,
               left = text_grob("S025", color = "green", rot = 90) )

```

```{r fig.height=16, fig.width=15, include=FALSE}
#S026


p1 <- all.df2 %>%
    filter(ParticipantID=="S026") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S026") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S026") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S026") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S026") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f026 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f026,
               left = text_grob("S026", color = "green", rot = 90) )

```

```{r fig.height=16, fig.width=15, include=FALSE}
#S027


p1 <- all.df2 %>%
    filter(ParticipantID=="S027") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S027") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S027") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S027") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S027") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f027 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f027,
               left = text_grob("S027", color = "green", rot = 90) )

```

```{r fig.height=16, fig.width=15, include=FALSE}
#S028


p1 <- all.df2 %>%
    filter(ParticipantID=="S028") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S028") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S028") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S028") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S028") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f028 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f028,
               left = text_grob("S028", color = "green", rot = 90) )

```

```{r fig.height=16, fig.width=15, include=FALSE}
#S029


p1 <- all.df2 %>%
    filter(ParticipantID=="S029") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S029") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S029") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S029") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S029") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f029 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f029,
               left = text_grob("S029", color = "green", rot = 90) )

```

```{r fig.height=16, fig.width=15, include=FALSE}
#S030


p1 <- all.df2 %>%
    filter(ParticipantID=="S030") %>%
    filter(!is.na(Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Perspiration [°C\u00B2]") +
      ylab("S030") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S030") %>%
    filter(!is.na(HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S030") %>%
    filter(!is.na(HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S030") %>%
    filter(!is.na(HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f030 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f030,
               left = text_grob("S030", color = "green", rot = 90) )
```

```{r echo=FALSE, fig.height=16, fig.width=13}
ggarrange(f001,f002,f003,f004,f005,f006, nrow=6, ncol = 1)

```
\newpage

```{r echo=FALSE, fig.height=16, fig.width=13}
ggarrange(f007,f008,f009,f010,f011,f012, nrow=6, ncol = 1)

```
\newpage

```{r echo=FALSE, fig.height=16, fig.width=13}
ggarrange(f013,f014,f015,f016,f017,f018, nrow=6, ncol = 1)

```
\newpage

```{r echo=FALSE, fig.height=16, fig.width=13}
ggarrange(f019,f020,f021,f022,f023,f024, nrow=6, ncol = 1)

```

\newpage

```{r echo=FALSE, fig.height=16, fig.width=13}
ggarrange(f025,f026,f027,f028,f029,f030, nrow=6, ncol = 1)

```


## Q3-Matrix of summary statistical graphs (Normalized datas)

```{r message=FALSE, warning=FALSE, include=FALSE}
# for normed 
#S001
p1 <- all.df2 %>%
    filter(ParticipantID=="S001") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S001") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S001") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S001") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S001") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f001 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f001,
               left = text_grob("S001", color = "green", rot = 90) )


```

```{r include=FALSE}
# for normed 
#S002

p1 <- all.df2 %>%
    filter(ParticipantID=="S002") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S002") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S002") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S002") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S002") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f002 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f002,
               left = text_grob("S002", color = "green", rot = 90) )
```

```{r include=FALSE}
# for normed 
#S003

p1 <- all.df2 %>%
    filter(ParticipantID=="S003") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S003") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S003") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S003") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S003") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f003 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f003,
               left = text_grob("S003", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S004

p1 <- all.df2 %>%
    filter(ParticipantID=="S004") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S004") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S004") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S004") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S004") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f004 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f004,
               left = text_grob("S004", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S005

p1 <- all.df2 %>%
    filter(ParticipantID=="S005") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S005") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S005") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S005") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S005") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f005 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f005,
               left = text_grob("S005", color = "green", rot = 90) )
```

```{r include=FALSE}
# for normed 
#S006

p1 <- all.df2 %>%
    filter(ParticipantID=="S006") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S006") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S006") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S006") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S006") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f006 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f006,
               left = text_grob("S006", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S007

p1 <- all.df2 %>%
    filter(ParticipantID=="S007") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S007") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S007") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S007") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S007") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f007 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f007,
               left = text_grob("S007", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S008

p1 <- all.df2 %>%
    filter(ParticipantID=="S008") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S008") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S008") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S008") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S008") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f008 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f008,
               left = text_grob("S008", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S009

p1 <- all.df2 %>%
    filter(ParticipantID=="S009") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S009") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S009") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S009") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S009") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f009 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f009,
               left = text_grob("S009", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S010

p1 <- all.df2 %>%
    filter(ParticipantID=="S010") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S010") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S010") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S010") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S010") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f010 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f010,
               left = text_grob("S010", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S011

p1 <- all.df2 %>%
    filter(ParticipantID=="S011") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S011") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S011") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S011") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S011") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f011 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f011,
               left = text_grob("S011", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S012

p1 <- all.df2 %>%
    filter(ParticipantID=="S012") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S012") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S012") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S012") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S012") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f012 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f012,
               left = text_grob("S012", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S013

p1 <- all.df2 %>%
    filter(ParticipantID=="S013") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S013") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S013") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S013") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S013") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f013 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f013,
               left = text_grob("S013", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S014

p1 <- all.df2 %>%
    filter(ParticipantID=="S014") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S014") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S014") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S014") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S014") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f014 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f014,
               left = text_grob("S014", color = "green", rot = 90) )
```

```{r include=FALSE}
# for normed 
#S015

p1 <- all.df2 %>%
    filter(ParticipantID=="S015") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S015") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S015") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S015") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S015") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f015 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f015,
               left = text_grob("S015", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S016

p1 <- all.df2 %>%
    filter(ParticipantID=="S016") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S016") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S016") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S016") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S016") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f016 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f016,
               left = text_grob("S016", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S017

p1 <- all.df2 %>%
    filter(ParticipantID=="S017") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S017") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S017") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S017") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S017") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f017 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f017,
               left = text_grob("S017", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S018

p1 <- all.df2 %>%
    filter(ParticipantID=="S018") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S018") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S018") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S018") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S018") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f018 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f018,
               left = text_grob("S018", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S019

p1 <- all.df2 %>%
    filter(ParticipantID=="S019") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S019") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S019") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S019") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S019") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f019 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f019,
               left = text_grob("S019", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S020

p1 <- all.df2 %>%
    filter(ParticipantID=="S020") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S020") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S020") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S020") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S020") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f020 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f020,
               left = text_grob("S020", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S021

p1 <- all.df2 %>%
    filter(ParticipantID=="S021") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S021") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S021") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S021") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S021") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f021 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f021,
               left = text_grob("S021", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S022

p1 <- all.df2 %>%
    filter(ParticipantID=="S022") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S022") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S022") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S022") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S022") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f022 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f022,
               left = text_grob("S022", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S023

p1 <- all.df2 %>%
    filter(ParticipantID=="S023") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S023") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S023") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S023") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S023") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f023 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f023,
               left = text_grob("S023", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S024

p1 <- all.df2 %>%
    filter(ParticipantID=="S024") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S024") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S024") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S024") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S024") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f024 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f024,
               left = text_grob("S024", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S025

p1 <- all.df2 %>%
    filter(ParticipantID=="S025") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S025") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S025") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S025") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S025") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f025 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f025,
               left = text_grob("S025", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S026

p1 <- all.df2 %>%
    filter(ParticipantID=="S026") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S026") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S026") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S026") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S026") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f026 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f026,
               left = text_grob("S026", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S027

p1 <- all.df2 %>%
    filter(ParticipantID=="S027") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S027") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S027") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S027") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S027") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f027 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f027,
               left = text_grob("S027", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S028

p1 <- all.df2 %>%
    filter(ParticipantID=="S028") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S028") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S028") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S028") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S028") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f028 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f028,
               left = text_grob("S028", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S029

p1 <- all.df2 %>%
    filter(ParticipantID=="S029") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S029") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S029") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S029") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S029") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f029 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f029,
               left = text_grob("S029", color = "green", rot = 90) )
```
```{r include=FALSE}
# for normed 
#S030

p1 <- all.df2 %>%
    filter(ParticipantID=="S030") %>%
    filter(!is.na(norm_Perspiration)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_Perspiration)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed Perspiration [°C\u00B2]") +
      ylab("S030") + xlab("") + theme_minimal()

p1

p2 <- all.df2 %>%
    filter(ParticipantID=="S030") %>%
    filter(!is.na(norm_HR.E4)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.E4)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.E4 [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p2

p3 <- all.df2 %>%
    filter(ParticipantID=="S030") %>%
    filter(!is.na(norm_HR.AW)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HR.AW)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HR.AW [BMP]") +
      ylab("") + xlab("") + theme_minimal()

p3

p4 <- all.df2 %>%
    filter(ParticipantID=="S030") %>%
    filter(!is.na(norm_HRV.IBI)) %>%
      ggplot(aes(x=ExamVersion2, y=norm_HRV.IBI)) + 
      geom_boxplot() +
      geom_boxplot(fill = "lightblue") +
      #ggtitle("Normed HRV.IBI [ms]") +
      ylab("") + xlab("") + theme_minimal()

p4

f030 <- ggarrange(p1,p2,p3,p4, ncol = 4, nrow = 1 )

annotate_figure(f030,
               left = text_grob("S030", color = "green", rot = 90) )
```

```{r echo=FALSE, fig.height=16, fig.width=13}
ggarrange(f001,f002,f003,f004,f005,f006, nrow=6, ncol = 1)

```

```{r echo=FALSE, fig.height=16, fig.width=13}
ggarrange(f007,f008,f009,f010,f011,f012, nrow=6, ncol = 1)

```

```{r echo=FALSE, fig.height=16, fig.width=13}
ggarrange(f013,f014,f015,f016,f017,f018, nrow=6, ncol = 1)

```

```{r echo=FALSE, fig.height=16, fig.width=13}
ggarrange(f019,f020,f021,f022,f023,f024, nrow=6, ncol = 1)

```

```{r echo=FALSE, fig.height=16, fig.width=13}
ggarrange(f025,f026,f027,f028,f029,f030, nrow=6, ncol = 1)

```

\newpage

## Q4-Gained Insights  

1 To facilitate comparisons: 

1) Column-wise, we factor out the time axis annotation, something that also keeps the figure uncluttered. 2) We use the same range in the vertical axes of each variable. To maximize resolution, we define a variable’s common vertical axis range to be between its global minimum and maximum. For instance, in Perspiration the global extreme are approximately 0 and 0.10, marking accordingly the bottom and top of the applicable y-axes. 3) We enhance visual separation among variables by coloring their signals differently -- black for the continuous data(including Perspiration, HR.E4 and HRV.IBI), blue for baselines, pink for the individual data points of HR.AW and orange for the baseline of HR.AW.


2 The arrangements:

We observe that the S001, S004, S008, S020, S025 are the longest, lasting more than two hours, S005, S010, S017, S021, S028 are much shorter, lasting less than one hour, others are between one hour and two hours. 

We also observe that the perspiration(black line) of S022 has the biggest fluctuation, others are much flat. The perspiration of S001, S007, S011, S012, S013, S017, S021, S024, S025, S026 fluctuate stably  around the baseline with little change. Most data of the perspiration of S002, S003, S004, S005, S008, S009, S010, S020, S023, S027, S029, S030 are above the baseline and with less fluctuate which are relatively stable. The rest of the data, including S006, S014, S015, S016, S018, S019, S028, fluctuate widely and distributed on both sides of the baseline. 

About the data of HR.AW(pink points), the data of S003, S004, S006, S008, S010, S011, S012, S014, S016, S017, S019, S022, S023, S024, S025, S027, S028,S030 more evenly distributed around the baseline. Most of S001, S002, S005, S013, S015, S018, S021, S026, S029 are distributed below the baseline, and the range of fluctuation is small. On the contrary, the data of S009, S020 are above the baseline. S007 has the biggest fluctuation. 

About the data of HR.E4(black line), S001, S004, S006, S008, S012, S016, S017, S020, S022, S024, S025, S026, S027, S028, S029, S030 have the stable fluctuation and around the baseline. S005, S013, S015, S018, S021 have huge fluctuation but still around the baseline.The data of S009 is much more above the baseline, but S014 is below the baseline. There are some sudden peek changes in the stable fluctuation about S002, S003, S007, S010, S011, S019, S023. 

We observe that most of the HRV.IBI(black line) are densely distributed and concentrated near the baseline, expect S005, S015. We also find all the duration of HRV.IBI are much shorter than Perspiration, HR.E4 and HR.AW.

After the normalization of data, the fluctuation and regularity of the data do not change, and it is the same as the original. 

The box plots are used to show the distribution of each variable. Box plots provide information about the median, quartiles, and potential outliers of a distribution, allowing for a visual comparison of the central tendency and spread of each variable.

By looking at the median of the Perspiration, most of them are between 0.005 and 0.010. The median of S006 (WORD and VIDEO tasks of interest) are higher than 0.010, and some tasks of interest about S013, S015, S018 and S022 are less than 0.05. According to the box size of each box diagram, we can observe Perspiration(ABSTRACT) of S014 and S017 are much small, so we know that their data distribution is relatively concentrated and the degree of dispersion is low. The Perspiration of S016(ABSTRACT) is largest, which means that its data distribution is relatively wide and the degree of dispersion is high. About the  interquartile range (IQR) or the size of boxes, we can get that S005, S007, S010, S011, S012, S016, S019, S020, S021, S024, S026, S027, S028, S029 and S030 almost have the same size for each task(that means the data similarly spread around the median, the smaller size, the denser the data distribution around the median)，however there are significant difference in each task of other participants. Most box plots are symmetrical(that means the data is evenly distributed around the median), some are not. If the box is symmetrical, the data is close to normal distribution; If it is not symmetrical, the data may be skewed. Only SOO6 does not have outliers, and other participants all have some outliers on different tasks, or more or less(the more outliers, the greater the variability in the data). 

Similarly, the median of HR.E4 and HR.AW are in the range of 70-90. Some tasks of interest of S004, S011, S013, S021 are less than 65. All the tasks of interest of S003 and S010 have the smallest, and that means the data distribution of HR.E4 is much concentrated. The task of VEDIO of S009 is biggest, which tell us its data distribution is widest and the degree of dispersion is highest. The three task of interest of the HR.AW of S006 are all small, compared to other participants, so the distribution of S006 is much more concentrated. All tasks about S027 have no outliers on HR.E4 data. S028 has a few outliers on HR.AW data. 

The range of median is from 0.5 to 1.0 on HRI.IBI data. Most of the box plots of the HRI.IBI are small, indicating the data of HRI.IBI are much concentrated. S012 and S014 have a few outliers. 

At last, the box plots of the normalized data don't have change from the original. 

\newpage

# Step 2

1. Construct a participant-level matrix of momentary stacked plots that will show how expressed emotions evolve as wave-like time series.

2. Compute the dominant emotions each moment and label each frame in the dataset accordingly. Construct the summary proportion plots for these emotion labels per task (ABSTRACT, WORD, VIDEO). Construct also a table with the relevant descriptive statistics.

3. Express the insights you have gained.

\newpage

## Q1-Time series stacked plot for each participant wtih WVA 

```{r message=FALSE, warning=FALSE, include=FALSE}
# Remove the NA rows

all.df3 <- all.df2 %>% drop_na(F_Angry, F_Disgusted, F_Afraid, F_Happy, F_Sad, F_Surprised, F_Neutral)

# find max value index, label the status
emotions <- all.df3[, c('F_Angry', 'F_Disgusted', 'F_Afraid', 'F_Happy','F_Sad', 'F_Surprised', 'F_Neutral')]
# Apply which.max to each row and get the column names of the max values
all.df3$max_emotions <- apply(emotions, 1, function(x) colnames(emotions)[which.max(x)])

all.df3
```


```{r message=FALSE, warning=FALSE, include=FALSE}
generate_area_plot <- function(participant_id, exam_version, all_data) {
  subset_data <- all_data %>%
    filter(ParticipantID == participant_id & ExamVersion2 == exam_version) 
  
  values <- c(subset_data$F_Angry, subset_data$F_Disgusted, subset_data$F_Afraid, 
              subset_data$F_Happy, subset_data$F_Sad, subset_data$F_Surprised, 
              subset_data$F_Neutral)
  
  emotions <- c(rep("F_Angry", length(subset_data$F_Angry)),
                rep("F_Disgusted", length(subset_data$F_Disgusted)),
                rep("F_Afraid", length(subset_data$F_Afraid)),
                rep("F_Happy", length(subset_data$F_Happy)),
                rep("F_Sad", length(subset_data$F_Sad)),
                rep("F_Surprised", length(subset_data$F_Surprised)),
                rep("F_Neutral", length(subset_data$F_Neutral)))
  
  subset_combined <- data.frame(Time2 = rep(subset_data$Time2, 7),
                                value = values,
                                emotion = emotions)
  
  plot <- ggplot(data = subset_combined, aes(x = Time2, y = value, fill = emotion)) +
    geom_area() +
    scale_fill_manual(name = 'emotions',
                      values = c("F_Angry" = "blue", "F_Disgusted" = "green", 
                                 "F_Afraid" = "brown", "F_Happy" = "orange", 
                                 "F_Sad" = "cyan", "F_Surprised" = "purple", 
                                 "F_Neutral" = "pink"),
                      drop = FALSE) +
    coord_cartesian(xlim = c(0, 10000), ylim = c(0, 1)) +
    labs(title = paste(participant_id, exam_version, sep = " - "), x = "", y = "") +
    theme(plot.title = element_text(hjust = 0.5),
          panel.background = element_blank(),
          panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          axis.line = element_line(colour = "black"),
          panel.border = element_rect(colour = "black", fill = NA, linewidth = 1),
          legend.position = "none")  # Remove legend
  
  return(plot)
}

P001_A <- generate_area_plot("S001", "A", all.df3)
P001_V <- generate_area_plot("S001", "V", all.df3)
P001_W <- generate_area_plot("S001", "W", all.df3)

P002_A <- generate_area_plot("S002", "A", all.df3)
P002_V <- generate_area_plot("S002", "V", all.df3)
P002_W <- generate_area_plot("S002", "W", all.df3)

P003_A <- generate_area_plot("S003", "A", all.df3)
P003_V <- generate_area_plot("S003", "V", all.df3)
P003_W <- generate_area_plot("S003", "W", all.df3)

P004_A <- generate_area_plot("S004", "A", all.df3)
P004_V <- generate_area_plot("S004", "V", all.df3)
P004_W <- generate_area_plot("S004", "W", all.df3)

P005_A <- generate_area_plot("S005", "A", all.df3)
P005_V <- generate_area_plot("S005", "V", all.df3)
P005_W <- generate_area_plot("S005", "W", all.df3)

P006_A <- generate_area_plot("S006", "A", all.df3)
P006_V <- generate_area_plot("S006", "V", all.df3)
P006_W <- generate_area_plot("S006", "W", all.df3)

P007_A <- generate_area_plot("S007", "A", all.df3)
P007_V <- generate_area_plot("S007", "V", all.df3)
P007_W <- generate_area_plot("S007", "W", all.df3)

P008_A <- generate_area_plot("S008", "A", all.df3)
P008_V <- generate_area_plot("S008", "V", all.df3)
P008_W <- generate_area_plot("S008", "W", all.df3)

P009_A <- generate_area_plot("S009", "A", all.df3)
P009_V <- generate_area_plot("S009", "V", all.df3)
P009_W <- generate_area_plot("S009", "W", all.df3)

P010_A <- generate_area_plot("S010", "A", all.df3)
P010_V <- generate_area_plot("S010", "V", all.df3)
P010_W <- generate_area_plot("S010", "W", all.df3)

P011_A <- generate_area_plot("S011", "A", all.df3)
P011_V <- generate_area_plot("S011", "V", all.df3)
P011_W <- generate_area_plot("S011", "W", all.df3)

P012_A <- generate_area_plot("S012", "A", all.df3)
P012_V <- generate_area_plot("S012", "V", all.df3)
P012_W <- generate_area_plot("S012", "W", all.df3)

P013_A <- generate_area_plot("S013", "A", all.df3)
P013_V <- generate_area_plot("S013", "V", all.df3)
P013_W <- generate_area_plot("S013", "W", all.df3)

P014_A <- generate_area_plot("S014", "A", all.df3)
P014_V <- generate_area_plot("S014", "V", all.df3)
P014_W <- generate_area_plot("S014", "W", all.df3)

P015_A <- generate_area_plot("S015", "A", all.df3)
P015_V <- generate_area_plot("S015", "V", all.df3)
P015_W <- generate_area_plot("S015", "W", all.df3)

P016_A <- generate_area_plot("S016", "A", all.df3)
P016_V <- generate_area_plot("S016", "V", all.df3)
P016_W <- generate_area_plot("S016", "W", all.df3)

P017_A <- generate_area_plot("S017", "A", all.df3)
P017_V <- generate_area_plot("S017", "V", all.df3)
P017_W <- generate_area_plot("S017", "W", all.df3)

P018_A <- generate_area_plot("S018", "A", all.df3)
P018_V <- generate_area_plot("S018", "V", all.df3)
P018_W <- generate_area_plot("S018", "W", all.df3)

P019_A <- generate_area_plot("S019", "A", all.df3)
P019_V <- generate_area_plot("S019", "V", all.df3)
P019_W <- generate_area_plot("S019", "W", all.df3)

P020_A <- generate_area_plot("S020", "A", all.df3)
P020_V <- generate_area_plot("S020", "V", all.df3)
P020_W <- generate_area_plot("S020", "W", all.df3)

P021_A <- generate_area_plot("S021", "A", all.df3)
P021_V <- generate_area_plot("S021", "V", all.df3)
P021_W <- generate_area_plot("S021", "W", all.df3)

P022_A <- generate_area_plot("S022", "A", all.df3)
P022_V <- generate_area_plot("S022", "V", all.df3)
P022_W <- generate_area_plot("S022", "W", all.df3)

P023_A <- generate_area_plot("S023", "A", all.df3)
P023_V <- generate_area_plot("S023", "V", all.df3)
P023_W <- generate_area_plot("S023", "W", all.df3)

P024_A <- generate_area_plot("S024", "A", all.df3)
P024_V <- generate_area_plot("S024", "V", all.df3)
P024_W <- generate_area_plot("S024", "W", all.df3)

P025_A <- generate_area_plot("S025", "A", all.df3)
P025_V <- generate_area_plot("S025", "V", all.df3)
P025_W <- generate_area_plot("S025", "W", all.df3)

P026_A <- generate_area_plot("S026", "A", all.df3)
P026_V <- generate_area_plot("S026", "V", all.df3)
P026_W <- generate_area_plot("S026", "W", all.df3)

P027_A <- generate_area_plot("S027", "A", all.df3)
P027_V <- generate_area_plot("S027", "V", all.df3)
P027_W <- generate_area_plot("S027", "W", all.df3)

P028_A <- generate_area_plot("S028", "A", all.df3)
P028_V <- generate_area_plot("S028", "V", all.df3)
P028_W <- generate_area_plot("S028", "W", all.df3)

P029_A <- generate_area_plot("S029", "A", all.df3)
P029_V <- generate_area_plot("S029", "V", all.df3)
P029_W <- generate_area_plot("S029", "W", all.df3)

P030_A <- generate_area_plot("S030", "A", all.df3)
P030_V <- generate_area_plot("S030", "V", all.df3)
P030_W <- generate_area_plot("S030", "W", all.df3)

```


```{r echo=FALSE, fig.height=16, fig.width=15, message=FALSE, warning=FALSE}
ggarrange(P001_A + theme(legend.position = "none"),
          P001_V + theme(legend.position = "none"),
          P001_W + theme(legend.position = "none"),
          P002_A + theme(legend.position = "none"),
          P002_V + theme(legend.position = "none"),
          P002_W + theme(legend.position = "none"),
          P003_A + theme(legend.position = "none"),
          P003_V + theme(legend.position = "none"),
          P003_W + theme(legend.position = "none"),
          P004_A + theme(legend.position = "none"),
          P004_V + theme(legend.position = "none"),
          P004_W + theme(legend.position = "none"),
          P005_A + theme(legend.position = "none"),
          P005_V + theme(legend.position = "none"),
          P005_W + theme(legend.position = "none"),
          P006_A + theme(legend.position = "none"),
          P006_V + theme(legend.position = "none"),
          P006_W + theme(legend.position = "none"),
          P007_A + theme(legend.position = "none"),
          P007_V + theme(legend.position = "none"),
          P007_W + theme(legend.position = "none"),
          P008_A + theme(legend.position = "none"),
          P008_V + theme(legend.position = "none"),
          P008_W + theme(legend.position = "none"),
          P009_A + theme(legend.position = "none"),
          P009_V + theme(legend.position = "none"),
          P009_W + theme(legend.position = "none"),
          P010_A + theme(legend.position = "none"),
          P010_V + theme(legend.position = "none"),
          P010_W + theme(legend.position = "bottom"),
          
          nrow = 5, ncol = 6
          )
```



```{r echo=FALSE, fig.height=16, fig.width=15, message=FALSE, warning=FALSE}
ggarrange(P011_A + theme(legend.position = "none"),
          P011_V + theme(legend.position = "none"),
          P011_W + theme(legend.position = "none"),
          P012_A + theme(legend.position = "none"),
          P012_V + theme(legend.position = "none"),
          P012_W + theme(legend.position = "none"),
          P013_A + theme(legend.position = "none"),
          P013_V + theme(legend.position = "none"),
          P013_W + theme(legend.position = "none"),
          P014_A + theme(legend.position = "none"),
          P014_V + theme(legend.position = "none"),
          P014_W + theme(legend.position = "none"),
          P015_A + theme(legend.position = "none"),
          P015_V + theme(legend.position = "none"),
          P015_W + theme(legend.position = "none"),
          P016_A + theme(legend.position = "none"),
          P016_V + theme(legend.position = "none"),
          P016_W + theme(legend.position = "none"),
          P017_A + theme(legend.position = "none"),
          P017_V + theme(legend.position = "none"),
          P017_W + theme(legend.position = "none"),
          P018_A + theme(legend.position = "none"),
          P018_V + theme(legend.position = "none"),
          P018_W + theme(legend.position = "none"),
          P019_A + theme(legend.position = "none"),
          P019_V + theme(legend.position = "none"),
          P019_W + theme(legend.position = "none"),
          P020_A + theme(legend.position = "none"),
          P020_V + theme(legend.position = "none"),
          P020_W + theme(legend.position = "bottom"),
          
          nrow = 5, ncol = 6
          )
```



```{r echo=FALSE, fig.height=16, fig.width=15, message=FALSE, warning=FALSE}
ggarrange(P021_A + theme(legend.position = "none"),
          P021_V + theme(legend.position = "none"),
          P021_W + theme(legend.position = "none"),
          P022_A + theme(legend.position = "none"),
          P022_V + theme(legend.position = "none"),
          P022_W + theme(legend.position = "none"),
          P023_A + theme(legend.position = "none"),
          P023_V + theme(legend.position = "none"),
          P023_W + theme(legend.position = "none"),
          P024_A + theme(legend.position = "none"),
          P024_V + theme(legend.position = "none"),
          P024_W + theme(legend.position = "none"),
          P025_A + theme(legend.position = "none"),
          P025_V + theme(legend.position = "none"),
          P025_W + theme(legend.position = "none"),
          P026_A + theme(legend.position = "none"),
          P026_V + theme(legend.position = "none"),
          P026_W + theme(legend.position = "none"),
          P027_A + theme(legend.position = "none"),
          P027_V + theme(legend.position = "none"),
          P027_W + theme(legend.position = "none"),
          P028_A + theme(legend.position = "none"),
          P028_V + theme(legend.position = "none"),
          P028_W + theme(legend.position = "none"),
          P029_A + theme(legend.position = "none"),
          P029_V + theme(legend.position = "none"),
          P029_W + theme(legend.position = "none"),
          P030_A + theme(legend.position = "none"),
          P030_V + theme(legend.position = "none"),
          P030_W + theme(legend.position = "bottom"),
          
          nrow = 5, ncol = 6
          )
```


```{r message=FALSE, warning=FALSE, include=FALSE}
# Function to generate area plot for a given participant
generate_area_plot <- function(participant_id, all_data) {
  subset_data <- all_data %>%
    filter(ParticipantID == participant_id) 
  
  values <- c(subset_data$F_Angry, subset_data$F_Disgusted, subset_data$F_Afraid, 
              subset_data$F_Happy, subset_data$F_Sad, subset_data$F_Surprised, 
              subset_data$F_Neutral)
  
  emotions <- c(rep("F_Angry", length(subset_data$F_Angry)),
                rep("F_Disgusted", length(subset_data$F_Disgusted)),
                rep("F_Afraid", length(subset_data$F_Afraid)),
                rep("F_Happy", length(subset_data$F_Happy)),
                rep("F_Sad", length(subset_data$F_Sad)),
                rep("F_Surprised", length(subset_data$F_Surprised)),
                rep("F_Neutral", length(subset_data$F_Neutral)))
  
  subset_combined <- data.frame(Time2 = rep(subset_data$Time2, 7),
                                value = values,
                                emotion = emotions)
  
  plot <- ggplot(data = subset_combined, aes(x = Time2, y = value, fill = emotion)) +
    geom_area() +
    scale_fill_manual(name = 'emotions',
                      values = c("F_Angry" = "blue", "F_Disgusted" = "green", 
                                 "F_Afraid" = "brown", "F_Happy" = "orange", 
                                 "F_Sad" = "cyan", "F_Surprised" = "purple", 
                                 "F_Neutral" = "pink"),
                      drop = FALSE) +
    coord_cartesian(xlim = c(0, 10000), ylim = c(0, 1)) +
    labs(title = participant_id, x = "", y = "") +
    theme(plot.title = element_text(hjust = 0.5),
          panel.background = element_blank(),
          panel.grid.major = element_blank(), 
          panel.grid.minor = element_blank(),
          axis.line = element_line(colour = "black"),
          panel.border = element_rect(colour = "black", fill = NA, linewidth = 1))
  
  return(plot)
}

# List to store plots
plots <- list()

# Loop over participant IDs
participant_ids <- paste0("S", sprintf("%03d", 1:30))
P001 <- generate_area_plot("S001", all.df3)
P002 <- generate_area_plot("S002", all.df3)
P003 <- generate_area_plot("S003", all.df3)
P004 <- generate_area_plot("S004", all.df3)
P005 <- generate_area_plot("S005", all.df3)
P006 <- generate_area_plot("S006", all.df3)
P007 <- generate_area_plot("S007", all.df3)
P008 <- generate_area_plot("S008", all.df3)
P009 <- generate_area_plot("S009", all.df3)
P010 <- generate_area_plot("S010", all.df3)

P011 <- generate_area_plot("S011", all.df3)
P012 <- generate_area_plot("S012", all.df3)
P013 <- generate_area_plot("S013", all.df3)
P014 <- generate_area_plot("S014", all.df3)
P015 <- generate_area_plot("S015", all.df3)
P016 <- generate_area_plot("S016", all.df3)
P017 <- generate_area_plot("S017", all.df3)
P018 <- generate_area_plot("S018", all.df3)
P019 <- generate_area_plot("S019", all.df3)
P020 <- generate_area_plot("S020", all.df3)

P021 <- generate_area_plot("S021", all.df3)
P022 <- generate_area_plot("S022", all.df3)
P023 <- generate_area_plot("S023", all.df3)
P024 <- generate_area_plot("S024", all.df3)
P025 <- generate_area_plot("S025", all.df3)
P026 <- generate_area_plot("S026", all.df3)
P027 <- generate_area_plot("S027", all.df3)
P028 <- generate_area_plot("S028", all.df3)
P029 <- generate_area_plot("S029", all.df3)
P030 <- generate_area_plot("S030", all.df3)


```


\newpage

## Q1-Time series stacked plot for each participant

```{r echo=FALSE, fig.height=16, fig.width=15, message=FALSE, warning=FALSE}
ggarrange(P001 + theme(legend.position = "none"),
          P002 + theme(legend.position = "none"),
          P003 + theme(legend.position = "none"),
          P004 + theme(legend.position = "none"),
          P005 + theme(legend.position = "none"),
          P006 + theme(legend.position = "none"),
          P007 + theme(legend.position = "none"),
          P008 + theme(legend.position = "none"),
          P009 + theme(legend.position = "none"),
          P010 + theme(legend.position = "none"),
          P011 + theme(legend.position = "none"),
          P012 + theme(legend.position = "none"),
          P013 + theme(legend.position = "none"),
          P014 + theme(legend.position = "none"),
          P015 + theme(legend.position = "bottom"),
          nrow = 3, ncol = 5
          )
```

\newpage

```{r echo=FALSE, fig.height=16, fig.width=15, message=FALSE, warning=FALSE}
ggarrange(P016 + theme(legend.position = "none"),
          P017 + theme(legend.position = "none"),
          P018 + theme(legend.position = "none"),
          P019 + theme(legend.position = "none"),
          P020 + theme(legend.position = "none"),
          P021 + theme(legend.position = "none"),
          P022 + theme(legend.position = "none"),
          P023 + theme(legend.position = "none"),
          P024 + theme(legend.position = "none"),
          P025 + theme(legend.position = "none"),
          P026 + theme(legend.position = "none"),
          P027 + theme(legend.position = "none"),
          P028 + theme(legend.position = "none"),
          P029 + theme(legend.position = "none"),
          P030 + theme(legend.position = "bottom"),
          nrow = 3, ncol = 5
          )
```

\newpage

## Q2-Proportion stacked plot



```{r message=FALSE, warning=FALSE, include=FALSE}
generate_summary <- function(participant_id, exam_version) {
  subset <- all.df3 %>%
    filter(ParticipantID == participant_id & ExamVersion2 == exam_version)
  
  summary <- c(
    sum(!is.na(subset$max_emotions)),
    nrow(subset[subset$max_emotions == "F_Angry", ]),
    nrow(subset[subset$max_emotions == "F_Disgusted", ]),
    nrow(subset[subset$max_emotions == "F_Afraid", ]),
    nrow(subset[subset$max_emotions == "F_Happy", ]),
    nrow(subset[subset$max_emotions == "F_Sad", ]),
    nrow(subset[subset$max_emotions == "F_Surprised", ]),
    nrow(subset[subset$max_emotions == "F_Neutral", ])
  )
  
  return(summary)
}
S001_W <- generate_summary("S001", "W")
W_001 <- S001_W[1]
W_001_F_Angry <- S001_W[2]
W_001_F_Disgusted <- S001_W[3]
W_001_F_Afraid <- S001_W[4]
W_001_F_Happy <- S001_W[5]
W_001_F_Sad <- S001_W[6]
W_001_F_Surprised <- S001_W[7]
W_001_F_Neutral <- S001_W[8]

S001_V <- generate_summary("S001", "V")
V_001 <- S001_V[1]
V_001_F_Angry <- S001_V[2]
V_001_F_Disgusted <- S001_V[3]
V_001_F_Afraid <- S001_V[4]
V_001_F_Happy <- S001_V[5]
V_001_F_Sad <- S001_V[6]
V_001_F_Surprised <- S001_V[7]
V_001_F_Neutral <- S001_V[8]

S001_A <- generate_summary("S001", "A")
A_001 <- S001_A[1]
A_001_F_Angry <- S001_A[2]
A_001_F_Disgusted <- S001_A[3]
A_001_F_Afraid <- S001_A[4]
A_001_F_Happy <- S001_A[5]
A_001_F_Sad <- S001_A[6]
A_001_F_Surprised <- S001_A[7]
A_001_F_Neutral <- S001_A[8]

S002_W <- generate_summary("S002", "W")
S002_V <- generate_summary("S002", "V")
S002_A <- generate_summary("S002", "A")
W_002 <- S002_W[1]
W_002_F_Angry <- S002_W[2]
W_002_F_Disgusted <- S002_W[3]
W_002_F_Afraid <- S002_W[4]
W_002_F_Happy <- S002_W[5]
W_002_F_Sad <- S002_W[6]
W_002_F_Surprised <- S002_W[7]
W_002_F_Neutral <- S002_W[8]
V_002 <- S002_V[1]
V_002_F_Angry <- S002_V[2]
V_002_F_Disgusted <- S002_V[3]
V_002_F_Afraid <- S002_V[4]
V_002_F_Happy <- S002_V[5]
V_002_F_Sad <- S002_V[6]
V_002_F_Surprised <- S002_V[7]
V_002_F_Neutral <- S002_V[8]
A_002 <- S002_A[1]
A_002_F_Angry <- S002_A[2]
A_002_F_Disgusted <- S002_A[3]
A_002_F_Afraid <- S002_A[4]
A_002_F_Happy <- S002_A[5]
A_002_F_Sad <- S002_A[6]
A_002_F_Surprised <- S002_A[7]
A_002_F_Neutral <- S002_A[8]

S003_W <- generate_summary("S003", "W")
S003_V <- generate_summary("S003", "V")
S003_A <- generate_summary("S003", "A")
W_003 <- S003_W[1]
W_003_F_Angry <- S003_W[2]
W_003_F_Disgusted <- S003_W[3]
W_003_F_Afraid <- S003_W[4]
W_003_F_Happy <- S003_W[5]
W_003_F_Sad <- S003_W[6]
W_003_F_Surprised <- S003_W[7]
W_003_F_Neutral <- S003_W[8]
V_003 <- S003_V[1]
V_003_F_Angry <- S003_V[2]
V_003_F_Disgusted <- S003_V[3]
V_003_F_Afraid <- S003_V[4]
V_003_F_Happy <- S003_V[5]
V_003_F_Sad <- S003_V[6]
V_003_F_Surprised <- S003_V[7]
V_003_F_Neutral <- S003_V[8]
A_003 <- S003_A[1]
A_003_F_Angry <- S003_A[2]
A_003_F_Disgusted <- S003_A[3]
A_003_F_Afraid <- S003_A[4]
A_003_F_Happy <- S003_A[5]
A_003_F_Sad <- S003_A[6]
A_003_F_Surprised <- S003_A[7]
A_003_F_Neutral <- S003_A[8]

S004_W <- generate_summary("S004", "W")
S004_V <- generate_summary("S004", "V")
S004_A <- generate_summary("S004", "A")
W_004 <- S004_W[1]
W_004_F_Angry <- S004_W[2]
W_004_F_Disgusted <- S004_W[3]
W_004_F_Afraid <- S004_W[4]
W_004_F_Happy <- S004_W[5]
W_004_F_Sad <- S004_W[6]
W_004_F_Surprised <- S004_W[7]
W_004_F_Neutral <- S004_W[8]
V_004 <- S004_V[1]
V_004_F_Angry <- S004_V[2]
V_004_F_Disgusted <- S004_V[3]
V_004_F_Afraid <- S004_V[4]
V_004_F_Happy <- S004_V[5]
V_004_F_Sad <- S004_V[6]
V_004_F_Surprised <- S004_V[7]
V_004_F_Neutral <- S004_V[8]
A_004 <- S004_A[1]
A_004_F_Angry <- S004_A[2]
A_004_F_Disgusted <- S004_A[3]
A_004_F_Afraid <- S004_A[4]
A_004_F_Happy <- S004_A[5]
A_004_F_Sad <- S004_A[6]
A_004_F_Surprised <- S004_A[7]
A_004_F_Neutral <- S004_A[8]


S005_W <- generate_summary("S005", "W")
S005_V <- generate_summary("S005", "V")
S005_A <- generate_summary("S005", "A")
W_005 <- S005_W[1]
W_005_F_Angry <- S005_W[2]
W_005_F_Disgusted <- S005_W[3]
W_005_F_Afraid <- S005_W[4]
W_005_F_Happy <- S005_W[5]
W_005_F_Sad <- S005_W[6]
W_005_F_Surprised <- S005_W[7]
W_005_F_Neutral <- S005_W[8]
V_005 <- S005_V[1]
V_005_F_Angry <- S005_V[2]
V_005_F_Disgusted <- S005_V[3]
V_005_F_Afraid <- S005_V[4]
V_005_F_Happy <- S005_V[5]
V_005_F_Sad <- S005_V[6]
V_005_F_Surprised <- S005_V[7]
V_005_F_Neutral <- S005_V[8]
A_005 <- S005_A[1]
A_005_F_Angry <- S005_A[2]
A_005_F_Disgusted <- S005_A[3]
A_005_F_Afraid <- S005_A[4]
A_005_F_Happy <- S005_A[5]
A_005_F_Sad <- S005_A[6]
A_005_F_Surprised <- S005_A[7]
A_005_F_Neutral <- S005_A[8]

S006_W <- generate_summary("S006", "W")
S006_V <- generate_summary("S006", "V")
S006_A <- generate_summary("S006", "A")
W_006 <- S006_W[1]
W_006_F_Angry <- S006_W[2]
W_006_F_Disgusted <- S006_W[3]
W_006_F_Afraid <- S006_W[4]
W_006_F_Happy <- S006_W[5]
W_006_F_Sad <- S006_W[6]
W_006_F_Surprised <- S006_W[7]
W_006_F_Neutral <- S006_W[8]
V_006 <- S006_V[1]
V_006_F_Angry <- S006_V[2]
V_006_F_Disgusted <- S006_V[3]
V_006_F_Afraid <- S006_V[4]
V_006_F_Happy <- S006_V[5]
V_006_F_Sad <- S006_V[6]
V_006_F_Surprised <- S006_V[7]
V_006_F_Neutral <- S006_V[8]
A_006 <- S006_A[1]
A_006_F_Angry <- S006_A[2]
A_006_F_Disgusted <- S006_A[3]
A_006_F_Afraid <- S006_A[4]
A_006_F_Happy <- S006_A[5]
A_006_F_Sad <- S006_A[6]
A_006_F_Surprised <- S006_A[7]
A_006_F_Neutral <- S006_A[8]


S007_W <- generate_summary("S007", "W")
S007_V <- generate_summary("S007", "V")
S007_A <- generate_summary("S007", "A")
W_007 <- S007_W[1]
W_007_F_Angry <- S007_W[2]
W_007_F_Disgusted <- S007_W[3]
W_007_F_Afraid <- S007_W[4]
W_007_F_Happy <- S007_W[5]
W_007_F_Sad <- S007_W[6]
W_007_F_Surprised <- S007_W[7]
W_007_F_Neutral <- S007_W[8]
V_007 <- S007_V[1]
V_007_F_Angry <- S007_V[2]
V_007_F_Disgusted <- S007_V[3]
V_007_F_Afraid <- S007_V[4]
V_007_F_Happy <- S007_V[5]
V_007_F_Sad <- S007_V[6]
V_007_F_Surprised <- S007_V[7]
V_007_F_Neutral <- S007_V[8]
A_007 <- S007_A[1]
A_007_F_Angry <- S007_A[2]
A_007_F_Disgusted <- S007_A[3]
A_007_F_Afraid <- S007_A[4]
A_007_F_Happy <- S007_A[5]
A_007_F_Sad <- S007_A[6]
A_007_F_Surprised <- S007_A[7]
A_007_F_Neutral <- S007_A[8]

S008_W <- generate_summary("S008", "W")
S008_V <- generate_summary("S008", "V")
S008_A <- generate_summary("S008", "A")
W_008 <- S008_W[1]
W_008_F_Angry <- S008_W[2]
W_008_F_Disgusted <- S008_W[3]
W_008_F_Afraid <- S008_W[4]
W_008_F_Happy <- S008_W[5]
W_008_F_Sad <- S008_W[6]
W_008_F_Surprised <- S008_W[7]
W_008_F_Neutral <- S008_W[8]
V_008 <- S008_V[1]
V_008_F_Angry <- S008_V[2]
V_008_F_Disgusted <- S008_V[3]
V_008_F_Afraid <- S008_V[4]
V_008_F_Happy <- S008_V[5]
V_008_F_Sad <- S008_V[6]
V_008_F_Surprised <- S008_V[7]
V_008_F_Neutral <- S008_V[8]
A_008 <- S008_A[1]
A_008_F_Angry <- S008_A[2]
A_008_F_Disgusted <- S008_A[3]
A_008_F_Afraid <- S008_A[4]
A_008_F_Happy <- S008_A[5]
A_008_F_Sad <- S008_A[6]
A_008_F_Surprised <- S008_A[7]
A_008_F_Neutral <- S008_A[8]

S009_W <- generate_summary("S009", "W")
S009_V <- generate_summary("S009", "V")
S009_A <- generate_summary("S009", "A")
W_009 <- S009_W[1]
W_009_F_Angry <- S009_W[2]
W_009_F_Disgusted <- S009_W[3]
W_009_F_Afraid <- S009_W[4]
W_009_F_Happy <- S009_W[5]
W_009_F_Sad <- S009_W[6]
W_009_F_Surprised <- S009_W[7]
W_009_F_Neutral <- S009_W[8]
V_009 <- S009_V[1]
V_009_F_Angry <- S009_V[2]
V_009_F_Disgusted <- S009_V[3]
V_009_F_Afraid <- S009_V[4]
V_009_F_Happy <- S009_V[5]
V_009_F_Sad <- S009_V[6]
V_009_F_Surprised <- S009_V[7]
V_009_F_Neutral <- S009_V[8]
A_009 <- S009_A[1]
A_009_F_Angry <- S009_A[2]
A_009_F_Disgusted <- S009_A[3]
A_009_F_Afraid <- S009_A[4]
A_009_F_Happy <- S009_A[5]
A_009_F_Sad <- S009_A[6]
A_009_F_Surprised <- S009_A[7]
A_009_F_Neutral <- S009_A[8]

S010_W <- generate_summary("S010", "W")
S010_V <- generate_summary("S010", "V")
S010_A <- generate_summary("S010", "A")
W_010 <- S010_W[1]
W_010_F_Angry <- S010_W[2]
W_010_F_Disgusted <- S010_W[3]
W_010_F_Afraid <- S010_W[4]
W_010_F_Happy <- S010_W[5]
W_010_F_Sad <- S010_W[6]
W_010_F_Surprised <- S010_W[7]
W_010_F_Neutral <- S010_W[8]
V_010 <- S010_V[1]
V_010_F_Angry <- S010_V[2]
V_010_F_Disgusted <- S010_V[3]
V_010_F_Afraid <- S010_V[4]
V_010_F_Happy <- S010_V[5]
V_010_F_Sad <- S010_V[6]
V_010_F_Surprised <- S010_V[7]
V_010_F_Neutral <- S010_V[8]
A_010 <- S010_A[1]
A_010_F_Angry <- S010_A[2]
A_010_F_Disgusted <- S010_A[3]
A_010_F_Afraid <- S010_A[4]
A_010_F_Happy <- S010_A[5]
A_010_F_Sad <- S010_A[6]
A_010_F_Surprised <- S010_A[7]
A_010_F_Neutral <- S010_A[8]


```


```{r message=FALSE, warning=FALSE, include=FALSE}
S011_W <- generate_summary("S011", "W")
W_011 <- S011_W[1]
W_011_F_Angry <- S011_W[2]
W_011_F_Disgusted <- S011_W[3]
W_011_F_Afraid <- S011_W[4]
W_011_F_Happy <- S011_W[5]
W_011_F_Sad <- S011_W[6]
W_011_F_Surprised <- S011_W[7]
W_011_F_Neutral <- S011_W[8]

S011_V <- generate_summary("S011", "V")
V_011 <- S011_V[1]
V_011_F_Angry <- S011_V[2]
V_011_F_Disgusted <- S011_V[3]
V_011_F_Afraid <- S011_V[4]
V_011_F_Happy <- S011_V[5]
V_011_F_Sad <- S011_V[6]
V_011_F_Surprised <- S011_V[7]
V_011_F_Neutral <- S011_V[8]

S011_A <- generate_summary("S011", "A")
A_011 <- S011_A[1]
A_011_F_Angry <- S011_A[2]
A_011_F_Disgusted <- S011_A[3]
A_011_F_Afraid <- S011_A[4]
A_011_F_Happy <- S011_A[5]
A_011_F_Sad <- S011_A[6]
A_011_F_Surprised <- S011_A[7]
A_011_F_Neutral <- S011_A[8]

S012_W <- generate_summary("S012", "W")
S012_V <- generate_summary("S012", "V")
S012_A <- generate_summary("S012", "A")
W_012 <- S012_W[1]
W_012_F_Angry <- S012_W[2]
W_012_F_Disgusted <- S012_W[3]
W_012_F_Afraid <- S012_W[4]
W_012_F_Happy <- S012_W[5]
W_012_F_Sad <- S012_W[6]
W_012_F_Surprised <- S012_W[7]
W_012_F_Neutral <- S012_W[8]
V_012 <- S012_V[1]
V_012_F_Angry <- S012_V[2]
V_012_F_Disgusted <- S012_V[3]
V_012_F_Afraid <- S012_V[4]
V_012_F_Happy <- S012_V[5]
V_012_F_Sad <- S012_V[6]
V_012_F_Surprised <- S012_V[7]
V_012_F_Neutral <- S012_V[8]
A_012 <- S012_A[1]
A_012_F_Angry <- S012_A[2]
A_012_F_Disgusted <- S012_A[3]
A_012_F_Afraid <- S012_A[4]
A_012_F_Happy <- S012_A[5]
A_012_F_Sad <- S012_A[6]
A_012_F_Surprised <- S012_A[7]
A_012_F_Neutral <- S012_A[8]

S013_W <- generate_summary("S013", "W")
S013_V <- generate_summary("S013", "V")
S013_A <- generate_summary("S013", "A")
W_013 <- S013_W[1]
W_013_F_Angry <- S013_W[2]
W_013_F_Disgusted <- S013_W[3]
W_013_F_Afraid <- S013_W[4]
W_013_F_Happy <- S013_W[5]
W_013_F_Sad <- S013_W[6]
W_013_F_Surprised <- S013_W[7]
W_013_F_Neutral <- S013_W[8]
V_013 <- S013_V[1]
V_013_F_Angry <- S013_V[2]
V_013_F_Disgusted <- S013_V[3]
V_013_F_Afraid <- S013_V[4]
V_013_F_Happy <- S013_V[5]
V_013_F_Sad <- S013_V[6]
V_013_F_Surprised <- S013_V[7]
V_013_F_Neutral <- S013_V[8]
A_013 <- S013_A[1]
A_013_F_Angry <- S013_A[2]
A_013_F_Disgusted <- S013_A[3]
A_013_F_Afraid <- S013_A[4]
A_013_F_Happy <- S013_A[5]
A_013_F_Sad <- S013_A[6]
A_013_F_Surprised <- S013_A[7]
A_013_F_Neutral <- S013_A[8]

S014_W <- generate_summary("S014", "W")
S014_V <- generate_summary("S014", "V")
S014_A <- generate_summary("S014", "A")
W_014 <- S014_W[1]
W_014_F_Angry <- S014_W[2]
W_014_F_Disgusted <- S014_W[3]
W_014_F_Afraid <- S014_W[4]
W_014_F_Happy <- S014_W[5]
W_014_F_Sad <- S014_W[6]
W_014_F_Surprised <- S014_W[7]
W_014_F_Neutral <- S014_W[8]
V_014 <- S014_V[1]
V_014_F_Angry <- S014_V[2]
V_014_F_Disgusted <- S014_V[3]
V_014_F_Afraid <- S014_V[4]
V_014_F_Happy <- S014_V[5]
V_014_F_Sad <- S014_V[6]
V_014_F_Surprised <- S014_V[7]
V_014_F_Neutral <- S014_V[8]
A_014 <- S014_A[1]
A_014_F_Angry <- S014_A[2]
A_014_F_Disgusted <- S014_A[3]
A_014_F_Afraid <- S014_A[4]
A_014_F_Happy <- S014_A[5]
A_014_F_Sad <- S014_A[6]
A_014_F_Surprised <- S014_A[7]
A_014_F_Neutral <- S014_A[8]

S015_W <- generate_summary("S015", "W")
S015_V <- generate_summary("S015", "V")
S015_A <- generate_summary("S015", "A")
W_015 <- S015_W[1]
W_015_F_Angry <- S015_W[2]
W_015_F_Disgusted <- S015_W[3]
W_015_F_Afraid <- S015_W[4]
W_015_F_Happy <- S015_W[5]
W_015_F_Sad <- S015_W[6]
W_015_F_Surprised <- S015_W[7]
W_015_F_Neutral <- S015_W[8]
V_015 <- S015_V[1]
V_015_F_Angry <- S015_V[2]
V_015_F_Disgusted <- S015_V[3]
V_015_F_Afraid <- S015_V[4]
V_015_F_Happy <- S015_V[5]
V_015_F_Sad <- S015_V[6]
V_015_F_Surprised <- S015_V[7]
V_015_F_Neutral <- S015_V[8]
A_015 <- S015_A[1]
A_015_F_Angry <- S015_A[2]
A_015_F_Disgusted <- S015_A[3]
A_015_F_Afraid <- S015_A[4]
A_015_F_Happy <- S015_A[5]
A_015_F_Sad <- S015_A[6]
A_015_F_Surprised <- S015_A[7]
A_015_F_Neutral <- S015_A[8]

S016_W <- generate_summary("S016", "W")
S016_V <- generate_summary("S016", "V")
S016_A <- generate_summary("S016", "A")
W_016 <- S016_W[1]
W_016_F_Angry <- S016_W[2]
W_016_F_Disgusted <- S016_W[3]
W_016_F_Afraid <- S016_W[4]
W_016_F_Happy <- S016_W[5]
W_016_F_Sad <- S016_W[6]
W_016_F_Surprised <- S016_W[7]
W_016_F_Neutral <- S016_W[8]
V_016 <- S016_V[1]
V_016_F_Angry <- S016_V[2]
V_016_F_Disgusted <- S016_V[3]
V_016_F_Afraid <- S016_V[4]
V_016_F_Happy <- S016_V[5]
V_016_F_Sad <- S016_V[6]
V_016_F_Surprised <- S016_V[7]
V_016_F_Neutral <- S016_V[8]
A_016 <- S016_A[1]
A_016_F_Angry <- S016_A[2]
A_016_F_Disgusted <- S016_A[3]
A_016_F_Afraid <- S016_A[4]
A_016_F_Happy <- S016_A[5]
A_016_F_Sad <- S016_A[6]
A_016_F_Surprised <- S016_A[7]
A_016_F_Neutral <- S016_A[8]

S017_W <- generate_summary("S017", "W")
S017_V <- generate_summary("S017", "V")
S017_A <- generate_summary("S017", "A")
W_017 <- S017_W[1]
W_017_F_Angry <- S017_W[2]
W_017_F_Disgusted <- S017_W[3]
W_017_F_Afraid <- S017_W[4]
W_017_F_Happy <- S017_W[5]
W_017_F_Sad <- S017_W[6]
W_017_F_Surprised <- S017_W[7]
W_017_F_Neutral <- S017_W[8]
V_017 <- S017_V[1]
V_017_F_Angry <- S017_V[2]
V_017_F_Disgusted <- S017_V[3]
V_017_F_Afraid <- S017_V[4]
V_017_F_Happy <- S017_V[5]
V_017_F_Sad <- S017_V[6]
V_017_F_Surprised <- S017_V[7]
V_017_F_Neutral <- S017_V[8]
A_017 <- S017_A[1]
A_017_F_Angry <- S017_A[2]
A_017_F_Disgusted <- S017_A[3]
A_017_F_Afraid <- S017_A[4]
A_017_F_Happy <- S017_A[5]
A_017_F_Sad <- S017_A[6]
A_017_F_Surprised <- S017_A[7]
A_017_F_Neutral <- S017_A[8]

S018_W <- generate_summary("S018", "W")
S018_V <- generate_summary("S018", "V")
S018_A <- generate_summary("S018", "A")
W_018 <- S018_W[1]
W_018_F_Angry <- S018_W[2]
W_018_F_Disgusted <- S018_W[3]
W_018_F_Afraid <- S018_W[4]
W_018_F_Happy <- S018_W[5]
W_018_F_Sad <- S018_W[6]
W_018_F_Surprised <- S018_W[7]
W_018_F_Neutral <- S018_W[8]
V_018 <- S018_V[1]
V_018_F_Angry <- S018_V[2]
V_018_F_Disgusted <- S018_V[3]
V_018_F_Afraid <- S018_V[4]
V_018_F_Happy <- S018_V[5]
V_018_F_Sad <- S018_V[6]
V_018_F_Surprised <- S018_V[7]
V_018_F_Neutral <- S018_V[8]
A_018 <- S018_A[1]
A_018_F_Angry <- S018_A[2]
A_018_F_Disgusted <- S018_A[3]
A_018_F_Afraid <- S018_A[4]
A_018_F_Happy <- S018_A[5]
A_018_F_Sad <- S018_A[6]
A_018_F_Surprised <- S018_A[7]
A_018_F_Neutral <- S018_A[8]

S019_W <- generate_summary("S019", "W")
S019_V <- generate_summary("S019", "V")
S019_A <- generate_summary("S019", "A")
W_019 <- S019_W[1]
W_019_F_Angry <- S019_W[2]
W_019_F_Disgusted <- S019_W[3]
W_019_F_Afraid <- S019_W[4]
W_019_F_Happy <- S019_W[5]
W_019_F_Sad <- S019_W[6]
W_019_F_Surprised <- S019_W[7]
W_019_F_Neutral <- S019_W[8]
V_019 <- S019_V[1]
V_019_F_Angry <- S019_V[2]
V_019_F_Disgusted <- S019_V[3]
V_019_F_Afraid <- S019_V[4]
V_019_F_Happy <- S019_V[5]
V_019_F_Sad <- S019_V[6]
V_019_F_Surprised <- S019_V[7]
V_019_F_Neutral <- S019_V[8]
A_019 <- S019_A[1]
A_019_F_Angry <- S019_A[2]
A_019_F_Disgusted <- S019_A[3]
A_019_F_Afraid <- S019_A[4]
A_019_F_Happy <- S019_A[5]
A_019_F_Sad <- S019_A[6]
A_019_F_Surprised <- S019_A[7]
A_019_F_Neutral <- S019_A[8]

S020_W <- generate_summary("S020", "W")
S020_V <- generate_summary("S020", "V")
S020_A <- generate_summary("S020", "A")
W_020 <- S020_W[1]
W_020_F_Angry <- S020_W[2]
W_020_F_Disgusted <- S020_W[3]
W_020_F_Afraid <- S020_W[4]
W_020_F_Happy <- S020_W[5]
W_020_F_Sad <- S020_W[6]
W_020_F_Surprised <- S020_W[7]
W_020_F_Neutral <- S020_W[8]
V_020 <- S020_V[1]
V_020_F_Angry <- S020_V[2]
V_020_F_Disgusted <- S020_V[3]
V_020_F_Afraid <- S020_V[4]
V_020_F_Happy <- S020_V[5]
V_020_F_Sad <- S020_V[6]
V_020_F_Surprised <- S020_V[7]
V_020_F_Neutral <- S020_V[8]
A_020 <- S020_A[1]
A_020_F_Angry <- S020_A[2]
A_020_F_Disgusted <- S020_A[3]
A_020_F_Afraid <- S020_A[4]
A_020_F_Happy <- S020_A[5]
A_020_F_Sad <- S020_A[6]
A_020_F_Surprised <- S020_A[7]
A_020_F_Neutral <- S020_A[8]

```


```{r message=FALSE, warning=FALSE, include=FALSE}
S021_W <- generate_summary("S021", "W")
W_021 <- S021_W[1]
W_021_F_Angry <- S021_W[2]
W_021_F_Disgusted <- S021_W[3]
W_021_F_Afraid <- S021_W[4]
W_021_F_Happy <- S021_W[5]
W_021_F_Sad <- S021_W[6]
W_021_F_Surprised <- S021_W[7]
W_021_F_Neutral <- S021_W[8]

S021_V <- generate_summary("S021", "V")
V_021 <- S021_V[1]
V_021_F_Angry <- S021_V[2]
V_021_F_Disgusted <- S021_V[3]
V_021_F_Afraid <- S021_V[4]
V_021_F_Happy <- S021_V[5]
V_021_F_Sad <- S021_V[6]
V_021_F_Surprised <- S021_V[7]
V_021_F_Neutral <- S021_V[8]

S021_A <- generate_summary("S021", "A")
A_021 <- S021_A[1]
A_021_F_Angry <- S021_A[2]
A_021_F_Disgusted <- S021_A[3]
A_021_F_Afraid <- S021_A[4]
A_021_F_Happy <- S021_A[5]
A_021_F_Sad <- S021_A[6]
A_021_F_Surprised <- S021_A[7]
A_021_F_Neutral <- S021_A[8]

S022_W <- generate_summary("S022", "W")
S022_V <- generate_summary("S022", "V")
S022_A <- generate_summary("S022", "A")
W_022 <- S022_W[1]
W_022_F_Angry <- S022_W[2]
W_022_F_Disgusted <- S022_W[3]
W_022_F_Afraid <- S022_W[4]
W_022_F_Happy <- S022_W[5]
W_022_F_Sad <- S022_W[6]
W_022_F_Surprised <- S022_W[7]
W_022_F_Neutral <- S022_W[8]
V_022 <- S022_V[1]
V_022_F_Angry <- S022_V[2]
V_022_F_Disgusted <- S022_V[3]
V_022_F_Afraid <- S022_V[4]
V_022_F_Happy <- S022_V[5]
V_022_F_Sad <- S022_V[6]
V_022_F_Surprised <- S022_V[7]
V_022_F_Neutral <- S022_V[8]
A_022 <- S022_A[1]
A_022_F_Angry <- S022_A[2]
A_022_F_Disgusted <- S022_A[3]
A_022_F_Afraid <- S022_A[4]
A_022_F_Happy <- S022_A[5]
A_022_F_Sad <- S022_A[6]
A_022_F_Surprised <- S022_A[7]
A_022_F_Neutral <- S022_A[8]

S023_W <- generate_summary("S023", "W")
S023_V <- generate_summary("S023", "V")
S023_A <- generate_summary("S023", "A")
W_023 <- S023_W[1]
W_023_F_Angry <- S023_W[2]
W_023_F_Disgusted <- S023_W[3]
W_023_F_Afraid <- S023_W[4]
W_023_F_Happy <- S023_W[5]
W_023_F_Sad <- S023_W[6]
W_023_F_Surprised <- S023_W[7]
W_023_F_Neutral <- S023_W[8]
V_023 <- S023_V[1]
V_023_F_Angry <- S023_V[2]
V_023_F_Disgusted <- S023_V[3]
V_023_F_Afraid <- S023_V[4]
V_023_F_Happy <- S023_V[5]
V_023_F_Sad <- S023_V[6]
V_023_F_Surprised <- S023_V[7]
V_023_F_Neutral <- S023_V[8]
A_023 <- S023_A[1]
A_023_F_Angry <- S023_A[2]
A_023_F_Disgusted <- S023_A[3]
A_023_F_Afraid <- S023_A[4]
A_023_F_Happy <- S023_A[5]
A_023_F_Sad <- S023_A[6]
A_023_F_Surprised <- S023_A[7]
A_023_F_Neutral <- S023_A[8]

S024_W <- generate_summary("S024", "W")
S024_V <- generate_summary("S024", "V")
S024_A <- generate_summary("S024", "A")
W_024 <- S024_W[1]
W_024_F_Angry <- S024_W[2]
W_024_F_Disgusted <- S024_W[3]
W_024_F_Afraid <- S024_W[4]
W_024_F_Happy <- S024_W[5]
W_024_F_Sad <- S024_W[6]
W_024_F_Surprised <- S024_W[7]
W_024_F_Neutral <- S024_W[8]
V_024 <- S024_V[1]
V_024_F_Angry <- S024_V[2]
V_024_F_Disgusted <- S024_V[3]
V_024_F_Afraid <- S024_V[4]
V_024_F_Happy <- S024_V[5]
V_024_F_Sad <- S024_V[6]
V_024_F_Surprised <- S024_V[7]
V_024_F_Neutral <- S024_V[8]
A_024 <- S024_A[1]
A_024_F_Angry <- S024_A[2]
A_024_F_Disgusted <- S024_A[3]
A_024_F_Afraid <- S024_A[4]
A_024_F_Happy <- S024_A[5]
A_024_F_Sad <- S024_A[6]
A_024_F_Surprised <- S024_A[7]
A_024_F_Neutral <- S024_A[8]

S025_W <- generate_summary("S025", "W")
S025_V <- generate_summary("S025", "V")
S025_A <- generate_summary("S025", "A")
W_025 <- S025_W[1]
W_025_F_Angry <- S025_W[2]
W_025_F_Disgusted <- S025_W[3]
W_025_F_Afraid <- S025_W[4]
W_025_F_Happy <- S025_W[5]
W_025_F_Sad <- S025_W[6]
W_025_F_Surprised <- S025_W[7]
W_025_F_Neutral <- S025_W[8]
V_025 <- S025_V[1]
V_025_F_Angry <- S025_V[2]
V_025_F_Disgusted <- S025_V[3]
V_025_F_Afraid <- S025_V[4]
V_025_F_Happy <- S025_V[5]
V_025_F_Sad <- S025_V[6]
V_025_F_Surprised <- S025_V[7]
V_025_F_Neutral <- S025_V[8]
A_025 <- S025_A[1]
A_025_F_Angry <- S025_A[2]
A_025_F_Disgusted <- S025_A[3]
A_025_F_Afraid <- S025_A[4]
A_025_F_Happy <- S025_A[5]
A_025_F_Sad <- S025_A[6]
A_025_F_Surprised <- S025_A[7]
A_025_F_Neutral <- S025_A[8]

S026_W <- generate_summary("S026", "W")
S026_V <- generate_summary("S026", "V")
S026_A <- generate_summary("S026", "A")
W_026 <- S026_W[1]
W_026_F_Angry <- S026_W[2]
W_026_F_Disgusted <- S026_W[3]
W_026_F_Afraid <- S026_W[4]
W_026_F_Happy <- S026_W[5]
W_026_F_Sad <- S026_W[6]
W_026_F_Surprised <- S026_W[7]
W_026_F_Neutral <- S026_W[8]
V_026 <- S026_V[1]
V_026_F_Angry <- S026_V[2]
V_026_F_Disgusted <- S026_V[3]
V_026_F_Afraid <- S026_V[4]
V_026_F_Happy <- S026_V[5]
V_026_F_Sad <- S026_V[6]
V_026_F_Surprised <- S026_V[7]
V_026_F_Neutral <- S026_V[8]
A_026 <- S026_A[1]
A_026_F_Angry <- S026_A[2]
A_026_F_Disgusted <- S026_A[3]
A_026_F_Afraid <- S026_A[4]
A_026_F_Happy <- S026_A[5]
A_026_F_Sad <- S026_A[6]
A_026_F_Surprised <- S026_A[7]
A_026_F_Neutral <- S026_A[8]

S027_W <- generate_summary("S027", "W")
S027_V <- generate_summary("S027", "V")
S027_A <- generate_summary("S027", "A")
W_027 <- S027_W[1]
W_027_F_Angry <- S027_W[2]
W_027_F_Disgusted <- S027_W[3]
W_027_F_Afraid <- S027_W[4]
W_027_F_Happy <- S027_W[5]
W_027_F_Sad <- S027_W[6]
W_027_F_Surprised <- S027_W[7]
W_027_F_Neutral <- S027_W[8]
V_027 <- S027_V[1]
V_027_F_Angry <- S027_V[2]
V_027_F_Disgusted <- S027_V[3]
V_027_F_Afraid <- S027_V[4]
V_027_F_Happy <- S027_V[5]
V_027_F_Sad <- S027_V[6]
V_027_F_Surprised <- S027_V[7]
V_027_F_Neutral <- S027_V[8]
A_027 <- S027_A[1]
A_027_F_Angry <- S027_A[2]
A_027_F_Disgusted <- S027_A[3]
A_027_F_Afraid <- S027_A[4]
A_027_F_Happy <- S027_A[5]
A_027_F_Sad <- S027_A[6]
A_027_F_Surprised <- S027_A[7]
A_027_F_Neutral <- S027_A[8]

S028_W <- generate_summary("S028", "W")
S028_V <- generate_summary("S028", "V")
S028_A <- generate_summary("S028", "A")
W_028 <- S028_W[1]
W_028_F_Angry <- S028_W[2]
W_028_F_Disgusted <- S028_W[3]
W_028_F_Afraid <- S028_W[4]
W_028_F_Happy <- S028_W[5]
W_028_F_Sad <- S028_W[6]
W_028_F_Surprised <- S028_W[7]
W_028_F_Neutral <- S028_W[8]
V_028 <- S028_V[1]
V_028_F_Angry <- S028_V[2]
V_028_F_Disgusted <- S028_V[3]
V_028_F_Afraid <- S028_V[4]
V_028_F_Happy <- S028_V[5]
V_028_F_Sad <- S028_V[6]
V_028_F_Surprised <- S028_V[7]
V_028_F_Neutral <- S028_V[8]
A_028 <- S028_A[1]
A_028_F_Angry <- S028_A[2]
A_028_F_Disgusted <- S028_A[3]
A_028_F_Afraid <- S028_A[4]
A_028_F_Happy <- S028_A[5]
A_028_F_Sad <- S028_A[6]
A_028_F_Surprised <- S028_A[7]
A_028_F_Neutral <- S028_A[8]

S029_W <- generate_summary("S029", "W")
S029_V <- generate_summary("S029", "V")
S029_A <- generate_summary("S029", "A")
W_029 <- S029_W[1]
W_029_F_Angry <- S029_W[2]
W_029_F_Disgusted <- S029_W[3]
W_029_F_Afraid <- S029_W[4]
W_029_F_Happy <- S029_W[5]
W_029_F_Sad <- S029_W[6]
W_029_F_Surprised <- S029_W[7]
W_029_F_Neutral <- S029_W[8]
V_029 <- S029_V[1]
V_029_F_Angry <- S029_V[2]
V_029_F_Disgusted <- S029_V[3]
V_029_F_Afraid <- S029_V[4]
V_029_F_Happy <- S029_V[5]
V_029_F_Sad <- S029_V[6]
V_029_F_Surprised <- S029_V[7]
V_029_F_Neutral <- S029_V[8]
A_029 <- S029_A[1]
A_029_F_Angry <- S029_A[2]
A_029_F_Disgusted <- S029_A[3]
A_029_F_Afraid <- S029_A[4]
A_029_F_Happy <- S029_A[5]
A_029_F_Sad <- S029_A[6]
A_029_F_Surprised <- S029_A[7]
A_029_F_Neutral <- S029_A[8]

S030_W <- generate_summary("S030", "W")
S030_V <- generate_summary("S030", "V")
S030_A <- generate_summary("S030", "A")
W_030 <- S030_W[1]
W_030_F_Angry <- S030_W[2]
W_030_F_Disgusted <- S030_W[3]
W_030_F_Afraid <- S030_W[4]
W_030_F_Happy <- S030_W[5]
W_030_F_Sad <- S030_W[6]
W_030_F_Surprised <- S030_W[7]
W_030_F_Neutral <- S030_W[8]
V_030 <- S030_V[1]
V_030_F_Angry <- S030_V[2]
V_030_F_Disgusted <- S030_V[3]
V_030_F_Afraid <- S030_V[4]
V_030_F_Happy <- S030_V[5]
V_030_F_Sad <- S030_V[6]
V_030_F_Surprised <- S030_V[7]
V_030_F_Neutral <- S030_V[8]
A_030 <- S030_A[1]
A_030_F_Angry <- S030_A[2]
A_030_F_Disgusted <- S030_A[3]
A_030_F_Afraid <- S030_A[4]
A_030_F_Happy <- S030_A[5]
A_030_F_Sad <- S030_A[6]
A_030_F_Surprised <- S030_A[7]
A_030_F_Neutral <- S030_A[8]

```



```{r fig.height=5, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
specie <- c(rep("S001" , 7) , rep("S002" , 7) , rep("S003" , 7) , rep("S004" , 7) , rep("S005" , 7), 
            rep("S006" , 7) , rep("S007" , 7) , rep("S008" , 7) , rep("S009" , 7) , rep("S010" , 7),
            rep("S011" , 7) , rep("S012" , 7) , rep("S013" , 7) , rep("S014" , 7) , rep("S015" , 7),
            rep("S016" , 7) , rep("S017" , 7) , rep("S018" , 7) , rep("S019" , 7) , rep("S020" , 7),
            rep("S021" , 7) , rep("S022" , 7) , rep("S023" , 7) , rep("S024" , 7) , rep("S025" , 7),
            rep("S026" , 7) , rep("S027" , 7) , rep("S028" , 7) , rep("S029" , 7) , rep("S030" , 7)
            )
Emotions <- rep(c('F_Angry', 'F_Disgusted', 'F_Afraid', 'F_Happy','F_Sad', 'F_Surprised', 'F_Neutral') , 30)
value <- c(
  A_001_F_Angry/A_001,A_001_F_Disgusted/A_001,A_001_F_Afraid/A_001,A_001_F_Happy/A_001,A_001_F_Sad/A_001,A_001_F_Surprised/A_001,A_001_F_Neutral/A_001,
  A_002_F_Angry/A_002,A_002_F_Disgusted/A_002,A_002_F_Afraid/A_002,A_002_F_Happy/A_002,A_002_F_Sad/A_002,A_002_F_Surprised/A_002,A_002_F_Neutral/A_002,
  A_003_F_Angry/A_003,A_003_F_Disgusted/A_003,A_003_F_Afraid/A_003,A_003_F_Happy/A_003,A_003_F_Sad/A_003,A_003_F_Surprised/A_003,A_003_F_Neutral/A_003,
  A_004_F_Angry/A_004,A_004_F_Disgusted/A_004,A_004_F_Afraid/A_004,A_004_F_Happy/A_004,A_004_F_Sad/A_004,A_004_F_Surprised/A_004,A_004_F_Neutral/A_004,
  A_005_F_Angry/A_005,A_005_F_Disgusted/A_005,A_005_F_Afraid/A_005,A_005_F_Happy/A_005,A_005_F_Sad/A_005,A_005_F_Surprised/A_005,A_005_F_Neutral/A_005,
  A_006_F_Angry/A_006,A_006_F_Disgusted/A_006,A_006_F_Afraid/A_006,A_006_F_Happy/A_006,A_006_F_Sad/A_006,A_006_F_Surprised/A_006,A_006_F_Neutral/A_006,
 A_007_F_Angry/A_007,A_007_F_Disgusted/A_007,A_007_F_Afraid/A_007,A_007_F_Happy/A_007,A_007_F_Sad/A_007,A_007_F_Surprised/A_007,A_007_F_Neutral/A_007,
 A_008_F_Angry/A_008,A_008_F_Disgusted/A_008,A_008_F_Afraid/A_008,A_008_F_Happy/A_008,A_008_F_Sad/A_008,A_008_F_Surprised/A_008,A_008_F_Neutral/A_008,
 A_009_F_Angry/A_009,A_009_F_Disgusted/A_009,A_009_F_Afraid/A_009,A_009_F_Happy/A_009,A_009_F_Sad/A_009,A_009_F_Surprised/A_009,A_009_F_Neutral/A_009,
 A_010_F_Angry/A_010,A_010_F_Disgusted/A_010,A_010_F_Afraid/A_010,A_010_F_Happy/A_010,A_010_F_Sad/A_010,A_010_F_Surprised/A_010,A_010_F_Neutral/A_010,
 A_011_F_Angry/A_011,A_011_F_Disgusted/A_011,A_011_F_Afraid/A_011,A_011_F_Happy/A_011,A_011_F_Sad/A_011,A_011_F_Surprised/A_011,A_011_F_Neutral/A_011,
 A_012_F_Angry/A_012,A_012_F_Disgusted/A_012,A_012_F_Afraid/A_012,A_012_F_Happy/A_012,A_012_F_Sad/A_012,A_012_F_Surprised/A_012,A_012_F_Neutral/A_012,
 A_013_F_Angry/A_013,A_013_F_Disgusted/A_013,A_013_F_Afraid/A_013,A_013_F_Happy/A_013,A_013_F_Sad/A_013,A_013_F_Surprised/A_013,A_013_F_Neutral/A_013,
 A_014_F_Angry/A_014,A_014_F_Disgusted/A_014,A_014_F_Afraid/A_014,A_014_F_Happy/A_014,A_014_F_Sad/A_014,A_014_F_Surprised/A_014,A_014_F_Neutral/A_014,
 A_015_F_Angry/A_015,A_015_F_Disgusted/A_015,A_015_F_Afraid/A_015,A_015_F_Happy/A_015,A_015_F_Sad/A_015,A_015_F_Surprised/A_015,A_015_F_Neutral/A_015,
 A_016_F_Angry/A_016,A_016_F_Disgusted/A_016,A_016_F_Afraid/A_016,A_016_F_Happy/A_016,A_016_F_Sad/A_016,A_016_F_Surprised/A_016,A_016_F_Neutral/A_016,
 A_017_F_Angry/A_017,A_017_F_Disgusted/A_017,A_017_F_Afraid/A_017,A_017_F_Happy/A_017,A_017_F_Sad/A_017,A_017_F_Surprised/A_017,A_017_F_Neutral/A_017,
 A_018_F_Angry/A_018,A_018_F_Disgusted/A_018,A_018_F_Afraid/A_018,A_018_F_Happy/A_018,A_018_F_Sad/A_018,A_018_F_Surprised/A_018,A_018_F_Neutral/A_018,
 A_019_F_Angry/A_019,A_019_F_Disgusted/A_019,A_019_F_Afraid/A_019,A_019_F_Happy/A_019,A_019_F_Sad/A_019,A_019_F_Surprised/A_019,A_019_F_Neutral/A_019,
 A_020_F_Angry/A_020,A_020_F_Disgusted/A_020,A_020_F_Afraid/A_020,A_020_F_Happy/A_020,A_020_F_Sad/A_020,A_020_F_Surprised/A_020,A_020_F_Neutral/A_020,
 A_021_F_Angry/A_021,A_021_F_Disgusted/A_021,A_021_F_Afraid/A_021,A_021_F_Happy/A_021,A_021_F_Sad/A_021,A_021_F_Surprised/A_021,A_021_F_Neutral/A_021,
 A_022_F_Angry/A_022,A_022_F_Disgusted/A_022,A_022_F_Afraid/A_022,A_022_F_Happy/A_022,A_022_F_Sad/A_022,A_022_F_Surprised/A_022,A_022_F_Neutral/A_022,
 A_023_F_Angry/A_023,A_023_F_Disgusted/A_023,A_023_F_Afraid/A_023,A_023_F_Happy/A_023,A_023_F_Sad/A_023,A_023_F_Surprised/A_023,A_023_F_Neutral/A_023,
 A_024_F_Angry/A_024,A_024_F_Disgusted/A_024,A_024_F_Afraid/A_024,A_024_F_Happy/A_024,A_024_F_Sad/A_024,A_024_F_Surprised/A_024,A_024_F_Neutral/A_024,
 A_025_F_Angry/A_025,A_025_F_Disgusted/A_025,A_025_F_Afraid/A_025,A_025_F_Happy/A_025,A_025_F_Sad/A_025,A_025_F_Surprised/A_025,A_025_F_Neutral/A_025,
 A_026_F_Angry/A_026,A_026_F_Disgusted/A_026,A_026_F_Afraid/A_026,A_026_F_Happy/A_026,A_026_F_Sad/A_026,A_026_F_Surprised/A_026,A_026_F_Neutral/A_026,
 A_027_F_Angry/A_027,A_027_F_Disgusted/A_027,A_027_F_Afraid/A_027,A_027_F_Happy/A_027,A_027_F_Sad/A_027,A_027_F_Surprised/A_027,A_027_F_Neutral/A_027,
 A_028_F_Angry/A_028,A_028_F_Disgusted/A_028,A_028_F_Afraid/A_028,A_028_F_Happy/A_028,A_028_F_Sad/A_028,A_028_F_Surprised/A_028,A_028_F_Neutral/A_028,
 A_029_F_Angry/A_029,A_029_F_Disgusted/A_029,A_029_F_Afraid/A_029,A_029_F_Happy/A_029,A_029_F_Sad/A_029,A_029_F_Surprised/A_029,A_029_F_Neutral/A_029,
 A_030_F_Angry/A_030,A_030_F_Disgusted/A_030,A_030_F_Afraid/A_030,A_030_F_Happy/A_030,A_030_F_Sad/A_030,A_030_F_Surprised/A_030,A_030_F_Neutral/A_030


  )

data <- data.frame(specie,Emotions,value)

# Stacked + percent
PA <- ggplot(data, aes(fill=Emotions, y=value, x=specie)) + 
    geom_bar(position="fill", stat="identity") +
   labs(y = "A",x="")
PA

```


```{r fig.height=5, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
specie <- c(rep("S001" , 7) , rep("S002" , 7) , rep("S003" , 7) , rep("S004" , 7) , rep("S005" , 7), 
            rep("S006" , 7) , rep("S007" , 7) , rep("S008" , 7) , rep("S009" , 7) , rep("S010" , 7),
            rep("S011" , 7) , rep("S012" , 7) , rep("S013" , 7) , rep("S014" , 7) , rep("S015" , 7),
            rep("S016" , 7) , rep("S017" , 7) , rep("S018" , 7) , rep("S019" , 7) , rep("S020" , 7),
            rep("S021" , 7) , rep("S022" , 7) , rep("S023" , 7) , rep("S024" , 7) , rep("S025" , 7),
            rep("S026" , 7) , rep("S027" , 7) , rep("S028" , 7) , rep("S029" , 7) , rep("S030" , 7)
            )
Emotions <- rep(c('F_Angry', 'F_Disgusted', 'F_Afraid', 'F_Happy','F_Sad', 'F_Surprised', 'F_Neutral') , 30)
value <- c(
  V_001_F_Angry/V_001,V_001_F_Disgusted/V_001,V_001_F_Afraid/V_001,V_001_F_Happy/V_001,V_001_F_Sad/V_001,V_001_F_Surprised/V_001,V_001_F_Neutral/V_001,
  V_002_F_Angry/V_002,V_002_F_Disgusted/V_002,V_002_F_Afraid/V_002,V_002_F_Happy/V_002,V_002_F_Sad/V_002,V_002_F_Surprised/V_002,V_002_F_Neutral/V_002,
  V_003_F_Angry/V_003,V_003_F_Disgusted/V_003,V_003_F_Afraid/V_003,V_003_F_Happy/V_003,V_003_F_Sad/V_003,V_003_F_Surprised/V_003,V_003_F_Neutral/V_003,
  V_004_F_Angry/V_004,V_004_F_Disgusted/V_004,V_004_F_Afraid/V_004,V_004_F_Happy/V_004,V_004_F_Sad/V_004,V_004_F_Surprised/V_004,V_004_F_Neutral/V_004,
  V_005_F_Angry/V_005,V_005_F_Disgusted/V_005,V_005_F_Afraid/V_005,V_005_F_Happy/V_005,V_005_F_Sad/V_005,V_005_F_Surprised/V_005,V_005_F_Neutral/V_005,
  V_006_F_Angry/V_006,V_006_F_Disgusted/V_006,V_006_F_Afraid/V_006,V_006_F_Happy/V_006,V_006_F_Sad/V_006,V_006_F_Surprised/V_006,V_006_F_Neutral/V_006,
 V_007_F_Angry/V_007,V_007_F_Disgusted/V_007,V_007_F_Afraid/V_007,V_007_F_Happy/V_007,V_007_F_Sad/V_007,V_007_F_Surprised/V_007,V_007_F_Neutral/V_007,
 V_008_F_Angry/V_008,V_008_F_Disgusted/V_008,V_008_F_Afraid/V_008,V_008_F_Happy/V_008,V_008_F_Sad/V_008,V_008_F_Surprised/V_008,V_008_F_Neutral/V_008,
 V_009_F_Angry/V_009,V_009_F_Disgusted/V_009,V_009_F_Afraid/V_009,V_009_F_Happy/V_009,V_009_F_Sad/V_009,V_009_F_Surprised/V_009,V_009_F_Neutral/V_009,
 V_010_F_Angry/V_010,V_010_F_Disgusted/V_010,V_010_F_Afraid/V_010,V_010_F_Happy/V_010,V_010_F_Sad/V_010,V_010_F_Surprised/V_010,V_010_F_Neutral/V_010,
 V_011_F_Angry/V_011,V_011_F_Disgusted/V_011,V_011_F_Afraid/V_011,V_011_F_Happy/V_011,V_011_F_Sad/V_011,V_011_F_Surprised/V_011,V_011_F_Neutral/V_011,
 V_012_F_Angry/V_012,V_012_F_Disgusted/V_012,V_012_F_Afraid/V_012,V_012_F_Happy/V_012,V_012_F_Sad/V_012,V_012_F_Surprised/V_012,V_012_F_Neutral/V_012,
 V_013_F_Angry/V_013,V_013_F_Disgusted/V_013,V_013_F_Afraid/V_013,V_013_F_Happy/V_013,V_013_F_Sad/V_013,V_013_F_Surprised/V_013,V_013_F_Neutral/V_013,
 V_014_F_Angry/V_014,V_014_F_Disgusted/V_014,V_014_F_Afraid/V_014,V_014_F_Happy/V_014,V_014_F_Sad/V_014,V_014_F_Surprised/V_014,V_014_F_Neutral/V_014,
 V_015_F_Angry/V_015,V_015_F_Disgusted/V_015,V_015_F_Afraid/V_015,V_015_F_Happy/V_015,V_015_F_Sad/V_015,V_015_F_Surprised/V_015,V_015_F_Neutral/V_015,
 V_016_F_Angry/V_016,V_016_F_Disgusted/V_016,V_016_F_Afraid/V_016,V_016_F_Happy/V_016,V_016_F_Sad/V_016,V_016_F_Surprised/V_016,V_016_F_Neutral/V_016,
 V_017_F_Angry/V_017,V_017_F_Disgusted/V_017,V_017_F_Afraid/V_017,V_017_F_Happy/V_017,V_017_F_Sad/V_017,V_017_F_Surprised/V_017,V_017_F_Neutral/V_017,
 V_018_F_Angry/V_018,V_018_F_Disgusted/V_018,V_018_F_Afraid/V_018,V_018_F_Happy/V_018,V_018_F_Sad/V_018,V_018_F_Surprised/V_018,V_018_F_Neutral/V_018,
 V_019_F_Angry/V_019,V_019_F_Disgusted/V_019,V_019_F_Afraid/V_019,V_019_F_Happy/V_019,V_019_F_Sad/V_019,V_019_F_Surprised/V_019,V_019_F_Neutral/V_019,
 V_020_F_Angry/V_020,V_020_F_Disgusted/V_020,V_020_F_Afraid/V_020,V_020_F_Happy/V_020,V_020_F_Sad/V_020,V_020_F_Surprised/V_020,V_020_F_Neutral/V_020,
 V_021_F_Angry/V_021,V_021_F_Disgusted/V_021,V_021_F_Afraid/V_021,V_021_F_Happy/V_021,V_021_F_Sad/V_021,V_021_F_Surprised/V_021,V_021_F_Neutral/V_021,
 V_022_F_Angry/V_022,V_022_F_Disgusted/V_022,V_022_F_Afraid/V_022,V_022_F_Happy/V_022,V_022_F_Sad/V_022,V_022_F_Surprised/V_022,V_022_F_Neutral/V_022,
 V_023_F_Angry/V_023,V_023_F_Disgusted/V_023,V_023_F_Afraid/V_023,V_023_F_Happy/V_023,V_023_F_Sad/V_023,V_023_F_Surprised/V_023,V_023_F_Neutral/V_023,
 V_024_F_Angry/V_024,V_024_F_Disgusted/V_024,V_024_F_Afraid/V_024,V_024_F_Happy/V_024,V_024_F_Sad/V_024,V_024_F_Surprised/V_024,V_024_F_Neutral/V_024,
 V_025_F_Angry/V_025,V_025_F_Disgusted/V_025,V_025_F_Afraid/V_025,V_025_F_Happy/V_025,V_025_F_Sad/V_025,V_025_F_Surprised/V_025,V_025_F_Neutral/V_025,
 V_026_F_Angry/V_026,V_026_F_Disgusted/V_026,V_026_F_Afraid/V_026,V_026_F_Happy/V_026,V_026_F_Sad/V_026,V_026_F_Surprised/V_026,V_026_F_Neutral/V_026,
 V_027_F_Angry/V_027,V_027_F_Disgusted/V_027,V_027_F_Afraid/V_027,V_027_F_Happy/V_027,V_027_F_Sad/V_027,V_027_F_Surprised/V_027,V_027_F_Neutral/V_027,
 V_028_F_Angry/V_028,V_028_F_Disgusted/V_028,V_028_F_Afraid/V_028,V_028_F_Happy/V_028,V_028_F_Sad/V_028,V_028_F_Surprised/V_028,V_028_F_Neutral/V_028,
 V_029_F_Angry/V_029,V_029_F_Disgusted/V_029,V_029_F_Afraid/V_029,V_029_F_Happy/V_029,V_029_F_Sad/V_029,V_029_F_Surprised/V_029,V_029_F_Neutral/V_029,
 V_030_F_Angry/V_030,V_030_F_Disgusted/V_030,V_030_F_Afraid/V_030,V_030_F_Happy/V_030,V_030_F_Sad/V_030,V_030_F_Surprised/V_030,V_030_F_Neutral/V_030

  )

data <- data.frame(specie,Emotions,value)

# Stacked + percent
PV <- ggplot(data, aes(fill=Emotions, y=value, x=specie)) + 
    geom_bar(position="fill", stat="identity") +
   labs(y = "V",x="")
PV

```



```{r fig.height=5, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
specie <- c(rep("S001" , 7) , rep("S002" , 7) , rep("S003" , 7) , rep("S004" , 7) , rep("S005" , 7), 
            rep("S006" , 7) , rep("S007" , 7) , rep("S008" , 7) , rep("S009" , 7) , rep("S010" , 7),
            rep("S011" , 7) , rep("S012" , 7) , rep("S013" , 7) , rep("S014" , 7) , rep("S015" , 7),
            rep("S016" , 7) , rep("S017" , 7) , rep("S018" , 7) , rep("S019" , 7) , rep("S020" , 7),
            rep("S021" , 7) , rep("S022" , 7) , rep("S023" , 7) , rep("S024" , 7) , rep("S025" , 7),
            rep("S026" , 7) , rep("S027" , 7) , rep("S028" , 7) , rep("S029" , 7) , rep("S030" , 7)
            )
Emotions <- rep(c('F_Angry', 'F_Disgusted', 'F_Afraid', 'F_Happy','F_Sad', 'F_Surprised', 'F_Neutral') , 30)
value <- c(
  W_001_F_Angry/W_001,W_001_F_Disgusted/W_001,W_001_F_Afraid/W_001,W_001_F_Happy/W_001,W_001_F_Sad/W_001,W_001_F_Surprised/W_001,W_001_F_Neutral/W_001,
  W_002_F_Angry/W_002,W_002_F_Disgusted/W_002,W_002_F_Afraid/W_002,W_002_F_Happy/W_002,W_002_F_Sad/W_002,W_002_F_Surprised/W_002,W_002_F_Neutral/W_002,
  W_003_F_Angry/W_003,W_003_F_Disgusted/W_003,W_003_F_Afraid/W_003,W_003_F_Happy/W_003,W_003_F_Sad/W_003,W_003_F_Surprised/W_003,W_003_F_Neutral/W_003,
  W_004_F_Angry/W_004,W_004_F_Disgusted/W_004,W_004_F_Afraid/W_004,W_004_F_Happy/W_004,W_004_F_Sad/W_004,W_004_F_Surprised/W_004,W_004_F_Neutral/W_004,
  W_005_F_Angry/W_005,W_005_F_Disgusted/W_005,W_005_F_Afraid/W_005,W_005_F_Happy/W_005,W_005_F_Sad/W_005,W_005_F_Surprised/W_005,W_005_F_Neutral/W_005,
  W_006_F_Angry/W_006,W_006_F_Disgusted/W_006,W_006_F_Afraid/W_006,W_006_F_Happy/W_006,W_006_F_Sad/W_006,W_006_F_Surprised/W_006,W_006_F_Neutral/W_006,
 W_007_F_Angry/W_007,W_007_F_Disgusted/W_007,W_007_F_Afraid/W_007,W_007_F_Happy/W_007,W_007_F_Sad/W_007,W_007_F_Surprised/W_007,W_007_F_Neutral/W_007,
 W_008_F_Angry/W_008,W_008_F_Disgusted/W_008,W_008_F_Afraid/W_008,W_008_F_Happy/W_008,W_008_F_Sad/W_008,W_008_F_Surprised/W_008,W_008_F_Neutral/W_008,
 W_009_F_Angry/W_009,W_009_F_Disgusted/W_009,W_009_F_Afraid/W_009,W_009_F_Happy/W_009,W_009_F_Sad/W_009,W_009_F_Surprised/W_009,W_009_F_Neutral/W_009,
 W_010_F_Angry/W_010,W_010_F_Disgusted/W_010,W_010_F_Afraid/W_010,W_010_F_Happy/W_010,W_010_F_Sad/W_010,W_010_F_Surprised/W_010,W_010_F_Neutral/W_010,
 W_011_F_Angry/W_011,W_011_F_Disgusted/W_011,W_011_F_Afraid/W_011,W_011_F_Happy/W_011,W_011_F_Sad/W_011,W_011_F_Surprised/W_011,W_011_F_Neutral/W_011,
 W_012_F_Angry/W_012,W_012_F_Disgusted/W_012,W_012_F_Afraid/W_012,W_012_F_Happy/W_012,W_012_F_Sad/W_012,W_012_F_Surprised/W_012,W_012_F_Neutral/W_012,
 W_013_F_Angry/W_013,W_013_F_Disgusted/W_013,W_013_F_Afraid/W_013,W_013_F_Happy/W_013,W_013_F_Sad/W_013,W_013_F_Surprised/W_013,W_013_F_Neutral/W_013,
 W_014_F_Angry/W_014,W_014_F_Disgusted/W_014,W_014_F_Afraid/W_014,W_014_F_Happy/W_014,W_014_F_Sad/W_014,W_014_F_Surprised/W_014,W_014_F_Neutral/W_014,
 W_015_F_Angry/W_015,W_015_F_Disgusted/W_015,W_015_F_Afraid/W_015,W_015_F_Happy/W_015,W_015_F_Sad/W_015,W_015_F_Surprised/W_015,W_015_F_Neutral/W_015,
 W_016_F_Angry/W_016,W_016_F_Disgusted/W_016,W_016_F_Afraid/W_016,W_016_F_Happy/W_016,W_016_F_Sad/W_016,W_016_F_Surprised/W_016,W_016_F_Neutral/W_016,
 W_017_F_Angry/W_017,W_017_F_Disgusted/W_017,W_017_F_Afraid/W_017,W_017_F_Happy/W_017,W_017_F_Sad/W_017,W_017_F_Surprised/W_017,W_017_F_Neutral/W_017,
 W_018_F_Angry/W_018,W_018_F_Disgusted/W_018,W_018_F_Afraid/W_018,W_018_F_Happy/W_018,W_018_F_Sad/W_018,W_018_F_Surprised/W_018,W_018_F_Neutral/W_018,
 W_019_F_Angry/W_019,W_019_F_Disgusted/W_019,W_019_F_Afraid/W_019,W_019_F_Happy/W_019,W_019_F_Sad/W_019,W_019_F_Surprised/W_019,W_019_F_Neutral/W_019,
 W_020_F_Angry/W_020,W_020_F_Disgusted/W_020,W_020_F_Afraid/W_020,W_020_F_Happy/W_020,W_020_F_Sad/W_020,W_020_F_Surprised/W_020,W_020_F_Neutral/W_020,
 W_021_F_Angry/W_021,W_021_F_Disgusted/W_021,W_021_F_Afraid/W_021,W_021_F_Happy/W_021,W_021_F_Sad/W_021,W_021_F_Surprised/W_021,W_021_F_Neutral/W_021,
 W_022_F_Angry/W_022,W_022_F_Disgusted/W_022,W_022_F_Afraid/W_022,W_022_F_Happy/W_022,W_022_F_Sad/W_022,W_022_F_Surprised/W_022,W_022_F_Neutral/W_022,
 W_023_F_Angry/W_023,W_023_F_Disgusted/W_023,W_023_F_Afraid/W_023,W_023_F_Happy/W_023,W_023_F_Sad/W_023,W_023_F_Surprised/W_023,W_023_F_Neutral/W_023,
 W_024_F_Angry/W_024,W_024_F_Disgusted/W_024,W_024_F_Afraid/W_024,W_024_F_Happy/W_024,W_024_F_Sad/W_024,W_024_F_Surprised/W_024,W_024_F_Neutral/W_024,
 W_025_F_Angry/W_025,W_025_F_Disgusted/W_025,W_025_F_Afraid/W_025,W_025_F_Happy/W_025,W_025_F_Sad/W_025,W_025_F_Surprised/W_025,W_025_F_Neutral/W_025,
 W_026_F_Angry/W_026,W_026_F_Disgusted/W_026,W_026_F_Afraid/W_026,W_026_F_Happy/W_026,W_026_F_Sad/W_026,W_026_F_Surprised/W_026,W_026_F_Neutral/W_026,
 W_027_F_Angry/W_027,W_027_F_Disgusted/W_027,W_027_F_Afraid/W_027,W_027_F_Happy/W_027,W_027_F_Sad/W_027,W_027_F_Surprised/W_027,W_027_F_Neutral/W_027,
 W_028_F_Angry/W_028,W_028_F_Disgusted/W_028,W_028_F_Afraid/W_028,W_028_F_Happy/W_028,W_028_F_Sad/W_028,W_028_F_Surprised/W_028,W_028_F_Neutral/W_028,
 W_029_F_Angry/W_029,W_029_F_Disgusted/W_029,W_029_F_Afraid/W_029,W_029_F_Happy/W_029,W_029_F_Sad/W_029,W_029_F_Surprised/W_029,W_029_F_Neutral/W_029,
 W_030_F_Angry/W_030,W_030_F_Disgusted/W_030,W_030_F_Afraid/W_030,W_030_F_Happy/W_030,W_030_F_Sad/W_030,W_030_F_Surprised/W_030,W_030_F_Neutral/W_030)

data <- data.frame(specie,Emotions,value)

# Stacked + percent
PW <- ggplot(data, aes(fill=Emotions, y=value, x=specie)) + 
    geom_bar(position="fill", stat="identity") +
   labs(y = "W",x="")
PW

```

```{r echo=FALSE, fig.height=8, fig.width=15, message=FALSE, warning=FALSE}
ggarrange(PA+theme(legend.position = "top"),
          PV+theme(legend.position = "none"),
          PW+theme(legend.position = "none"), 
          nrow = 3, ncol = 1)
```

## Q2-Summary Statistics

```{r echo=FALSE, fig.height=5, fig.width=15, message=FALSE, warning=FALSE}

subset_all_A <- all.df3 %>%
    filter(ExamVersion2 == "A")

all_A <- sum(!is.na(subset_all_A$max_emotions))
all_A_F_Angry <- nrow(subset_all_A[subset_all_A$max_emotions == "F_Angry", ])
all_A_F_Disgusted <- nrow(subset_all_A[subset_all_A$max_emotions == "F_Disgusted", ])
all_A_F_Afraid <- nrow(subset_all_A[subset_all_A$max_emotions == "F_Afraid", ])
all_A_F_Happy <- nrow(subset_all_A[subset_all_A$max_emotions == "F_Happy", ])
all_A_F_Sad <- nrow(subset_all_A[subset_all_A$max_emotions == "F_Sad", ])
all_A_F_Surprised <- nrow(subset_all_A[subset_all_A$max_emotions == "F_Surprised", ])
all_A_F_Neutral <- nrow(subset_all_A[subset_all_A$max_emotions == "F_Neutral", ])

subset_all_V <- all.df3 %>%
    filter(ExamVersion2 == "V")

all_V <- sum(!is.na(subset_all_V$max_emotions))
all_V_F_Angry <- nrow(subset_all_V[subset_all_V$max_emotions == "F_Angry", ])
all_V_F_Disgusted <- nrow(subset_all_V[subset_all_V$max_emotions == "F_Disgusted", ])
all_V_F_Afraid <- nrow(subset_all_V[subset_all_V$max_emotions == "F_Afraid", ])
all_V_F_Happy <- nrow(subset_all_V[subset_all_V$max_emotions == "F_Happy", ])
all_V_F_Sad <- nrow(subset_all_V[subset_all_V$max_emotions == "F_Sad", ])
all_V_F_Surprised <- nrow(subset_all_V[subset_all_V$max_emotions == "F_Surprised", ])
all_V_F_Neutral <- nrow(subset_all_V[subset_all_V$max_emotions == "F_Neutral", ])


subset_all_W <- all.df3 %>%
    filter(ExamVersion2 == "W")

all_W <- sum(!is.na(subset_all_W$max_emotions))
all_W_F_Angry <- nrow(subset_all_W[subset_all_W$max_emotions == "F_Angry", ])
all_W_F_Disgusted <- nrow(subset_all_W[subset_all_W$max_emotions == "F_Disgusted", ])
all_W_F_Afraid <- nrow(subset_all_W[subset_all_W$max_emotions == "F_Afraid", ])
all_W_F_Happy <- nrow(subset_all_W[subset_all_W$max_emotions == "F_Happy", ])
all_W_F_Sad <- nrow(subset_all_W[subset_all_W$max_emotions == "F_Sad", ])
all_W_F_Surprised <- nrow(subset_all_W[subset_all_W$max_emotions == "F_Surprised", ])
all_W_F_Neutral <- nrow(subset_all_W[subset_all_W$max_emotions == "F_Neutral", ])

# create a dataset
specie <- c(rep("A" , 1) , rep("V" , 1) , rep("W" , 1)  )
Emotions <- rep(c('F_Angry', 'F_Disgusted', 'F_Afraid', 'F_Happy','F_Sad', 'F_Surprised', 'F_Neutral') , 3)
value <- c(
  all_A_F_Angry/all_A*100,all_A_F_Disgusted/all_A*100,all_A_F_Afraid/all_A*100,all_A_F_Happy/all_A*100,all_A_F_Sad/all_A*100,all_A_F_Surprised/all_A*100,all_A_F_Neutral/all_A*100,
  all_V_F_Angry/all_V*100,all_V_F_Disgusted/all_V*100,all_V_F_Afraid/all_V*100,all_V_F_Happy/all_V*100,all_V_F_Sad/all_V*100,all_V_F_Surprised/all_V*100,all_V_F_Neutral/all_V*100,
  all_W_F_Angry/all_W*100,all_W_F_Disgusted/all_W*100,all_W_F_Afraid/all_W*100,all_W_F_Happy/all_W*100,all_W_F_Sad/all_W*100,all_W_F_Surprised/all_W*100,all_W_F_Neutral/all_W*100)
data <- data.frame(specie,Emotions,value)

my_colors <- c("F_Angry" = "blue", "F_Disgusted" = "green", 
               "F_Afraid" = "brown", "F_Happy" = "orange", 
               "F_Sad" = "cyan", "F_Surprised" = "purple", 
               "F_Neutral" = "pink")

# Graph
ggplot(data, aes(fill = Emotions, y = value, x = Emotions)) + 
  geom_bar(position = "dodge", stat = "identity") +
  scale_fill_manual(name = 'emotions', values = my_colors, drop = FALSE) +
  ggtitle("") +
  facet_wrap(~specie) +
  #theme_ipsum() +
  theme(legend.position = "top", axis.text.x = element_blank()) +
  xlab("")+ylab("Proportion (%)")
```

## Q2-Percentage of each emotion on Question Type

```{r}
table_df =data.frame(Question_Type  = c("A", "V", "W"),
           n  = c(all_A,all_V,all_W),
           F_Angry_ratio = c(all_A_F_Angry/all_A*100, all_V_F_Angry/all_V*100, all_W_F_Angry/all_W*100),
           F_Disgusted_ratio = c(all_A_F_Disgusted/all_A*100, all_V_F_Disgusted/all_V*100, all_W_F_Disgusted/all_W*100),
           F_Afraid_ratio = c(all_A_F_Afraid/all_A*100, all_V_F_Afraid/all_V*100, all_W_F_Afraid/all_W*100),
           F_Happy_ratio = c(all_A_F_Happy/all_A*100, all_V_F_Happy/all_V*100, all_W_F_Happy/all_W*100),
           F_Sad_ratio = c(all_A_F_Sad/all_A*100, all_V_F_Sad/all_V*100, all_W_F_Sad/all_W*100),
           F_Surprised_ratio = c(all_A_F_Surprised/all_A*100, all_V_F_Surprised/all_V*100, all_W_F_Surprised/all_W*100),
           F_Neutral_ratio = c(all_A_F_Neutral/all_A*100, all_V_F_Neutral/all_V*100, all_W_F_Neutral/all_W*100)
           )

colnames(table_df) <- c("Question_Type", "n", "F_Angry_ratio","F_Disgusted_ratio","F_Afraid_ratio",
                        "F_Happy_ratio","F_Sad_ratio","F_Surprised_ratio","F_Neutral_ratio")
table_df %>%
  kable("latex", booktabs = T, caption = "Percentage of each emotion on Question Type") %>%
  #kable("markdown", booktabs = T, caption = "Percentage of each emotion on Question Type ") %>%
  kable_styling(latex_options = c("scale_down","hold_position"), font_size = 10)
```

\newpage

## Q3-Gained Insights 

Stack plots provide a visual way to show the relationships and effects between multiple variables. By looking carefully at the layout, order, and data points of the plot, we can gain an initial sense of the importance, influence, and trends of the different variables in the data set.

In the time series stacked plot for each participant with WORD, ABSTRACT and VIDEO, there are 6 emotions. Most of plots are made of pink(Neutral) and cyan(sad). The color of plots of S003-A, S003-V, S003-W, S009-W, S013-A, S013-V, S013-W, S014-A, S014-V, S014-W, S015-A, S015-V, S015-W, S017-A, S017-V, S017-W, S021-A, S021-V, S021-V, S022-A, S022-V, S022-W, S023-A, S023-V, S023-W, S024-A, S025-A, S025-V, S025-W, S029-A, S029-V and S029-W are almost pink, indicating the F_Neutral is the dominant emotions. S010-A, S010-V, S010-W, S012-A, S012-V, S012-W are almost cyan, suggesting the F_sad is the dominant emotion. It is difficult to determine which one is dominant emotion for other data. Some plots show clear changes in emotional intensity at specific times, like S008-V, and S015-V. This could correlate with specific tasks within the exam that trigger these emotional responses. Different participants react differently to the same exam conditions. For instance, the most color of S019-A is cyan, S021-A is pink and S027-A is orange. Such differences show individual differences in emotional reactivity.

According to the time series stacked plot for each participant, we observe S003, S014, S015, S017, S021, S022, S023, S025, S029 are almost pink, so their dominant emotions all are F_Neutral.The emotion of F_Neutral last for the longest time, almost 7500s, followed bu S017. S025 S010 and S012 are almost cyan and the dominant emotions are F_Sad. The result agrees with the the time series stacked plot for each participant with WORD, ABSTRACT and VIDEO. 

In the proportion stacked plot, we can observe much more cyan, which means the F_neutral is the dominant emotion of most participants. Orange and purple are also high in proportion, and what they represent F_Afraid and F_sad. 

Based on the result of the summary statistics and percentage of each emotion, we can clearly get the relative frequency of that emotion category among the participants. A higher percentage indicates that the emotion is more prevalent among participants, while a lower percentage indicates that the emotion is relatively rare. There are the same proportions in all three tasks. Pink has the highest proportion, representing F_neutral and purple has lowest proportion, representing F_Surprised. Obviously, the F_neutral is the dominant emotion and the F_surprised has little effect on people.


\newpage

# Step3

1. Construct a participant level matrix of gaze signals, treating the gaze signal as a four-state variable (CLOSED, LEFT, CENTER, RIGHT).

2. Compute the percentages of the four gaze states and display the results in a summary plot. Construct also a table with the relevant descriptive statistics.

3. Express the insights you have gained.

\newpage

## Q1-Proprotion stack - Gaze

```{r message=FALSE, warning=FALSE, include=FALSE}

all.df4 <- all.df2 %>% drop_na(G_Direction)

all.df4

generate_summary <- function(participant, exam_version) {
  subset_df <- all.df4 %>%
    filter(ParticipantID == participant & ExamVersion2 == exam_version)
  
  center <- sum(subset_df$G_Direction == "CENTER")
  closed <- sum(subset_df$G_Direction == "CLOSED")
  left <- sum(subset_df$G_Direction == "LEFT")
  right <- sum(subset_df$G_Direction == "RIGHT")
  
  return(c(center, closed, left, right))
}

summary <- generate_summary("S001", "W") 

W_center_001 <- summary[1]
W_closed_001 <- summary[2]
W_left_001 <- summary[3]
W_right_001 <- summary[4]
W_001 <- W_center_001+W_closed_001+W_left_001+W_right_001

summary <- generate_summary("S001", "V")
V_center_001 <- summary[1]
V_closed_001 <- summary[2]
V_left_001 <- summary[3]
V_right_001 <- summary[4]
V_001 <- V_center_001+V_closed_001+V_left_001+V_right_001

summary <- generate_summary("S001", "A")
A_center_001 <- summary[1]
A_closed_001 <- summary[2]
A_left_001 <- summary[3]
A_right_001 <- summary[4]
A_001 <- A_center_001+A_closed_001+A_left_001+A_right_001


summary <- generate_summary("S002", "W")
W_center_002 <- summary[1]
W_closed_002 <- summary[2]
W_left_002 <- summary[3]
W_right_002 <- summary[4]
W_002 <- W_center_002+W_closed_002+W_left_002+W_right_002

summary <- generate_summary("S002", "V")
V_center_002 <- summary[1]
V_closed_002 <- summary[2]
V_left_002 <- summary[3]
V_right_002 <- summary[4]
V_002 <- V_center_002+V_closed_002+V_left_002+V_right_002

summary <- generate_summary("S002", "A")
A_center_002 <- summary[1]
A_closed_002 <- summary[2]
A_left_002 <- summary[3]
A_right_002 <- summary[4]
A_002 <- A_center_002+A_closed_002+A_left_002+A_right_002


summary <- generate_summary("S003", "W")
W_center_003 <- summary[1]
W_closed_003 <- summary[2]
W_left_003 <- summary[3]
W_right_003 <- summary[4]
W_003 <- W_center_003+W_closed_003+W_left_003+W_right_003

summary <- generate_summary("S003", "V")
V_center_003 <- summary[1]
V_closed_003 <- summary[2]
V_left_003 <- summary[3]
V_right_003 <- summary[4]
V_003 <- V_center_003+V_closed_003+V_left_003+V_right_003

summary <- generate_summary("S003", "A")
A_center_003 <- summary[1]
A_closed_003 <- summary[2]
A_left_003 <- summary[3]
A_right_003 <- summary[4]
A_003 <- A_center_003+A_closed_003+A_left_003+A_right_003


summary <- generate_summary("S004", "W")
W_center_004 <- summary[1]
W_closed_004 <- summary[2]
W_left_004 <- summary[3]
W_right_004 <- summary[4]
W_004 <- W_center_004+W_closed_004+W_left_004+W_right_004

summary <- generate_summary("S004", "V")
V_center_004 <- summary[1]
V_closed_004 <- summary[2]
V_left_004 <- summary[3]
V_right_004 <- summary[4]
V_004 <- V_center_004+V_closed_004+V_left_004+V_right_004

summary <- generate_summary("S004", "A")
A_center_004 <- summary[1]
A_closed_004 <- summary[2]
A_left_004 <- summary[3]
A_right_004 <- summary[4]
A_004 <- A_center_004+A_closed_004+A_left_004+A_right_004


summary <- generate_summary("S005", "W")
W_center_005 <- summary[1]
W_closed_005 <- summary[2]
W_left_005 <- summary[3]
W_right_005 <- summary[4]
W_005 <- W_center_005+W_closed_005+W_left_005+W_right_005

summary <- generate_summary("S005", "V")
V_center_005 <- summary[1]
V_closed_005 <- summary[2]
V_left_005 <- summary[3]
V_right_005 <- summary[4]
V_005 <- V_center_005+V_closed_005+V_left_005+V_right_005

summary <- generate_summary("S005", "A")
A_center_005 <- summary[1]
A_closed_005 <- summary[2]
A_left_005 <- summary[3]
A_right_005 <- summary[4]
A_005 <- A_center_005+A_closed_005+A_left_005+A_right_005


summary <- generate_summary("S006", "W")
W_center_006 <- summary[1]
W_closed_006 <- summary[2]
W_left_006 <- summary[3]
W_right_006 <- summary[4]
W_006 <- W_center_006+W_closed_006+W_left_006+W_right_006

summary <- generate_summary("S006", "V")
V_center_006 <- summary[1]
V_closed_006 <- summary[2]
V_left_006 <- summary[3]
V_right_006 <- summary[4]
V_006 <- V_center_006+V_closed_006+V_left_006+V_right_006

summary <- generate_summary("S006", "A")
A_center_006 <- summary[1]
A_closed_006 <- summary[2]
A_left_006 <- summary[3]
A_right_006 <- summary[4]
A_006 <- A_center_006+A_closed_006+A_left_006+A_right_006


summary <- generate_summary("S007", "W")
W_center_007 <- summary[1]
W_closed_007 <- summary[2]
W_left_007 <- summary[3]
W_right_007 <- summary[4]
W_007 <- W_center_007+W_closed_007+W_left_007+W_right_007

summary <- generate_summary("S007", "V")
V_center_007 <- summary[1]
V_closed_007 <- summary[2]
V_left_007 <- summary[3]
V_right_007 <- summary[4]
V_007 <- V_center_007+V_closed_007+V_left_007+V_right_007

summary <- generate_summary("S007", "A")
A_center_007 <- summary[1]
A_closed_007 <- summary[2]
A_left_007 <- summary[3]
A_right_007 <- summary[4]
A_007 <- A_center_007+A_closed_007+A_left_007+A_right_007

summary <- generate_summary("S008", "W")
W_center_008 <- summary[1]
W_closed_008 <- summary[2]
W_left_008 <- summary[3]
W_right_008 <- summary[4]
W_008 <- W_center_008+W_closed_008+W_left_008+W_right_008

summary <- generate_summary("S008", "V")
V_center_008 <- summary[1]
V_closed_008 <- summary[2]
V_left_008 <- summary[3]
V_right_008 <- summary[4]
V_008 <- V_center_008+V_closed_008+V_left_008+V_right_008

summary <- generate_summary("S008", "A")
A_center_008 <- summary[1]
A_closed_008 <- summary[2]
A_left_008 <- summary[3]
A_right_008 <- summary[4]
A_008 <- A_center_008+A_closed_008+A_left_008+A_right_008

summary <- generate_summary("S009", "W")
W_center_009 <- summary[1]
W_closed_009 <- summary[2]
W_left_009 <- summary[3]
W_right_009 <- summary[4]
W_009 <- W_center_009+W_closed_009+W_left_009+W_right_009

summary <- generate_summary("S009", "V")
V_center_009 <- summary[1]
V_closed_009 <- summary[2]
V_left_009 <- summary[3]
V_right_009 <- summary[4]
V_009 <- V_center_009+V_closed_009+V_left_009+V_right_009

summary <- generate_summary("S009", "A")
A_center_009 <- summary[1]
A_closed_009 <- summary[2]
A_left_009 <- summary[3]
A_right_009 <- summary[4]
A_009 <- A_center_009+A_closed_009+A_left_009+A_right_009

summary <- generate_summary("S010", "W")
W_center_010 <- summary[1]
W_closed_010 <- summary[2]
W_left_010 <- summary[3]
W_right_010 <- summary[4]
W_010 <- W_center_010+W_closed_010+W_left_010+W_right_010

summary <- generate_summary("S010", "V")
V_center_010 <- summary[1]
V_closed_010 <- summary[2]
V_left_010 <- summary[3]
V_right_010 <- summary[4]
V_010 <- V_center_010+V_closed_010+V_left_010+V_right_010

summary <- generate_summary("S010", "A")
A_center_010 <- summary[1]
A_closed_010 <- summary[2]
A_left_010 <- summary[3]
A_right_010 <- summary[4]
A_010 <- A_center_010+A_closed_010+A_left_010+A_right_010


```
```{r}
summary <- generate_summary("S011", "W")
W_center_011 <- summary[1]
W_closed_011 <- summary[2]
W_left_011 <- summary[3]
W_right_011 <- summary[4]
W_011 <- W_center_011+W_closed_011+W_left_011+W_right_011

summary <- generate_summary("S011", "V")
V_center_011 <- summary[1]
V_closed_011 <- summary[2]
V_left_011 <- summary[3]
V_right_011 <- summary[4]
V_011 <- V_center_011+V_closed_011+V_left_011+V_right_011

summary <- generate_summary("S011", "A")
A_center_011 <- summary[1]
A_closed_011 <- summary[2]
A_left_011 <- summary[3]
A_right_011 <- summary[4]
A_011 <- A_center_011+A_closed_011+A_left_011+A_right_011


summary <- generate_summary("S012", "W")
W_center_012 <- summary[1]
W_closed_012 <- summary[2]
W_left_012 <- summary[3]
W_right_012 <- summary[4]
W_012 <- W_center_012+W_closed_012+W_left_012+W_right_012

summary <- generate_summary("S012", "V")
V_center_012 <- summary[1]
V_closed_012 <- summary[2]
V_left_012 <- summary[3]
V_right_012 <- summary[4]
V_012 <- V_center_012+V_closed_012+V_left_012+V_right_012

summary <- generate_summary("S012", "A")
A_center_012 <- summary[1]
A_closed_012 <- summary[2]
A_left_012 <- summary[3]
A_right_012 <- summary[4]
A_012 <- A_center_012+A_closed_012+A_left_012+A_right_012


summary <- generate_summary("S013", "W")
W_center_013 <- summary[1]
W_closed_013 <- summary[2]
W_left_013 <- summary[3]
W_right_013 <- summary[4]
W_013 <- W_center_013+W_closed_013+W_left_013+W_right_013

summary <- generate_summary("S013", "V")
V_center_013 <- summary[1]
V_closed_013 <- summary[2]
V_left_013 <- summary[3]
V_right_013 <- summary[4]
V_013 <- V_center_013+V_closed_013+V_left_013+V_right_013

summary <- generate_summary("S013", "A")
A_center_013 <- summary[1]
A_closed_013 <- summary[2]
A_left_013 <- summary[3]
A_right_013 <- summary[4]
A_013 <- A_center_013+A_closed_013+A_left_013+A_right_013


summary <- generate_summary("S014", "W")
W_center_014 <- summary[1]
W_closed_014 <- summary[2]
W_left_014 <- summary[3]
W_right_014 <- summary[4]
W_014 <- W_center_014+W_closed_014+W_left_014+W_right_014

summary <- generate_summary("S014", "V")
V_center_014 <- summary[1]
V_closed_014 <- summary[2]
V_left_014 <- summary[3]
V_right_014 <- summary[4]
V_014 <- V_center_014+V_closed_014+V_left_014+V_right_014

summary <- generate_summary("S014", "A")
A_center_014 <- summary[1]
A_closed_014 <- summary[2]
A_left_014 <- summary[3]
A_right_014 <- summary[4]
A_014 <- A_center_014+A_closed_014+A_left_014+A_right_014


summary <- generate_summary("S015", "W")
W_center_015 <- summary[1]
W_closed_015 <- summary[2]
W_left_015 <- summary[3]
W_right_015 <- summary[4]
W_015 <- W_center_015+W_closed_015+W_left_015+W_right_015

summary <- generate_summary("S015", "V")
V_center_015 <- summary[1]
V_closed_015 <- summary[2]
V_left_015 <- summary[3]
V_right_015 <- summary[4]
V_015 <- V_center_015+V_closed_015+V_left_015+V_right_015

summary <- generate_summary("S015", "A")
A_center_015 <- summary[1]
A_closed_015 <- summary[2]
A_left_015 <- summary[3]
A_right_015 <- summary[4]
A_015 <- A_center_015+A_closed_015+A_left_015+A_right_015


summary <- generate_summary("S016", "W")
W_center_016 <- summary[1]
W_closed_016 <- summary[2]
W_left_016 <- summary[3]
W_right_016 <- summary[4]
W_016 <- W_center_016+W_closed_016+W_left_016+W_right_016

summary <- generate_summary("S016", "V")
V_center_016 <- summary[1]
V_closed_016 <- summary[2]
V_left_016 <- summary[3]
V_right_016 <- summary[4]
V_016 <- V_center_016+V_closed_016+V_left_016+V_right_016

summary <- generate_summary("S016", "A")
A_center_016 <- summary[1]
A_closed_016 <- summary[2]
A_left_016 <- summary[3]
A_right_016 <- summary[4]
A_016 <- A_center_016+A_closed_016+A_left_016+A_right_016


summary <- generate_summary("S017", "W")
W_center_017 <- summary[1]
W_closed_017 <- summary[2]
W_left_017 <- summary[3]
W_right_017 <- summary[4]
W_017 <- W_center_017+W_closed_017+W_left_017+W_right_017

summary <- generate_summary("S017", "V")
V_center_017 <- summary[1]
V_closed_017 <- summary[2]
V_left_017 <- summary[3]
V_right_017 <- summary[4]
V_017 <- V_center_017+V_closed_017+V_left_017+V_right_017

summary <- generate_summary("S017", "A")
A_center_017 <- summary[1]
A_closed_017 <- summary[2]
A_left_017 <- summary[3]
A_right_017 <- summary[4]
A_017 <- A_center_017+A_closed_017+A_left_017+A_right_017

summary <- generate_summary("S018", "W")
W_center_018 <- summary[1]
W_closed_018 <- summary[2]
W_left_018 <- summary[3]
W_right_018 <- summary[4]
W_018 <- W_center_018+W_closed_018+W_left_018+W_right_018

summary <- generate_summary("S018", "V")
V_center_018 <- summary[1]
V_closed_018 <- summary[2]
V_left_018 <- summary[3]
V_right_018 <- summary[4]
V_018 <- V_center_018+V_closed_018+V_left_018+V_right_018

summary <- generate_summary("S018", "A")
A_center_018 <- summary[1]
A_closed_018 <- summary[2]
A_left_018 <- summary[3]
A_right_018 <- summary[4]
A_018 <- A_center_018+A_closed_018+A_left_018+A_right_018

summary <- generate_summary("S019", "W")
W_center_019 <- summary[1]
W_closed_019 <- summary[2]
W_left_019 <- summary[3]
W_right_019 <- summary[4]
W_019 <- W_center_019+W_closed_019+W_left_019+W_right_019

summary <- generate_summary("S019", "V")
V_center_019 <- summary[1]
V_closed_019 <- summary[2]
V_left_019 <- summary[3]
V_right_019 <- summary[4]
V_019 <- V_center_019+V_closed_019+V_left_019+V_right_019

summary <- generate_summary("S019", "A")
A_center_019 <- summary[1]
A_closed_019 <- summary[2]
A_left_019 <- summary[3]
A_right_019 <- summary[4]
A_019 <- A_center_019+A_closed_019+A_left_019+A_right_019

summary <- generate_summary("S020", "W")
W_center_020 <- summary[1]
W_closed_020 <- summary[2]
W_left_020 <- summary[3]
W_right_020 <- summary[4]
W_020 <- W_center_020+W_closed_020+W_left_020+W_right_020

summary <- generate_summary("S020", "V")
V_center_020 <- summary[1]
V_closed_020 <- summary[2]
V_left_020 <- summary[3]
V_right_020 <- summary[4]
V_020 <- V_center_020+V_closed_020+V_left_020+V_right_020

summary <- generate_summary("S020", "A")
A_center_020 <- summary[1]
A_closed_020 <- summary[2]
A_left_020 <- summary[3]
A_right_020 <- summary[4]
A_020 <- A_center_020+A_closed_020+A_left_020+A_right_020

```



```{r message=FALSE, warning=FALSE, include=FALSE}
summary <- generate_summary("S021", "W")
W_center_021 <- summary[1]
W_closed_021 <- summary[2]
W_left_021 <- summary[3]
W_right_021 <- summary[4]
W_021 <- W_center_021+W_closed_021+W_left_021+W_right_021

summary <- generate_summary("S021", "V")
V_center_021 <- summary[1]
V_closed_021 <- summary[2]
V_left_021 <- summary[3]
V_right_021 <- summary[4]
V_021 <- V_center_021+V_closed_021+V_left_021+V_right_021

summary <- generate_summary("S021", "A")
A_center_021 <- summary[1]
A_closed_021 <- summary[2]
A_left_021 <- summary[3]
A_right_021 <- summary[4]
A_021 <- A_center_021+A_closed_021+A_left_021+A_right_021


summary <- generate_summary("S022", "W")
W_center_022 <- summary[1]
W_closed_022 <- summary[2]
W_left_022 <- summary[3]
W_right_022 <- summary[4]
W_022 <- W_center_022+W_closed_022+W_left_022+W_right_022

summary <- generate_summary("S022", "V")
V_center_022 <- summary[1]
V_closed_022 <- summary[2]
V_left_022 <- summary[3]
V_right_022 <- summary[4]
V_022 <- V_center_022+V_closed_022+V_left_022+V_right_022

summary <- generate_summary("S022", "A")
A_center_022 <- summary[1]
A_closed_022 <- summary[2]
A_left_022 <- summary[3]
A_right_022 <- summary[4]
A_022 <- A_center_022+A_closed_022+A_left_022+A_right_022


summary <- generate_summary("S023", "W")
W_center_023 <- summary[1]
W_closed_023 <- summary[2]
W_left_023 <- summary[3]
W_right_023 <- summary[4]
W_023 <- W_center_023+W_closed_023+W_left_023+W_right_023

summary <- generate_summary("S023", "V")
V_center_023 <- summary[1]
V_closed_023 <- summary[2]
V_left_023 <- summary[3]
V_right_023 <- summary[4]
V_023 <- V_center_023+V_closed_023+V_left_023+V_right_023

summary <- generate_summary("S023", "A")
A_center_023 <- summary[1]
A_closed_023 <- summary[2]
A_left_023 <- summary[3]
A_right_023 <- summary[4]
A_023 <- A_center_023+A_closed_023+A_left_023+A_right_023


summary <- generate_summary("S024", "W")
W_center_024 <- summary[1]
W_closed_024 <- summary[2]
W_left_024 <- summary[3]
W_right_024 <- summary[4]
W_024 <- W_center_024+W_closed_024+W_left_024+W_right_024

summary <- generate_summary("S024", "V")
V_center_024 <- summary[1]
V_closed_024 <- summary[2]
V_left_024 <- summary[3]
V_right_024 <- summary[4]
V_024 <- V_center_024+V_closed_024+V_left_024+V_right_024

summary <- generate_summary("S024", "A")
A_center_024 <- summary[1]
A_closed_024 <- summary[2]
A_left_024 <- summary[3]
A_right_024 <- summary[4]
A_024 <- A_center_024+A_closed_024+A_left_024+A_right_024


summary <- generate_summary("S025", "W")
W_center_025 <- summary[1]
W_closed_025 <- summary[2]
W_left_025 <- summary[3]
W_right_025 <- summary[4]
W_025 <- W_center_025+W_closed_025+W_left_025+W_right_025

summary <- generate_summary("S025", "V")
V_center_025 <- summary[1]
V_closed_025 <- summary[2]
V_left_025 <- summary[3]
V_right_025 <- summary[4]
V_025 <- V_center_025+V_closed_025+V_left_025+V_right_025

summary <- generate_summary("S025", "A")
A_center_025 <- summary[1]
A_closed_025 <- summary[2]
A_left_025 <- summary[3]
A_right_025 <- summary[4]
A_025 <- A_center_025+A_closed_025+A_left_025+A_right_025


summary <- generate_summary("S026", "W")
W_center_026 <- summary[1]
W_closed_026 <- summary[2]
W_left_026 <- summary[3]
W_right_026 <- summary[4]
W_026 <- W_center_026+W_closed_026+W_left_026+W_right_026

summary <- generate_summary("S026", "V")
V_center_026 <- summary[1]
V_closed_026 <- summary[2]
V_left_026 <- summary[3]
V_right_026 <- summary[4]
V_026 <- V_center_026+V_closed_026+V_left_026+V_right_026

summary <- generate_summary("S026", "A")
A_center_026 <- summary[1]
A_closed_026 <- summary[2]
A_left_026 <- summary[3]
A_right_026 <- summary[4]
A_026 <- A_center_026+A_closed_026+A_left_026+A_right_026


summary <- generate_summary("S027", "W")
W_center_027 <- summary[1]
W_closed_027 <- summary[2]
W_left_027 <- summary[3]
W_right_027 <- summary[4]
W_027 <- W_center_027+W_closed_027+W_left_027+W_right_027

summary <- generate_summary("S027", "V")
V_center_027 <- summary[1]
V_closed_027 <- summary[2]
V_left_027 <- summary[3]
V_right_027 <- summary[4]
V_027 <- V_center_027+V_closed_027+V_left_027+V_right_027

summary <- generate_summary("S027", "A")
A_center_027 <- summary[1]
A_closed_027 <- summary[2]
A_left_027 <- summary[3]
A_right_027 <- summary[4]
A_027 <- A_center_027+A_closed_027+A_left_027+A_right_027

summary <- generate_summary("S028", "W")
W_center_028 <- summary[1]
W_closed_028 <- summary[2]
W_left_028 <- summary[3]
W_right_028 <- summary[4]
W_028 <- W_center_028+W_closed_028+W_left_028+W_right_028

summary <- generate_summary("S028", "V")
V_center_028 <- summary[1]
V_closed_028 <- summary[2]
V_left_028 <- summary[3]
V_right_028 <- summary[4]
V_028 <- V_center_028+V_closed_028+V_left_028+V_right_028

summary <- generate_summary("S028", "A")
A_center_028 <- summary[1]
A_closed_028 <- summary[2]
A_left_028 <- summary[3]
A_right_028 <- summary[4]
A_028 <- A_center_028+A_closed_028+A_left_028+A_right_028

summary <- generate_summary("S029", "W")
W_center_029 <- summary[1]
W_closed_029 <- summary[2]
W_left_029 <- summary[3]
W_right_029 <- summary[4]
W_029 <- W_center_029+W_closed_029+W_left_029+W_right_029

summary <- generate_summary("S029", "V")
V_center_029 <- summary[1]
V_closed_029 <- summary[2]
V_left_029 <- summary[3]
V_right_029 <- summary[4]
V_029 <- V_center_029+V_closed_029+V_left_029+V_right_029

summary <- generate_summary("S029", "A")
A_center_029 <- summary[1]
A_closed_029 <- summary[2]
A_left_029 <- summary[3]
A_right_029 <- summary[4]
A_029 <- A_center_029+A_closed_029+A_left_029+A_right_029

summary <- generate_summary("S030", "W")
W_center_030 <- summary[1]
W_closed_030 <- summary[2]
W_left_030 <- summary[3]
W_right_030 <- summary[4]
W_030 <- W_center_030+W_closed_030+W_left_030+W_right_030

summary <- generate_summary("S030", "V")
V_center_030 <- summary[1]
V_closed_030 <- summary[2]
V_left_030 <- summary[3]
V_right_030 <- summary[4]
V_030 <- V_center_030+V_closed_030+V_left_030+V_right_030

summary <- generate_summary("S030", "A")
A_center_030 <- summary[1]
A_closed_030 <- summary[2]
A_left_030 <- summary[3]
A_right_030 <- summary[4]
A_030 <- A_center_030+A_closed_030+A_left_030+A_right_030

```



```{r fig.height=5, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
specie <- c(rep("S001" , 4) , rep("S002" , 4) , rep("S003" , 4) , rep("S004" , 4) , rep("S005" , 4), 
            rep("S006" , 4) , rep("S007" , 4) , rep("S008" , 4) , rep("S009" , 4) , rep("S010" , 4),
            rep("S011" , 4) , rep("S012" , 4) , rep("S013" , 4) , rep("S014" , 4) , rep("S015" , 4),
            rep("S016" , 4) , rep("S017" , 4) , rep("S018" , 4) , rep("S019" , 4) , rep("S020" , 4),
            rep("S021" , 4) , rep("S022" , 4) , rep("S023" , 4) , rep("S024" , 4) , rep("S025" , 4),
            rep("S026" , 4) , rep("S027" , 4) , rep("S028" , 4) , rep("S029" , 4) , rep("S030" , 4)
            )
Directions <- rep(c('CENTER', 'CLOSED', 'LEFT', 'RIGHT') , 30)
value <- c(
A_center_001/A_001, A_closed_001/A_001, A_left_001/A_001, A_right_001/A_001,
A_center_002/A_002, A_closed_002/A_002, A_left_002/A_002, A_right_002/A_002,
A_center_003/A_003, A_closed_003/A_003, A_left_003/A_003, A_right_003/A_003,
A_center_004/A_004, A_closed_004/A_004, A_left_004/A_004, A_right_004/A_004,
A_center_005/A_005, A_closed_005/A_005, A_left_005/A_005, A_right_005/A_005,
A_center_006/A_006, A_closed_006/A_006, A_left_006/A_006, A_right_006/A_006,
A_center_007/A_007, A_closed_007/A_007, A_left_007/A_007, A_right_007/A_007,
A_center_008/A_008, A_closed_008/A_008, A_left_008/A_008, A_right_008/A_008,
A_center_009/A_009, A_closed_009/A_009, A_left_009/A_009, A_right_009/A_009,
A_center_010/A_010, A_closed_010/A_010, A_left_010/A_010, A_right_010/A_010,
A_center_011/A_011, A_closed_011/A_011, A_left_011/A_011, A_right_011/A_011,
A_center_012/A_012, A_closed_012/A_012, A_left_012/A_012, A_right_012/A_012,
A_center_013/A_013, A_closed_013/A_013, A_left_013/A_013, A_right_013/A_013,
A_center_014/A_014, A_closed_014/A_014, A_left_014/A_014, A_right_014/A_014,
A_center_015/A_015, A_closed_015/A_015, A_left_015/A_015, A_right_015/A_015,
A_center_016/A_016, A_closed_016/A_016, A_left_016/A_016, A_right_016/A_016,
A_center_017/A_017, A_closed_017/A_017, A_left_017/A_017, A_right_017/A_017,
A_center_018/A_018, A_closed_018/A_018, A_left_018/A_018, A_right_018/A_018,
A_center_019/A_019, A_closed_019/A_019, A_left_019/A_019, A_right_019/A_019,
A_center_020/A_020, A_closed_020/A_020, A_left_020/A_020, A_right_020/A_020,
A_center_021/A_021, A_closed_021/A_021, A_left_021/A_021, A_right_021/A_021,
A_center_022/A_022, A_closed_022/A_022, A_left_022/A_022, A_right_022/A_022,
A_center_023/A_023, A_closed_023/A_023, A_left_023/A_023, A_right_023/A_023,
A_center_024/A_024, A_closed_024/A_024, A_left_024/A_024, A_right_024/A_024,
A_center_025/A_025, A_closed_025/A_025, A_left_025/A_025, A_right_025/A_025,
A_center_026/A_026, A_closed_026/A_026, A_left_026/A_026, A_right_026/A_026,
A_center_027/A_027, A_closed_027/A_027, A_left_027/A_027, A_right_027/A_027,
A_center_028/A_028, A_closed_028/A_028, A_left_028/A_028, A_right_028/A_028,
A_center_029/A_029, A_closed_029/A_029, A_left_029/A_029, A_right_029/A_029,
A_center_030/A_030, A_closed_030/A_030, A_left_030/A_030, A_right_030/A_030
  )

data <- data.frame(specie,Directions,value)

# Stacked + percent
PA <- ggplot(data, aes(fill=Directions, y=value, x=specie)) + 
    geom_bar(position="fill", stat="identity") +
   labs(y = "A",x="")
PA
```

```{r fig.height=5, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
specie <- c(rep("S001" , 4) , rep("S002" , 4) , rep("S003" , 4) , rep("S004" , 4) , rep("S005" , 4), 
            rep("S006" , 4) , rep("S007" , 4) , rep("S008" , 4) , rep("S009" , 4) , rep("S010" , 4),
            rep("S011" , 4) , rep("S012" , 4) , rep("S013" , 4) , rep("S014" , 4) , rep("S015" , 4),
            rep("S016" , 4) , rep("S017" , 4) , rep("S018" , 4) , rep("S019" , 4) , rep("S020" , 4),
            rep("S021" , 4) , rep("S022" , 4) , rep("S023" , 4) , rep("S024" , 4) , rep("S025" , 4),
            rep("S026" , 4) , rep("S027" , 4) , rep("S028" , 4) , rep("S029" , 4) , rep("S030" , 4)
            )
Directions <- rep(c('CENTER', 'CLOSED', 'LEFT', 'RIGHT') , 30)
value <- c(
V_center_001/V_001, V_closed_001/V_001, V_left_001/V_001, V_right_001/V_001,
V_center_002/V_002, V_closed_002/V_002, V_left_002/V_002, V_right_002/V_002,
V_center_003/V_003, V_closed_003/V_003, V_left_003/V_003, V_right_003/V_003,
V_center_004/V_004, V_closed_004/V_004, V_left_004/V_004, V_right_004/V_004,
V_center_005/V_005, V_closed_005/V_005, V_left_005/V_005, V_right_005/V_005,
V_center_006/V_006, V_closed_006/V_006, V_left_006/V_006, V_right_006/V_006,
V_center_007/V_007, V_closed_007/V_007, V_left_007/V_007, V_right_007/V_007,
V_center_008/V_008, V_closed_008/V_008, V_left_008/V_008, V_right_008/V_008,
V_center_009/V_009, V_closed_009/V_009, V_left_009/V_009, V_right_009/V_009,
V_center_010/V_010, V_closed_010/V_010, V_left_010/V_010, V_right_010/V_010,
V_center_011/V_011, V_closed_011/V_011, V_left_011/V_011, V_right_011/V_011,
V_center_012/V_012, V_closed_012/V_012, V_left_012/V_012, V_right_012/V_012,
V_center_013/V_013, V_closed_013/V_013, V_left_013/V_013, V_right_013/V_013,
V_center_014/V_014, V_closed_014/V_014, V_left_014/V_014, V_right_014/V_014,
V_center_015/V_015, V_closed_015/V_015, V_left_015/V_015, V_right_015/V_015,
V_center_016/V_016, V_closed_016/V_016, V_left_016/V_016, V_right_016/V_016,
V_center_017/V_017, V_closed_017/V_017, V_left_017/V_017, V_right_017/V_017,
V_center_018/V_018, V_closed_018/V_018, V_left_018/V_018, V_right_018/V_018,
V_center_019/V_019, V_closed_019/V_019, V_left_019/V_019, V_right_019/V_019,
V_center_020/V_020, V_closed_020/V_020, V_left_020/V_020, V_right_020/V_020,
V_center_021/V_021, V_closed_021/V_021, V_left_021/V_021, V_right_021/V_021,
V_center_022/V_022, V_closed_022/V_022, V_left_022/V_022, V_right_022/V_022,
V_center_023/V_023, V_closed_023/V_023, V_left_023/V_023, V_right_023/V_023,
V_center_024/V_024, V_closed_024/V_024, V_left_024/V_024, V_right_024/V_024,
V_center_025/V_025, V_closed_025/V_025, V_left_025/V_025, V_right_025/V_025,
V_center_026/V_026, V_closed_026/V_026, V_left_026/V_026, V_right_026/V_026,
V_center_027/V_027, V_closed_027/V_027, V_left_027/V_027, V_right_027/V_027,
V_center_028/V_028, V_closed_028/V_028, V_left_028/V_028, V_right_028/V_028,
V_center_029/V_029, V_closed_029/V_029, V_left_029/V_029, V_right_029/V_029,
V_center_030/V_030, V_closed_030/V_030, V_left_030/V_030, V_right_030/V_030
  )

data <- data.frame(specie,Directions,value)

# Stacked + percent
PV <- ggplot(data, aes(fill=Directions, y=value, x=specie)) + 
    geom_bar(position="fill", stat="identity") +
   labs(y = "V",x="")
PV
```



```{r fig.height=5, fig.width=15, message=FALSE, warning=FALSE, include=FALSE}
specie <- c(rep("S001" , 4) , rep("S002" , 4) , rep("S003" , 4) , rep("S004" , 4) , rep("S005" , 4), 
            rep("S006" , 4) , rep("S007" , 4) , rep("S008" , 4) , rep("S009" , 4) , rep("S010" , 4),
            rep("S011" , 4) , rep("S012" , 4) , rep("S013" , 4) , rep("S014" , 4) , rep("S015" , 4),
            rep("S016" , 4) , rep("S017" , 4) , rep("S018" , 4) , rep("S019" , 4) , rep("S020" , 4),
            rep("S021" , 4) , rep("S022" , 4) , rep("S023" , 4) , rep("S024" , 4) , rep("S025" , 4),
            rep("S026" , 4) , rep("S027" , 4) , rep("S028" , 4) , rep("S029" , 4) , rep("S030" , 4)
            )
Directions <- rep(c('CENTER', 'CLOSED', 'LEFT', 'RIGHT') , 30)
value <- c(
W_center_001/W_001, W_closed_001/W_001, W_left_001/W_001, W_right_001/W_001,
W_center_002/W_002, W_closed_002/W_002, W_left_002/W_002, W_right_002/W_002,
W_center_003/W_003, W_closed_003/W_003, W_left_003/W_003, W_right_003/W_003,
W_center_004/W_004, W_closed_004/W_004, W_left_004/W_004, W_right_004/W_004,
W_center_005/W_005, W_closed_005/W_005, W_left_005/W_005, W_right_005/W_005,
W_center_006/W_006, W_closed_006/W_006, W_left_006/W_006, W_right_006/W_006,
W_center_007/W_007, W_closed_007/W_007, W_left_007/W_007, W_right_007/W_007,
W_center_008/W_008, W_closed_008/W_008, W_left_008/W_008, W_right_008/W_008,
W_center_009/W_009, W_closed_009/W_009, W_left_009/W_009, W_right_009/W_009,
W_center_010/W_010, W_closed_010/W_010, W_left_010/W_010, W_right_010/W_010,
W_center_011/W_011, W_closed_011/W_011, W_left_011/W_011, W_right_011/W_011,
W_center_012/W_012, W_closed_012/W_012, W_left_012/W_012, W_right_012/W_012,
W_center_013/W_013, W_closed_013/W_013, W_left_013/W_013, W_right_013/W_013,
W_center_014/W_014, W_closed_014/W_014, W_left_014/W_014, W_right_014/W_014,
W_center_015/W_015, W_closed_015/W_015, W_left_015/W_015, W_right_015/W_015,
W_center_016/W_016, W_closed_016/W_016, W_left_016/W_016, W_right_016/W_016,
W_center_017/W_017, W_closed_017/W_017, W_left_017/W_017, W_right_017/W_017,
W_center_018/W_018, W_closed_018/W_018, W_left_018/W_018, W_right_018/W_018,
W_center_019/W_019, W_closed_019/W_019, W_left_019/W_019, W_right_019/W_019,
W_center_020/W_020, W_closed_020/W_020, W_left_020/W_020, W_right_020/W_020,
W_center_021/W_021, W_closed_021/W_021, W_left_021/W_021, W_right_021/W_021,
W_center_022/W_022, W_closed_022/W_022, W_left_022/W_022, W_right_022/W_022,
W_center_023/W_023, W_closed_023/W_023, W_left_023/W_023, W_right_023/W_023,
W_center_024/W_024, W_closed_024/W_024, W_left_024/W_024, W_right_024/W_024,
W_center_025/W_025, W_closed_025/W_025, W_left_025/W_025, W_right_025/W_025,
W_center_026/W_026, W_closed_026/W_026, W_left_026/W_026, W_right_026/W_026,
W_center_027/W_027, W_closed_027/W_027, W_left_027/W_027, W_right_027/W_027,
W_center_028/W_028, W_closed_028/W_028, W_left_028/W_028, W_right_028/W_028,
W_center_029/W_029, W_closed_029/W_029, W_left_029/W_029, W_right_029/W_029,
W_center_030/W_030, W_closed_030/W_030, W_left_030/W_030, W_right_030/W_030
  )

data <- data.frame(specie,Directions,value)

# Stacked + percent
PW <- ggplot(data, aes(fill=Directions, y=value, x=specie)) + 
    geom_bar(position="fill", stat="identity") +
   labs(y = "W",x="")
PW
```

```{r echo=FALSE, fig.height=8, fig.width=15, message=FALSE, warning=FALSE}
ggarrange(PA+theme(legend.position = "top"),
          PV+theme(legend.position = "none"),
          PW+theme(legend.position = "none"), 
          nrow = 3, ncol = 1)
```


## Q2-Summary statistics

```{r echo=FALSE, fig.height=5, fig.width=15, message=FALSE, warning=FALSE}

subset_all_A <- all.df4 %>%
    filter(ExamVersion2 == "A")

all_A <- sum(!is.na(subset_all_A$G_Direction))
all_A_center <- nrow(subset_all_A[subset_all_A$G_Direction == "CENTER", ])
all_A_closed<- nrow(subset_all_A[subset_all_A$G_Direction == "CLOSED", ])
all_A_left <- nrow(subset_all_A[subset_all_A$G_Direction == "LEFT", ])
all_A_right <- nrow(subset_all_A[subset_all_A$G_Direction == "RIGHT", ])

subset_all_V <- all.df4 %>%
    filter(ExamVersion2 == "V")

all_V <- sum(!is.na(subset_all_V$G_Direction))
all_V_center <- nrow(subset_all_V[subset_all_V$G_Direction == "CENTER", ])
all_V_closed<- nrow(subset_all_V[subset_all_V$G_Direction == "CLOSED", ])
all_V_left <- nrow(subset_all_V[subset_all_V$G_Direction == "LEFT", ])
all_V_right <- nrow(subset_all_V[subset_all_V$G_Direction == "RIGHT", ])

subset_all_W <- all.df4 %>%
    filter(ExamVersion2 == "W")

all_W <- sum(!is.na(subset_all_W$G_Direction))
all_W_center <- nrow(subset_all_W[subset_all_W$G_Direction == "CENTER", ])
all_W_closed<- nrow(subset_all_W[subset_all_W$G_Direction == "CLOSED", ])
all_W_left <- nrow(subset_all_W[subset_all_W$G_Direction == "LEFT", ])
all_W_right <- nrow(subset_all_W[subset_all_W$G_Direction == "RIGHT", ])


# create a dataset
specie <- c(rep("A" , 1) , rep("V" , 1) , rep("W" , 1)  )
Emotions <- rep(c('CENTER', 'CLOSED', 'LEFT', 'RIGHT') , 3)
value <- c(
  all_A_center/all_A*100,all_A_closed/all_A*100,all_A_left/all_A*100,all_A_right/all_A*100,
  all_V_center/all_V*100,all_V_closed/all_V*100,all_V_left/all_V*100,all_V_right/all_V*100,
  all_W_center/all_W*100,all_W_closed/all_W*100,all_W_left/all_W*100,all_W_right/all_W*100
  )
data <- data.frame(specie,Emotions,value)

my_colors <- c("CENTER" = "blue", "CLOSED" = "green", 
               "LEFT" = "brown", "RIGHT" = "orange")

# Graph
ggplot(data, aes(fill = Emotions, y = value, x = Emotions)) + 
  geom_bar(position = "dodge", stat = "identity") +
  scale_fill_manual(name = 'emotions', values = my_colors, drop = FALSE) +
  ggtitle("") +
  facet_wrap(~specie) +
  #theme_ipsum() +
  theme(legend.position = "top", axis.text.x = element_blank()) +
  xlab("")+ylab("Proportion (%)")
```

\newpage
## Q2-Construct a table with the relevant descriptive statistics

```{r echo=FALSE, message=FALSE, warning=FALSE}
table_df =data.frame(Question_Type  = c("A", "V", "W","A", "V", "W","A", "V", "W","A", "V", "W"),
           G_Direction = c("CENTER","CENTER","CENTER", "CLOSED", "CLOSED","CLOSED", "LEFT","LEFT","LEFT", "RIGHT", "RIGHT", "RIGHT"),
           Freq = c(all_A_center, all_V_center, all_W_center,
                 all_A_closed, all_V_closed, all_W_closed,
                 all_A_left, all_V_left, all_W_left,
                 all_A_right, all_V_right, all_W_right),
           
           percentage = c(
             all_A_center/all_A*100, all_V_center/all_V*100, all_W_center/all_W*100,
                 all_A_closed/all_A*100, all_V_closed/all_V*100, all_W_closed/all_W*100,
                 all_A_left/all_A*100, all_V_left/all_V*100, all_W_left/all_W*100,
                 all_A_right/all_A*100, all_V_right/all_V*100, all_W_right/all_W*100),
           
           n = c(all_A, all_V, all_W,
                 all_A, all_V, all_W,
                 all_A, all_V, all_W,
                 all_A, all_V, all_W)
           )

colnames(table_df) <- c("Question_Type", "G_Direction","Freq","percentage","n")
table_df %>%
  kable("latex", booktabs = T, caption = "Percentage of each emotion on Question Type") %>%
  #kable("markdown", booktabs = T, caption = "Percentage of each emotion on Question Type ") %>%
  kable_styling(latex_options = c("scale-down","hold_position"), font_size = 10)
```

\newpage

## Q3-Gained Insights 

Based on the proportion stacked plot, we observe much more purple, which represent RIGHT, and the percentage of cyan is next, meaning CENTER. The proportion of blue is very little and green is almost none, respectively indicating LEFT and CLOSED. In these four gaze state, the RIGHT is most common and the CLOSED almost never happens. 

According to the summary statistics and the table, the result is much more clear and obvious. To all tasks(ABSTRACT, WORD, VIDEO), the ORANGE, representing RIGHT has the biggest proportion and more than 70%. The blue is second, which means CENTER, is about 26%-30%. The proportion of GREEN and BROWN are very small, almost less than 0.1%, that is the probabilities of occurrence of CLOSED and LEFT are very small. 

In the table of percentage of each emotion, the percentage of RIGHT is highest, followed by CENTER.

The results of above three match perfectly.


\newpage

# Step 4

1. Construct summary plots for the SAI and SUS questionnaires.

2. Express the insights you have gained.


\newpage

## Q1-SAI and SUS overall scores


```{r message=FALSE, warning=FALSE, include=FALSE}

all.df5 <- all.df2 %>% drop_na(SAI.Score, overall.Score)


scores_df = all.df5 %>%
  group_by(ParticipantID) %>%
  sample_n(1)
scores_df

```

### Shapiro-Wilk normality test

```{r echo=FALSE, message=FALSE, warning=FALSE}
# Shapiro-Wilk test

SAI.Score_Shapiro = shapiro.test(scores_df$SAI.Score)
overall.Score_Shapiro = shapiro.test(scores_df$overall.Score)
SAI.Score_Shapiro
overall.Score_Shapiro
```

```{r fig.height=5, fig.width=5, message=FALSE, warning=FALSE, include=FALSE}
my_theme <- theme_bw() +
  theme(
    panel.grid = element_blank(),
    plot.title = element_text(hjust = 0.5),
    axis.text.x = element_blank(),
    axis.ticks.x = element_blank(),
    axis.text.y = element_text(size = 10, face = "bold"),
    strip.text = element_text(size = 18),
    legend.position = "none"
  )

text_size <- 13

nsample <- sum(!is.na(scores_df$SAI.Score))


# SAI.Score
PSAI <- scores_df %>%
  ggplot() + 

  geom_boxplot(aes(y = SAI.Score), fill = "orange") + 
  labs(title="SAI Score", y="" , x = "" ) + 
  my_theme +   ylim(0, 80)    +
  geom_text( aes(0, 70, label = paste0("italic(n) == ", nsample)),
              parse = TRUE, 
              vjust = -2.5, hjust = 2) 
PSAI

nsample <- sum(!is.na(scores_df$overall.Score))
# SUS overall Score
PSUS <- scores_df %>%
  ggplot() + 

  geom_boxplot(aes(y = overall.Score), fill = "pink") + 
  labs(title="SUS overall Score", y="" , x = "" ) + 
  my_theme +   ylim(0, 110)    +
  geom_text( aes(0, 100, label = paste0("italic(n) == ", nsample)),
              parse = TRUE, 
              vjust = -2.5, hjust = 2) 
PSUS

```

### Box plot

```{r echo=FALSE, fig.height=5, fig.width=10, message=FALSE, warning=FALSE}

ggarrange(PSAI, PSUS, ncol = 2, nrow = 1)

```


\newpage

## Q2-Gained Insights 

The variable sets contain hundreds of thousands of points each, which is not very conducive to statistical analysis. Accordingly, we choose to sample and work with reduced sets instead. Because each SAI score and SUS overall score are same for most each participant, we chose one sample for each participant. So we chose 30 samples.

The Shapiro-Wilk normality test is a statistical test that checks whether a given dataset is normally distributed. For SAI Score: W is 0.90897 suggests that the data is moderately close to a normal distribution, but there might be some deviations. The p-value is 0.01402, less than 0.05 is considered evidence enough to reject the null hypothesis that the data are normally distributed. For SUS overall Score: W (test statistic) value of 0.88793 suggests that the data is somewhat close to normal, but there might be some deviations. The p-value is 0.004311, which is less than 0.05, would reject the null hypothesis and conclude that SUS overall.Score is not normally distributed. So, both dataset do not follow a normal distribution. 

That box plots showed both SAI score and SUS overall score are non-normally distributed. For SAI Score: the median being in the lower quartile (Q1) indicates that the data is negatively skewed, with a higher concentration of values towards the lower end of the distribution. The minimum whisker being shorter than the maximum whisker suggests that the data is negatively skewed, with more spread towards the lower end of the distribution. Based on the median position and whisker lengths, the box plot suggests that the distribution of SAI Score is negatively skewed, with most values concentrated towards the lower end of the scale. There are no apparent outliers in the SAI scores. For SUS overall score: The median (Q2) is positioned below the center of the box, indicating that the median value is closer to the first quartile (Q1) than the third quartile (Q3). This suggests a negative skewness in the distribution of SUS overall scores. The minimum whisker (lower whisker) extends further downwards than the maximum whisker (upper whisker). This implies that the lower range of the data extends further from the median than the upper range, reinforcing the negative skewness of the data. Outliers are present on the minimum whisker, indicating that there are data points with exceptionally low SUS overall scores. The median of SUS overall Score(around 75) is greater than SAI Score(around 40) and the size of box on SUS overall scores is greater than SAI Score. So the SUS scores are not only higher on average but also show less variability compared to the SAI scores.

